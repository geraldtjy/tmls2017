window.TinyMCERails={configuration:{default:{}},initialize:function(e,t){if("undefined"!=typeof tinyMCE){var n=TinyMCERails.configuration[e||"default"];n=TinyMCERails._merge(n,t),tinymce.init(n)}else setTimeout((function(){TinyMCERails.initialize(e,t)}),50)},setupTurbolinks:function(){document.addEventListener("turbolinks:before-render",(function(){tinymce.remove()}))},_merge:function(){for(var e={},t=0;t<arguments.length;++t){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&("[object Object]"===Object.prototype.toString.call(n[o])?e[o]=TinyMCERails._merge(e[o],n[o]):e[o]=n[o])}return e}},"undefined"!=typeof Turbolinks&&Turbolinks.supported&&TinyMCERails.setupTurbolinks(),window.tinymce=window.tinymce||{base:"/assets/tinymce",suffix:""},function(){"use strict";function e(e,...t){return(...n)=>{const o=t.concat(n);return e.apply(null,o)}}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(){return r=o()?Reflect.construct:function(e,t,o){var r=[null];r.push.apply(r,t);var s=new(Function.bind.apply(e,r));return o&&n(s,o.prototype),s},r.apply(null,arguments)}function s(e){return a(e)||i(e)||l(e)||c()}function a(e){if(Array.isArray(e))return d(e)}function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e){return function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];return B_(e,t,o)}}function u(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return P_(e,n)}}function f(e,t){__&&__(e,null);for(var n=t.length;n--;){var o=t[n];if("string"==typeof o){var r=F_(o);r!==o&&(E_(t)||(t[n]=r),o=r)}e[o]=!0}return e}function g(e){var t,n=T_(null);for(t in e)B_(S_,e,[t])&&(n[t]=e[t]);return n}function p(e,t){function n(e){return console.warn("fallback value for",e),null}for(;null!==e;){var o=R_(e,t);if(o){if(o.get)return m(o.get);if("function"==typeof o.value)return m(o.value)}e=N_(e)}return n}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cE(),n=function(e){return h(e)};if(n.version="2.3.8",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var o=e.document,r=e.document,a=e.DocumentFragment,i=e.HTMLTemplateElement,l=e.Node,d=e.Element,c=e.NodeFilter,m=e.NamedNodeMap,u=void 0===m?e.NamedNodeMap||e.MozNamedAttrMap:m,b=e.HTMLFormElement,y=e.DOMParser,v=e.trustedTypes,C=d.prototype,w=p(C,"cloneNode"),x=p(C,"nextSibling"),k=p(C,"childNodes"),S=p(C,"parentNode");if("function"==typeof i){var _=r.createElement("template");_.content&&_.content.ownerDocument&&(r=_.content.ownerDocument)}var E=mE(v,o),N=E?E.createHTML(""):"",R=r,D=R.implementation,A=R.createNodeIterator,T=R.createDocumentFragment,O=R.getElementsByTagName,B=o.importNode,P={};try{P=g(r).documentMode?r.documentMode:{}}catch(e){}var L={};n.isSupported="function"==typeof S&&D&&void 0!==D.createHTMLDocument&&9!==P;var M,I,F=nE,U=oE,z=rE,j=sE,H=iE,V=lE,$=aE,q=null,W=f({},[].concat(s(q_),s(W_),s(K_),s(Y_),s(Q_))),K=null,G=f({},[].concat(s(J_),s(Z_),s(eE),s(tE))),Y=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),X=null,Q=null,J=!0,Z=!0,ee=!1,te=!1,ne=!1,oe=!1,re=!1,se=!1,ae=!1,ie=!1,le=!0,de=!0,ce=!1,me={},ue=null,fe=f({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ge=null,pe=f({},["audio","video","img","source","image","track"]),he=null,be=f({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ye="http://www.w3.org/1998/Math/MathML",ve="http://www.w3.org/2000/svg",Ce="http://www.w3.org/1999/xhtml",we=Ce,xe=!1,ke=["application/xhtml+xml","text/html"],Se="text/html",_e=null,Ee=r.createElement("form"),Ne=function(e){return e instanceof RegExp||e instanceof Function},Re=function(e){_e&&_e===e||(e&&"object"===t(e)||(e={}),e=g(e),q="ALLOWED_TAGS"in e?f({},e.ALLOWED_TAGS):W,K="ALLOWED_ATTR"in e?f({},e.ALLOWED_ATTR):G,he="ADD_URI_SAFE_ATTR"in e?f(g(be),e.ADD_URI_SAFE_ATTR):be,ge="ADD_DATA_URI_TAGS"in e?f(g(pe),e.ADD_DATA_URI_TAGS):pe,ue="FORBID_CONTENTS"in e?f({},e.FORBID_CONTENTS):fe,X="FORBID_TAGS"in e?f({},e.FORBID_TAGS):{},Q="FORBID_ATTR"in e?f({},e.FORBID_ATTR):{},me="USE_PROFILES"in e&&e.USE_PROFILES,J=!1!==e.ALLOW_ARIA_ATTR,Z=!1!==e.ALLOW_DATA_ATTR,ee=e.ALLOW_UNKNOWN_PROTOCOLS||!1,te=e.SAFE_FOR_TEMPLATES||!1,ne=e.WHOLE_DOCUMENT||!1,se=e.RETURN_DOM||!1,ae=e.RETURN_DOM_FRAGMENT||!1,ie=e.RETURN_TRUSTED_TYPE||!1,re=e.FORCE_BODY||!1,le=!1!==e.SANITIZE_DOM,de=!1!==e.KEEP_CONTENT,ce=e.IN_PLACE||!1,$=e.ALLOWED_URI_REGEXP||$,we=e.NAMESPACE||Ce,e.CUSTOM_ELEMENT_HANDLING&&Ne(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ne(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Y.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),M=M=-1===ke.indexOf(e.PARSER_MEDIA_TYPE)?Se:e.PARSER_MEDIA_TYPE,I="application/xhtml+xml"===M?function(e){return e}:F_,te&&(Z=!1),ae&&(se=!0),me&&(q=f({},s(Q_)),K=[],!0===me.html&&(f(q,q_),f(K,J_)),!0===me.svg&&(f(q,W_),f(K,Z_),f(K,tE)),!0===me.svgFilters&&(f(q,K_),f(K,Z_),f(K,tE)),!0===me.mathMl&&(f(q,Y_),f(K,eE),f(K,tE))),e.ADD_TAGS&&(q===W&&(q=g(q)),f(q,e.ADD_TAGS)),e.ADD_ATTR&&(K===G&&(K=g(K)),f(K,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&f(he,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(ue===fe&&(ue=g(ue)),f(ue,e.FORBID_CONTENTS)),de&&(q["#text"]=!0),ne&&f(q,["html","head","body"]),q.table&&(f(q,["tbody"]),delete X.tbody),D_&&D_(e),_e=e)},De=f({},["mi","mo","mn","ms","mtext"]),Ae=f({},["foreignobject","desc","title","annotation-xml"]),Te=f({},["title","style","font","a","script"]),Oe=f({},W_);f(Oe,K_),f(Oe,G_);var Be=f({},Y_);f(Be,X_);var Pe=function(e){var t=S(e);t&&t.tagName||(t={namespaceURI:Ce,tagName:"template"});var n=F_(e.tagName),o=F_(t.tagName);return e.namespaceURI===ve?t.namespaceURI===Ce?"svg"===n:t.namespaceURI===ye?"svg"===n&&("annotation-xml"===o||De[o]):Boolean(Oe[n]):e.namespaceURI===ye?t.namespaceURI===Ce?"math"===n:t.namespaceURI===ve?"math"===n&&Ae[o]:Boolean(Be[n]):e.namespaceURI===Ce&&(!(t.namespaceURI===ve&&!Ae[o])&&(!(t.namespaceURI===ye&&!De[o])&&(!Be[n]&&(Te[n]||!Oe[n]))))},Le=function(e){I_(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=N}catch(t){e.remove()}}},Me=function(e,t){try{I_(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){I_(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!K[e])if(se||ae)try{Le(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ie=function(e){var t,n;if(re)e="<remove></remove>"+e;else{var o=U_(e,/^[\r\n\t ]+/);n=o&&o[0]}"application/xhtml+xml"===M&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var s=E?E.createHTML(e):e;if(we===Ce)try{t=(new y).parseFromString(s,M)}catch(e){}if(!t||!t.documentElement){t=D.createDocument(we,"template",null);try{t.documentElement.innerHTML=xe?"":s}catch(e){}}var a=t.body||t.documentElement;return e&&n&&a.insertBefore(r.createTextNode(n),a.childNodes[0]||null),we===Ce?O.call(t,ne?"html":"body")[0]:ne?t.documentElement:a},Fe=function(e){return A.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},Ue=function(e){return e instanceof b&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},ze=function(e){return"object"===t(l)?e instanceof l:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},je=function(e,t,o){L[e]&&L_(L[e],(function(e){e.call(n,t,o,_e)}))},He=function(e){var t;if(je("beforeSanitizeElements",e,null),Ue(e))return Le(e),!0;if(V_(/[\u0080-\uFFFF]/,e.nodeName))return Le(e),!0;var o=I(e.nodeName);if(je("uponSanitizeElement",e,{tagName:o,allowedTags:q}),e.hasChildNodes()&&!ze(e.firstElementChild)&&(!ze(e.content)||!ze(e.content.firstElementChild))&&V_(/<[/\w]/g,e.innerHTML)&&V_(/<[/\w]/g,e.textContent))return Le(e),!0;if("select"===o&&V_(/<template/i,e.innerHTML))return Le(e),!0;if(!q[o]||X[o]){if(!X[o]&&$e(o)){if(Y.tagNameCheck instanceof RegExp&&V_(Y.tagNameCheck,o))return!1;if(Y.tagNameCheck instanceof Function&&Y.tagNameCheck(o))return!1}if(de&&!ue[o]){var r=S(e)||e.parentNode,s=k(e)||e.childNodes;if(s&&r)for(var a=s.length-1;a>=0;--a)r.insertBefore(w(s[a],!0),x(e))}return Le(e),!0}return e instanceof d&&!Pe(e)?(Le(e),!0):"noscript"!==o&&"noembed"!==o||!V_(/<\/no(script|embed)/i,e.innerHTML)?(te&&3===e.nodeType&&(t=e.textContent,t=z_(t,F," "),t=z_(t,U," "),e.textContent!==t&&(I_(n.removed,{element:e.cloneNode()}),e.textContent=t)),je("afterSanitizeElements",e,null),!1):(Le(e),!0)},Ve=function(e,t,n){if(le&&("id"===t||"name"===t)&&(n in r||n in Ee))return!1;if(Z&&!Q[t]&&V_(z,t));else if(J&&V_(j,t));else if(!K[t]||Q[t]){if(!($e(e)&&(Y.tagNameCheck instanceof RegExp&&V_(Y.tagNameCheck,e)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(e))&&(Y.attributeNameCheck instanceof RegExp&&V_(Y.attributeNameCheck,t)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(t))||"is"===t&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&V_(Y.tagNameCheck,n)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(n))))return!1}else if(he[t]);else if(V_($,z_(n,V,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==j_(n,"data:")||!ge[e]){if(ee&&!V_(H,z_(n,V,"")));else if(n)return!1}else;return!0},$e=function(e){return e.indexOf("-")>0},qe=function(e){var t,n,o,r;je("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:K};for(r=s.length;r--;){var i=t=s[r],l=i.name,d=i.namespaceURI;n="value"===l?t.value:H_(t.value),o=I(l);var c=n;if(a.attrName=o,a.attrValue=n,a.keepAttr=!0,a.forceKeepAttr=void 0,je("uponSanitizeAttribute",e,a),n=a.attrValue,!a.forceKeepAttr)if(a.keepAttr)if(V_(/\/>/i,n))Me(l,e);else{te&&(n=z_(n,F," "),n=z_(n,U," "));var m=I(e.nodeName);if(Ve(m,o,n)){if(n!==c)try{d?e.setAttributeNS(d,l,n):e.setAttribute(l,n)}catch(t){Me(l,e)}}else Me(l,e)}else Me(l,e)}je("afterSanitizeAttributes",e,null)}},We=function e(t){var n,o=Fe(t);for(je("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)je("uponSanitizeShadowNode",n,null),He(n)||(n.content instanceof a&&e(n.content),qe(n));je("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(r,s){var i,d,c,m,u;if((xe=!r)&&(r="<!-->"),"string"!=typeof r&&!ze(r)){if("function"!=typeof r.toString)throw $_("toString is not a function");if("string"!=typeof(r=r.toString()))throw $_("dirty is not a string, aborting")}if(!n.isSupported){if("object"===t(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof r)return e.toStaticHTML(r);if(ze(r))return e.toStaticHTML(r.outerHTML)}return r}if(oe||Re(s),n.removed=[],"string"==typeof r&&(ce=!1),ce){if(r.nodeName){var f=I(r.nodeName);if(!q[f]||X[f])throw $_("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof l)1===(d=(i=Ie("<!---->")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===d.nodeName||"HTML"===d.nodeName?i=d:i.appendChild(d);else{if(!se&&!te&&!ne&&-1===r.indexOf("<"))return E&&ie?E.createHTML(r):r;if(!(i=Ie(r)))return se?null:ie?N:""}i&&re&&Le(i.firstChild);for(var g=Fe(ce?r:i);c=g.nextNode();)3===c.nodeType&&c===m||He(c)||(c.content instanceof a&&We(c.content),qe(c),m=c);if(m=null,ce)return r;if(se){if(ae)for(u=T.call(i.ownerDocument);i.firstChild;)u.appendChild(i.firstChild);else u=i;return K.shadowroot&&(u=B.call(o,u,!0)),u}var p=ne?i.outerHTML:i.innerHTML;return ne&&q["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&V_(dE,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),te&&(p=z_(p,F," "),p=z_(p,U," ")),E&&ie?E.createHTML(p):p},n.setConfig=function(e){Re(e),oe=!0},n.clearConfig=function(){_e=null,oe=!1},n.isValidAttribute=function(e,t,n){_e||Re({});var o=I(e),r=I(t);return Ve(o,r,n)},n.addHook=function(e,t){"function"==typeof t&&(L[e]=L[e]||[],I_(L[e],t))},n.removeHook=function(e){if(L[e])return M_(L[e])},n.removeHooks=function(e){L[e]&&(L[e]=[])},n.removeAllHooks=function(){L={}},n}var b=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},y=function(e){return-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(e)},v=function(e,t){return Array.prototype.slice.call(e).sort(t)},C=function(e,t){return w((function(n,o){return e.eq(t(n),t(o))}))},w=function(e){return{eq:e}},x=w((function(e,t){return e===t})),k=function(e){return w((function(t,n){if(t.length!==n.length)return!1;for(var o=t.length,r=0;r<o;r++)if(!e.eq(t[r],n[r]))return!1;return!0}))},S=function(e,t){return C(k(e),(function(e){return v(e,t)}))},_=function(e){return w((function(t,n){var o=Object.keys(t),r=Object.keys(n);if(!S(x).eq(o,r))return!1;for(var s=o.length,a=0;a<s;a++){var i=o[a];if(!e.eq(t[i],n[i]))return!1}return!0}))},E=w((function(e,t){if(e===t)return!0;var n=b(e);return n===b(t)&&(y(n)?e===t:"array"===n?k(E).eq(e,t):"object"===n&&_(E).eq(e,t))}));const N=Object.getPrototypeOf,R=(e,t,n)=>{var o;return!!n(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},D=e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&R(e,String,((e,t)=>t.isPrototypeOf(e)))?"string":t},A=e=>t=>D(t)===e,T=e=>t=>typeof t===e,O=e=>t=>e===t,B=(e,t)=>L(e)&&R(e,t,((e,t)=>N(e)===t)),P=A("string"),L=A("object"),M=e=>B(e,Object),I=A("array"),F=O(null),U=T("boolean"),z=O(void 0),j=e=>null==e,H=e=>!j(e),V=T("function"),$=T("number"),q=(e,t)=>{if(I(e)){for(let n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},W=()=>{},K=(e,t)=>(...n)=>e(t.apply(null,n)),G=(e,t)=>n=>e(t(n)),Y=e=>()=>e,X=e=>e,Q=(e,t)=>e===t,J=e=>t=>!e(t),Z=e=>()=>{throw new Error(e)},ee=e=>e(),te=e=>{e()},ne=Y(!1),oe=Y(!0);class re{constructor(e,t){this.tag=e,this.value=t}static some(e){return new re(!0,e)}static none(){return re.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?re.some(e(this.value)):re.none()}bind(e){return this.tag?e(this.value):re.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:re.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return H(e)?re.some(e):re.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}re.singletonNone=new re(!1);const se=Array.prototype.slice,ae=Array.prototype.indexOf,ie=Array.prototype.push,le=(e,t)=>ae.call(e,t),de=(e,t)=>{const n=le(e,t);return-1===n?re.none():re.some(n)},ce=(e,t)=>le(e,t)>-1,me=(e,t)=>{for(let n=0,o=e.length;n<o;n++){if(t(e[n],n))return!0}return!1},ue=(e,t)=>{const n=e.length,o=new Array(n);for(let r=0;r<n;r++){const n=e[r];o[r]=t(n,r)}return o},fe=(e,t)=>{for(let n=0,o=e.length;n<o;n++){t(e[n],n)}},ge=(e,t)=>{for(let n=e.length-1;n>=0;n--){t(e[n],n)}},pe=(e,t)=>{const n=[],o=[];for(let r=0,s=e.length;r<s;r++){const s=e[r];(t(s,r)?n:o).push(s)}return{pass:n,fail:o}},he=(e,t)=>{const n=[];for(let o=0,r=e.length;o<r;o++){const r=e[o];t(r,o)&&n.push(r)}return n},be=(e,t,n)=>(ge(e,((e,o)=>{n=t(n,e,o)})),n),ye=(e,t,n)=>(fe(e,((e,o)=>{n=t(n,e,o)})),n),ve=(e,t,n)=>{for(let o=0,r=e.length;o<r;o++){const r=e[o];if(t(r,o))return re.some(r);if(n(r,o))break}return re.none()},Ce=(e,t)=>ve(e,t,ne),we=(e,t)=>{for(let n=0,o=e.length;n<o;n++){if(t(e[n],n))return re.some(n)}return re.none()},xe=e=>{const t=[];for(let n=0,o=e.length;n<o;++n){if(!I(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);ie.apply(t,e[n])}return t},ke=(e,t)=>xe(ue(e,t)),Se=(e,t)=>{for(let n=0,o=e.length;n<o;++n){if(!0!==t(e[n],n))return!1}return!0},_e=e=>{const t=se.call(e,0);return t.reverse(),t},Ee=(e,t)=>he(e,(e=>!ce(t,e))),Ne=(e,t)=>{const n={};for(let o=0,r=e.length;o<r;o++){const r=e[o];n[String(r)]=t(r,o)}return n},Re=(e,t)=>{const n=se.call(e,0);return n.sort(t),n},De=(e,t)=>t>=0&&t<e.length?re.some(e[t]):re.none(),Ae=e=>De(e,0),Te=e=>De(e,e.length-1),Oe=V(Array.from)?Array.from:e=>se.call(e),Be=(e,t)=>{for(let n=0;n<e.length;n++){const o=t(e[n],n);if(o.isSome())return o}return re.none()},Pe=(e,t)=>{const n=[],o=V(t)?e=>me(n,(n=>t(n,e))):e=>ce(n,e);for(let t=0,r=e.length;t<r;t++){const r=e[t];o(r)||n.push(r)}return n},Le=Object.keys,Me=Object.hasOwnProperty,Ie=(e,t)=>{const n=Le(e);for(let o=0,r=n.length;o<r;o++){const r=n[o];t(e[r],r)}},Fe=(e,t)=>Ue(e,((e,n)=>({k:n,v:t(e,n)}))),Ue=(e,t)=>{const n={};return Ie(e,((e,o)=>{const r=t(e,o);n[r.k]=r.v})),n},ze=e=>(t,n)=>{e[n]=t},je=(e,t,n,o)=>{const r={};return Ie(e,((e,r)=>{(t(e,r)?n:o)(e,r)})),r},He=(e,t)=>{const n={},o={};return je(e,t,ze(n),ze(o)),{t:n,f:o}},Ve=(e,t)=>{const n={};return je(e,t,ze(n),W),n},$e=(e,t)=>{const n=[];return Ie(e,((e,o)=>{n.push(t(e,o))})),n},qe=e=>$e(e,X),We=(e,t)=>Ke(e,t)?re.from(e[t]):re.none(),Ke=(e,t)=>Me.call(e,t),Ge=(e,t)=>Ke(e,t)&&void 0!==e[t]&&null!==e[t],Ye=(e,t,n=E)=>_(n).eq(e,t),Xe=e=>{const t={};return fe(e,(e=>{t[e]={}})),Le(t)},Qe=Array.isArray,Je=e=>{if(Qe(e))return e;{const t=[];for(let n=0,o=e.length;n<o;n++)t[n]=e[n];return t}},Ze=(e,t,n)=>{let o,r;if(!e)return!1;if(n=n||e,void 0!==e.length){for(o=0,r=e.length;o<r;o++)if(!1===t.call(n,e[o],o,e))return!1}else for(o in e)if(Ke(e,o)&&!1===t.call(n,e[o],o,e))return!1;return!0},et=(e,t)=>{const n=[];return Ze(e,((o,r)=>{n.push(t(o,r,e))})),n},tt=(e,t)=>{const n=[];return Ze(e,((o,r)=>{t&&!t(o,r,e)||n.push(o)})),n},nt=(e,t)=>{if(e)for(let n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1},ot=(e,t,n,o)=>{let r=z(n)?e[0]:n;for(let n=0;n<e.length;n++)r=t.call(o,r,e[n],n);return r},rt=(e,t,n)=>{let o,r;for(o=0,r=e.length;o<r;o++)if(t.call(n,e[o],o,e))return o;return-1},st=e=>e[e.length-1],at=e=>{let t,n=!1;return(...o)=>(n||(n=!0,t=e.apply(null,o)),t)},it=(e,t,n,o)=>{const r=e.isiOS()&&!0===/ipad/i.test(n),s=e.isiOS()&&!r,a=e.isiOS()||e.isAndroid(),i=a||o("(pointer:coarse)"),l=r||!s&&a&&o("(min-device-width:768px)"),d=s||a&&!l,c=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),m=!d&&!l&&!c;return{isiPad:Y(r),isiPhone:Y(s),isTablet:Y(l),isPhone:Y(d),isTouch:Y(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:Y(c),isDesktop:Y(m)}},lt=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n];if(o.test(t))return o}},dt=(e,t)=>{const n=lt(e,t);if(!n)return{major:0,minor:0};const o=e=>Number(t.replace(n,"$"+e));return ut(o(1),o(2))},ct=(e,t)=>{const n=String(t).toLowerCase();return 0===e.length?mt():dt(e,n)},mt=()=>ut(0,0),ut=(e,t)=>({major:e,minor:t}),ft={nu:ut,detect:ct,unknown:mt},gt=(e,t)=>Be(t.brands,(t=>{const n=t.brand.toLowerCase();return Ce(e,(e=>{var t;return n===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())})).map((e=>({current:e.name,version:ft.nu(parseInt(t.version,10),0)})))})),pt=(e,t)=>{const n=String(t).toLowerCase();return Ce(e,(e=>e.search(n)))},ht=(e,t)=>pt(e,t).map((e=>{const n=ft.detect(e.versionRegexes,t);return{current:e.name,version:n}})),bt=(e,t)=>pt(e,t).map((e=>{const n=ft.detect(e.versionRegexes,t);return{current:e.name,version:n}})),yt=(e,t)=>e.substring(t),vt=(e,t,n)=>""===t||e.length>=t.length&&e.substr(n,n+t.length)===t,Ct=(e,t)=>xt(e,t)?yt(e,t.length):e,wt=(e,t)=>-1!==e.indexOf(t),xt=(e,t)=>vt(e,t,0),kt=(e,t)=>vt(e,t,e.length-t.length),St=e=>t=>t.replace(e,""),_t=St(/^\s+|\s+$/g),Et=St(/^\s+/g),Nt=St(/\s+$/g),Rt=e=>e.length>0,Dt=e=>!Rt(e),At=(e,t)=>t<=0?"":new Array(t+1).join(e),Tt=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?re.none():re.some(n)},Ot=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Bt=e=>t=>wt(t,e),Pt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>wt(e,"edge/")&&wt(e,"chrome")&&wt(e,"safari")&&wt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ot],search:e=>wt(e,"chrome")&&!wt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>wt(e,"msie")||wt(e,"trident")},{name:"Opera",versionRegexes:[Ot,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Bt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Bt("firefox")},{name:"Safari",versionRegexes:[Ot,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(wt(e,"safari")||wt(e,"mobile/"))&&wt(e,"applewebkit")}],Lt=[{name:"Windows",search:Bt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>wt(e,"iphone")||wt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Bt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Bt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Bt("linux"),versionRegexes:[]},{name:"Solaris",search:Bt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Bt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Bt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Mt={browsers:Y(Pt),oses:Y(Lt)},It="Edge",Ft="Chromium",Ut="IE",zt="Opera",jt="Firefox",Ht="Safari",Vt=()=>$t({current:void 0,version:ft.unknown()}),$t=e=>{const t=e.current,n=e.version,o=e=>()=>t===e;return{current:t,version:n,isEdge:o(It),isChromium:o(Ft),isIE:o(Ut),isOpera:o(zt),isFirefox:o(jt),isSafari:o(Ht)}},qt={unknown:Vt,nu:$t,edge:Y(It),chromium:Y(Ft),ie:Y(Ut),opera:Y(zt),firefox:Y(jt),safari:Y(Ht)},Wt="Windows",Kt="iOS",Gt="Android",Yt="Linux",Xt="macOS",Qt="Solaris",Jt="FreeBSD",Zt="ChromeOS",en=()=>tn({current:void 0,version:ft.unknown()}),tn=e=>{const t=e.current,n=e.version,o=e=>()=>t===e;return{current:t,version:n,isWindows:o(Wt),isiOS:o(Kt),isAndroid:o(Gt),isMacOS:o(Xt),isLinux:o(Yt),isSolaris:o(Qt),isFreeBSD:o(Jt),isChromeOS:o(Zt)}},nn={unknown:en,nu:tn,windows:Y(Wt),ios:Y(Kt),android:Y(Gt),linux:Y(Yt),macos:Y(Xt),solaris:Y(Qt),freebsd:Y(Jt),chromeos:Y(Zt)},on=(e,t,n)=>{const o=Mt.browsers(),r=Mt.oses(),s=t.bind((e=>gt(o,e))).orThunk((()=>ht(o,e))).fold(qt.unknown,qt.nu),a=bt(r,e).fold(nn.unknown,nn.nu);return{browser:s,os:a,deviceType:it(a,s,e,n)}},rn={detect:on},sn=e=>window.matchMedia(e).matches;let an=at((()=>rn.detect(navigator.userAgent,re.from(navigator.userAgentData),sn)));const ln=()=>an(),dn=navigator.userAgent,cn=ln(),mn=cn.browser,un=cn.os,fn=cn.deviceType,gn=-1!==dn.indexOf("Windows Phone"),pn={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:mn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!mn.isIE(),windowsPhone:gn,browser:{current:mn.current,version:mn.version,isChromium:mn.isChromium,isEdge:mn.isEdge,isFirefox:mn.isFirefox,isIE:mn.isIE,isOpera:mn.isOpera,isSafari:mn.isSafari},os:{current:un.current,version:un.version,isAndroid:un.isAndroid,isChromeOS:un.isChromeOS,isFreeBSD:un.isFreeBSD,isiOS:un.isiOS,isLinux:un.isLinux,isMacOS:un.isMacOS,isSolaris:un.isSolaris,isWindows:un.isWindows},deviceType:{isDesktop:fn.isDesktop,isiPad:fn.isiPad,isiPhone:fn.isiPhone,isPhone:fn.isPhone,isTablet:fn.isTablet,isTouch:fn.isTouch,isWebView:fn.isWebView}},hn=/^\s*|\s*$/g,bn=e=>null==e?"":(""+e).replace(hn,""),yn=(e,t)=>t?!("array"!==t||!Qe(e))||typeof e===t:void 0!==e,vn=(e,t,n)=>{let o;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},o=e.length;o--;)n[e[o]]={};return n},Cn=(e,...t)=>{for(let n=0;n<t.length;n++){const o=t[n];for(const t in o)if(Ke(o,t)){const n=o[t];void 0!==n&&(e[t]=n)}}return e},wn=function(e,t,n,o){o=o||this,e&&(n&&(e=e[n]),Ze(e,((e,r)=>{if(!1===t.call(o,e,r,n))return!1;wn(e,t,n,o)})))},xn=(e,t)=>!e||yn(e,"array")?e:et(e.split(t||","),bn),kn={trim:bn,isArray:Qe,is:yn,toArray:Je,makeMap:vn,each:Ze,map:et,grep:tt,inArray:nt,hasOwn:Ke,extend:Cn,walk:wn,resolve:(e,t)=>{let n,o;for(t=t||window,n=0,o=(e=e.split(".")).length;n<o&&(t=t[e[n]]);n++);return t},explode:xn,_addCacheSuffix:e=>{const t=pn.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},Sn=(e,t,n=Q)=>e.exists((e=>n(e,t))),_n=e=>{const t=[],n=e=>{t.push(e)};for(let t=0;t<e.length;t++)e[t].each(n);return t},En=(e,t,n)=>e.isSome()&&t.isSome()?re.some(n(e.getOrDie(),t.getOrDie())):re.none(),Nn=(e,t,n,o)=>e.isSome()&&t.isSome()&&n.isSome()?re.some(o(e.getOrDie(),t.getOrDie(),n.getOrDie())):re.none(),Rn=(e,t)=>e?re.some(t):re.none();"undefined"!=typeof window?window:Function("return this;")();const Dn=8,An=9,Tn=11,On=1,Bn=3,Pn=e=>e.dom.nodeName.toLowerCase(),Ln=e=>e.dom.nodeType,Mn=e=>t=>Ln(t)===e,In=e=>Ln(e)===Dn||"#comment"===Pn(e),Fn=Mn(On),Un=Mn(Bn),zn=Mn(An),jn=Mn(Tn),Hn=e=>t=>Fn(t)&&Pn(t)===e,Vn=(e,t,n)=>{if(!(P(n)||U(n)||$(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},$n=(e,t,n)=>{Vn(e.dom,t,n)},qn=(e,t)=>{const n=e.dom;Ie(t,((e,t)=>{Vn(n,t,e)}))},Wn=(e,t)=>{const n=e.dom.getAttribute(t);return null===n?void 0:n},Kn=(e,t)=>re.from(Wn(e,t)),Gn=(e,t)=>{const n=e.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},Yn=(e,t)=>{e.dom.removeAttribute(t)},Xn=e=>{const t=e.dom.attributes;return null==t||0===t.length},Qn=e=>ye(e.dom.attributes,((e,t)=>(e[t.name]=t.value,e)),{}),Jn=(e,t)=>{const n=Wn(e,t);return void 0===n||""===n?[]:n.split(" ")},Zn=(e,t,n)=>{const o=Jn(e,t).concat([n]);return $n(e,t,o.join(" ")),!0},eo=(e,t,n)=>{const o=he(Jn(e,t),(e=>e!==n));return o.length>0?$n(e,t,o.join(" ")):Yn(e,t),!1},to=e=>void 0!==e.dom.classList,no=e=>Jn(e,"class"),oo=(e,t)=>Zn(e,"class",t),ro=(e,t)=>eo(e,"class",t),so=(e,t)=>ce(no(e),t)?ro(e,t):oo(e,t),ao=(e,t)=>{to(e)?e.dom.classList.add(t):oo(e,t)},io=e=>{0===(to(e)?e.dom.classList:no(e)).length&&Yn(e,"class")},lo=(e,t)=>{if(to(e)){e.dom.classList.remove(t)}else ro(e,t);io(e)},co=(e,t)=>{const n=to(e)?e.dom.classList.toggle(t):so(e,t);return io(e),n},mo=(e,t)=>to(e)&&e.dom.classList.contains(t),uo=e=>void 0!==e.style&&V(e.style.getPropertyValue),fo=(e,t)=>{const n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return ho(n.childNodes[0])},go=(e,t)=>{const n=(t||document).createElement(e);return ho(n)},po=(e,t)=>{const n=(t||document).createTextNode(e);return ho(n)},ho=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},bo={fromHtml:fo,fromTag:go,fromText:po,fromDom:ho,fromPoint:(e,t,n)=>re.from(e.dom.elementFromPoint(t,n)).map(ho)},yo=(e,t)=>{const n=[],o=e=>(n.push(e),t(e));let r=t(e);do{r=r.bind(o)}while(r.isSome());return n},vo=(e,t)=>{const n=e.dom;if(n.nodeType!==On)return!1;{const e=n;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Co=e=>e.nodeType!==On&&e.nodeType!==An&&e.nodeType!==Tn||0===e.childElementCount,wo=(e,t)=>{const n=void 0===t?document:t.dom;return Co(n)?[]:ue(n.querySelectorAll(e),bo.fromDom)},xo=(e,t)=>{const n=void 0===t?document:t.dom;return Co(n)?re.none():re.from(n.querySelector(e)).map(bo.fromDom)},ko=(e,t)=>e.dom===t.dom,So=(e,t)=>{const n=e.dom,o=t.dom;return n!==o&&n.contains(o)},_o=e=>bo.fromDom(e.dom.ownerDocument),Eo=e=>zn(e)?e:_o(e),No=e=>bo.fromDom(Eo(e).dom.documentElement),Ro=e=>bo.fromDom(Eo(e).dom.defaultView),Do=e=>re.from(e.dom.parentNode).map(bo.fromDom),Ao=e=>re.from(e.dom.parentElement).map(bo.fromDom),To=(e,t)=>{const n=V(t)?t:ne;let o=e.dom;const r=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){const e=o.parentNode,t=bo.fromDom(e);if(r.push(t),!0===n(t))break;o=e}return r},Oo=e=>{const t=t=>he(t,(t=>!ko(e,t)));return Do(e).map(Io).map(t).getOr([])},Bo=e=>re.from(e.dom.previousSibling).map(bo.fromDom),Po=e=>re.from(e.dom.nextSibling).map(bo.fromDom),Lo=e=>_e(yo(e,Bo)),Mo=e=>yo(e,Po),Io=e=>ue(e.dom.childNodes,bo.fromDom),Fo=(e,t)=>{const n=e.dom.childNodes;return re.from(n[t]).map(bo.fromDom)},Uo=e=>Fo(e,0),zo=e=>Fo(e,e.dom.childNodes.length-1),jo=e=>e.dom.childNodes.length,Ho=e=>{const t=e.dom.head;if(null==t)throw new Error("Head is not available yet");return bo.fromDom(t)},Vo=e=>jn(e)&&H(e.dom.host),$o=V(Element.prototype.attachShadow)&&V(Node.prototype.getRootNode),qo=Y($o),Wo=$o?e=>bo.fromDom(e.dom.getRootNode()):Eo,Ko=e=>Vo(e)?e:Ho(Eo(e)),Go=e=>{const t=Wo(e);return Vo(t)?re.some(t):re.none()},Yo=e=>bo.fromDom(e.dom.host),Xo=e=>{if(qo()&&H(e.target)){const t=bo.fromDom(e.target);if(Fn(t)&&Qo(t)&&e.composed&&e.composedPath){const t=e.composedPath();if(t)return Ae(t)}}return re.from(e.target)},Qo=e=>H(e.dom.shadowRoot),Jo=e=>{const t=Un(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const n=t.ownerDocument;return Go(bo.fromDom(t)).fold((()=>n.body.contains(t)),G(Jo,Yo))},Zo=(e,t,n)=>{if(!P(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);uo(e)&&e.style.setProperty(t,n)},er=(e,t)=>{uo(e)&&e.style.removeProperty(t)},tr=(e,t,n)=>{const o=e.dom;Zo(o,t,n)},nr=(e,t)=>{const n=e.dom;Ie(t,((e,t)=>{Zo(n,t,e)}))},or=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return""!==o||Jo(e)?o:rr(n,t)},rr=(e,t)=>uo(e)?e.style.getPropertyValue(t):"",sr=(e,t)=>{const n=e.dom,o=rr(n,t);return re.from(o).filter((e=>e.length>0))},ar=e=>{const t={},n=e.dom;if(uo(n))for(let e=0;e<n.style.length;e++){const o=n.style.item(e);t[o]=n.style[o]}return t},ir=(e,t)=>{const n=e.dom;er(n,t),Sn(Kn(e,"style").map(_t),"")&&Yn(e,"style")},lr=e=>e.dom.offsetWidth,dr=(e,t)=>{Do(e).each((n=>{n.dom.insertBefore(t.dom,e.dom)}))},cr=(e,t)=>{Po(e).fold((()=>{Do(e).each((e=>{ur(e,t)}))}),(e=>{dr(e,t)}))},mr=(e,t)=>{Uo(e).fold((()=>{ur(e,t)}),(n=>{e.dom.insertBefore(t.dom,n.dom)}))},ur=(e,t)=>{e.dom.appendChild(t.dom)},fr=(e,t)=>{dr(e,t),ur(t,e)},gr=(e,t)=>{fe(t,((n,o)=>{const r=0===o?e:t[o-1];cr(r,n)}))},pr=(e,t)=>{fe(t,(t=>{ur(e,t)}))},hr=e=>{e.dom.textContent="",fe(Io(e),(e=>{br(e)}))},br=e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},yr=e=>{const t=Io(e);t.length>0&&gr(e,t),br(e)},vr=(e,t)=>{const n=(t||document).createElement("div");return n.innerHTML=e,Io(bo.fromDom(n))},Cr=e=>ue(e,bo.fromDom),wr=e=>e.dom.innerHTML,xr=(e,t)=>{const n=_o(e).dom,o=bo.fromDom(n.createDocumentFragment()),r=vr(t,n);pr(o,r),hr(e),ur(e,o)},kr=e=>{
const t=bo.fromTag("div"),n=bo.fromDom(e.dom.cloneNode(!0));return ur(t,n),wr(t)},Sr=(e,t,n,o,r,s,a)=>({target:e,x:t,y:n,stop:o,prevent:r,kill:s,raw:a}),_r=e=>{const t=bo.fromDom(Xo(e).getOr(e.target)),n=()=>e.stopPropagation(),o=()=>e.preventDefault(),r=K(o,n);return Sr(t,e.clientX,e.clientY,n,o,r,e)},Er=(e,t)=>n=>{e(n)&&t(_r(n))},Nr=(t,n,o,r,s)=>{const a=Er(o,r);return t.dom.addEventListener(n,a,s),{unbind:e(Dr,t,n,a,s)}},Rr=(e,t,n,o)=>Nr(e,t,n,o,!1),Dr=(e,t,n,o)=>{e.dom.removeEventListener(t,n,o)},Ar=(e,t)=>({left:e,top:t,translate:(n,o)=>Ar(e+n,t+o)}),Tr=Ar,Or=e=>{const t=e.getBoundingClientRect();return Tr(t.left,t.top)},Br=(e,t)=>void 0!==e?e:void 0!==t?t:0,Pr=e=>{const t=e.dom.ownerDocument,n=t.body,o=t.defaultView,r=t.documentElement;if(n===e.dom)return Tr(n.offsetLeft,n.offsetTop);const s=Br(null==o?void 0:o.pageYOffset,r.scrollTop),a=Br(null==o?void 0:o.pageXOffset,r.scrollLeft),i=Br(r.clientTop,n.clientTop),l=Br(r.clientLeft,n.clientLeft);return Lr(e).translate(a-l,s-i)},Lr=e=>{const t=e.dom,n=t.ownerDocument.body;return n===t?Tr(n.offsetLeft,n.offsetTop):Jo(e)?Or(t):Tr(0,0)},Mr=e=>{const t=void 0!==e?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return Tr(n,o)},Ir=(e,t,n)=>{const o=(void 0!==n?n.dom:document).defaultView;o&&o.scrollTo(e,t)},Fr=(e,t)=>{ln().browser.isSafari()&&V(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Ur=e=>{const t=void 0===e?window:e;return ln().browser.isFirefox()?re.none():re.from(t.visualViewport)},zr=(e,t,n,o)=>({x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}),jr=e=>{const t=void 0===e?window:e,n=t.document,o=Mr(bo.fromDom(n));return Ur(t).fold((()=>{const e=t.document.documentElement,n=e.clientWidth,r=e.clientHeight;return zr(o.left,o.top,n,r)}),(e=>zr(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)))},Hr=e=>t=>!!t&&t.nodeType===e,Vr=e=>!!e&&!Object.getPrototypeOf(e),$r=Hr(1),qr=e=>{const t=e.map((e=>e.toLowerCase()));return e=>{if(e&&e.nodeName){const n=e.nodeName.toLowerCase();return ce(t,n)}return!1}},Wr=(e,t)=>{const n=t.toLowerCase().split(" ");return t=>{if($r(t))for(let o=0;o<n.length;o++){const r=t.ownerDocument.defaultView.getComputedStyle(t,null);if((r?r.getPropertyValue(e):null)===n[o])return!0}return!1}},Kr=e=>t=>$r(t)&&t.hasAttribute(e),Gr=(e,t)=>n=>$r(n)&&n.getAttribute(e)===t,Yr=e=>$r(e)&&e.hasAttribute("data-mce-bogus"),Xr=e=>$r(e)&&"all"===e.getAttribute("data-mce-bogus"),Qr=e=>$r(e)&&"TABLE"===e.tagName,Jr=e=>t=>{if($r(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1},Zr=qr(["textarea","input"]),es=Hr(3),ts=Hr(4),ns=Hr(7),os=Hr(8),rs=Hr(9),ss=Hr(11),as=qr(["br"]),is=qr(["img"]),ls=Jr("true"),ds=Jr("false"),cs=qr(["td","th"]),ms=qr(["video","audio","object","embed"]),us=ln().browser,fs=e=>Ce(e,Fn),gs=e=>us.isFirefox()&&"table"===Pn(e)?fs(Io(e)).filter((e=>"caption"===Pn(e))).bind((e=>fs(Mo(e)).map((t=>{const n=t.dom.offsetTop,o=e.dom.offsetTop,r=e.dom.offsetHeight;return n<=o?-r:0})))).getOr(0):0,ps=(e,t)=>e.children&&ce(e.children,t),hs=(e,t,n)=>{let o=0,r=0;const s=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===or(bo.fromDom(e),"position")){const n=t.getBoundingClientRect();return o=n.left+(s.documentElement.scrollLeft||e.scrollLeft)-s.documentElement.clientLeft,r=n.top+(s.documentElement.scrollTop||e.scrollTop)-s.documentElement.clientTop,{x:o,y:r}}let a=t;for(;a&&a!==n&&a.nodeType&&!ps(a,n);){const e=a;o+=e.offsetLeft||0,r+=e.offsetTop||0,a=e.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!ps(a,n);)o-=a.scrollLeft||0,r-=a.scrollTop||0,a=a.parentNode;r+=gs(bo.fromDom(t))}return{x:o,y:r}};var bs=(e,t,n,o,r)=>e(n,o)?re.some(n):V(r)&&r(n)?re.none():t(n,o,r);const ys=(e,t,n)=>{let o=e.dom;const r=V(n)?n:ne;for(;o.parentNode;){o=o.parentNode;const e=bo.fromDom(o);if(t(e))return re.some(e);if(r(e))break}return re.none()},vs=(e,t,n)=>bs(((e,t)=>t(e)),ys,e,t,n),Cs=(e,t)=>{const n=e.dom;return n.parentNode?ws(bo.fromDom(n.parentNode),(n=>!ko(e,n)&&t(n))):re.none()},ws=(e,t)=>{const n=e=>t(bo.fromDom(e));return Ce(e.dom.childNodes,n).map(bo.fromDom)},xs=(e,t)=>{const n=e=>{for(let o=0;o<e.childNodes.length;o++){const r=bo.fromDom(e.childNodes[o]);if(t(r))return re.some(r);const s=n(e.childNodes[o]);if(s.isSome())return s}return re.none()};return n(e.dom)},ks=(e,t,n)=>ys(e,(e=>vo(e,t)),n),Ss=(e,t)=>xo(t,e),_s=(e,t,n)=>{const o=(e,t)=>vo(e,t);return bs(o,ks,e,t,n)},Es=(e,t={})=>{let n=0;const o={},r=bo.fromDom(e),s=Eo(r),a=t.maxLoadTime||5e3,i=e=>{ur(Ko(r),e)},l=e=>{const t=Ko(r);Ss(t,"#"+e).each(br)},d=e=>We(o,e).getOrThunk((()=>({id:"mce-u"+n++,passed:[],failed:[],count:0}))),c=n=>new Promise(((r,l)=>{let c;const m=kn._addCacheSuffix(n),u=d(m);o[m]=u,u.count++;const f=(e,t)=>{fe(e,te),u.status=t,u.passed=[],u.failed=[],c&&(c.onload=null,c.onerror=null,c=null)},g=()=>f(u.passed,2),p=()=>f(u.failed,3),h=(e,t)=>{e()||(Date.now()-v<a?setTimeout(t):p())},b=()=>{h((()=>{const t=e.styleSheets;let n=t.length;for(;n--;){const e=t[n].ownerNode;if(e&&e.id===c.id)return g(),!0}return!1}),b)};if(r&&u.passed.push(r),l&&u.failed.push(l),1===u.status)return;if(2===u.status)return void g();if(3===u.status)return void p();u.status=1;const y=bo.fromTag("link",s.dom);qn(y,{rel:"stylesheet",type:"text/css",id:u.id});const v=Date.now();t.contentCssCors&&$n(y,"crossOrigin","anonymous"),t.referrerPolicy&&$n(y,"referrerpolicy",t.referrerPolicy),c=y.dom,c.onload=b,c.onerror=p,i(y),$n(y,"href",m)})),m=e=>Promise.allSettled(ue(e,(e=>c(e).then(Y(e))))).then((e=>{const t=pe(e,(e=>"fulfilled"===e.status));return t.fail.length>0?Promise.reject(ue(t.fail,(e=>e.reason))):ue(t.pass,(e=>e.value))})),u=e=>{const t=kn._addCacheSuffix(e);We(o,t).each((e=>{0===--e.count&&(delete o[t],l(e.id))}))},f=e=>{fe(e,(e=>{u(e)}))};return{load:c,loadAll:m,unload:u,unloadAll:f,_setReferrerPolicy:e=>{t.referrerPolicy=e}}},Ns=()=>{const e=new WeakMap;return{forElement:(t,n)=>{const o=Wo(t).dom;return re.from(e.get(o)).getOrThunk((()=>{const t=Es(o,n);return e.set(o,t),t}))}}},Rs=Ns();class Ds{constructor(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,t,n,o){let r,s;if(e){if(!o&&e[t])return e[t];if(e!==this.rootNode){if(r=e[n],r)return r;for(s=e.parentNode;s&&s!==this.rootNode;s=s.parentNode)if(r=s[n],r)return r}}}findPreviousNode(e,t){let n,o,r;if(e){if(n=e.previousSibling,this.rootNode&&n===this.rootNode)return;if(n){if(!t)for(r=n.lastChild;r;r=r.lastChild)if(!r.lastChild)return r;return n}if(o=e.parentNode,o&&o!==this.rootNode)return o}}}const As=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],Ts=["td","th"],Os=["thead","tbody","tfoot"],Bs=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],Ps=["h1","h2","h3","h4","h5","h6"],Ls=["li","dd","dt"],Ms=["ul","ol","dl"],Is=["pre","script","textarea","style"],Fs=["pre"].concat(Ps),Us=e=>{let t;return n=>(t=t||Ne(e,oe),Ke(t,Pn(n)))},zs=Us(As),js=e=>"table"===Pn(e),Hs=e=>Fn(e)&&!zs(e),Vs=e=>Fn(e)&&"br"===Pn(e),$s=Us(Bs),qs=Us(Ms),Ws=Us(Ls),Ks=Us(Os),Gs=Us(Ts),Ys=Us(Is),Xs=Us(Fs),Qs=e=>Xs(e)||Hs(e),Js=(e,t,n)=>ks(e,t,n).isSome(),Zs="\ufeff",ea="\xa0",ta=e=>e===Zs,na=e=>e.replace(/\uFEFF/g,""),oa=(e,t)=>{let n=[];return fe(Io(e),(e=>{t(e)&&(n=n.concat([e])),n=n.concat(oa(e,t))})),n},ra=(e,t)=>wo(t,e),sa=(e,t)=>{const n=n=>{if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return o(n).getOr("")},o=t=>e(t)?re.from(t.dom.nodeValue):re.none(),r=(n,o)=>{if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=o};return{get:n,getOption:o,set:r}},aa=sa(Un,"text"),ia=e=>aa.get(e),la=e=>aa.getOption(e),da=e=>{const t=[];let n=e.dom;for(;n;)t.push(bo.fromDom(n)),n=n.lastChild;return t},ca=e=>{const t=ra(e,"br"),n=he(da(e).slice(-1),Vs);t.length===n.length&&fe(n,br)},ma=()=>{const e=bo.fromTag("br");return $n(e,"data-mce-bogus","1"),e},ua=e=>{hr(e),ur(e,ma())},fa=e=>{zo(e).each((t=>{Bo(t).each((n=>{zs(e)&&Vs(t)&&zs(n)&&br(t)}))}))},ga=Zs,pa=ta,ha=na,ba=$r,ya=es,va=e=>(ya(e)&&(e=e.parentNode),ba(e)&&e.hasAttribute("data-mce-caret")),Ca=e=>ya(e)&&pa(e.data),wa=e=>va(e)||Ca(e),xa=e=>e.firstChild!==e.lastChild||!as(e.firstChild),ka=(e,t)=>{const n=e.ownerDocument.createTextNode(ga),o=e.parentNode;if(t){const t=e.previousSibling;if(ya(t)){if(wa(t))return t;if(Ra(t))return t.splitText(t.data.length-1)}o.insertBefore(n,e)}else{const t=e.nextSibling;if(ya(t)){if(wa(t))return t;if(Na(t))return t.splitText(1),t}e.nextSibling?o.insertBefore(n,e.nextSibling):o.appendChild(n)}return n},Sa=e=>{const t=e.container();return!!es(t)&&(t.data.charAt(e.offset())===ga||e.isAtStart()&&Ca(t.previousSibling))},_a=e=>{const t=e.container();return!!es(t)&&(t.data.charAt(e.offset()-1)===ga||e.isAtEnd()&&Ca(t.nextSibling))},Ea=(e,t,n)=>{const o=t.ownerDocument.createElement(e);o.setAttribute("data-mce-caret",n?"before":"after"),o.setAttribute("data-mce-bogus","all"),o.appendChild(ma().dom);const r=t.parentNode;return n?r.insertBefore(o,t):t.nextSibling?r.insertBefore(o,t.nextSibling):r.appendChild(o),o},Na=e=>ya(e)&&e.data[0]===ga,Ra=e=>ya(e)&&e.data[e.data.length-1]===ga,Da=e=>{const t=e.getElementsByTagName("br"),n=t[t.length-1];Yr(n)&&n.parentNode.removeChild(n)},Aa=e=>e&&e.hasAttribute("data-mce-caret")?(Da(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,Ta=e=>va(e.startContainer),Oa=ls,Ba=ds,Pa=as,La=es,Ma=qr(["script","style","textarea"]),Ia=qr(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Fa=qr(["table"]),Ua=wa,za=e=>!Ua(e)&&(La(e)?!Ma(e.parentNode):Ia(e)||Pa(e)||Fa(e)||Ha(e)),ja=e=>$r(e)&&"true"===e.getAttribute("unselectable"),Ha=e=>!1===ja(e)&&Ba(e),Va=(e,t)=>{for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Ha(e))return!1;if(Oa(e))return!0}return!0},$a=e=>!!Ha(e)&&!0!==ye(Oe(e.getElementsByTagName("*")),((e,t)=>e||Oa(t)),!1),qa=e=>Ia(e)||$a(e),Wa=(e,t)=>za(e)&&Va(e,t),Ka=/^[ \t\r\n]*$/,Ga=e=>Ka.test(e),Ya=e=>-1!==" \f\t\v".indexOf(e),Xa=e=>"\n"===e||"\r"===e,Qa=(e,t)=>t<e.length&&t>=0&&Xa(e[t]),Ja=(e,t=4,n=!0,o=!0)=>{const r=At(" ",t),s=e.replace(/\t/g,r);return ye(s,((e,t)=>Ya(t)||t===ea?e.pcIsSpace||""===e.str&&n||e.str.length===s.length-1&&o||Qa(s,e.str.length+1)?{pcIsSpace:!1,str:e.str+ea}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:Xa(t),str:e.str+t}),{pcIsSpace:!1,str:""}).str},Za=(t,n)=>{const o=bo.fromDom(n),r=bo.fromDom(t);return Js(r,"pre,code",e(ko,o))},ei=(e,t)=>es(e)&&Ga(e.data)&&!1===Za(e,t),ti=e=>$r(e)&&"A"===e.nodeName&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),ni=(e,t)=>za(e)&&!1===ei(e,t)||ti(e)||oi(e),oi=Kr("data-mce-bookmark"),ri=Kr("data-mce-bogus"),si=Gr("data-mce-bogus","all"),ai=(e,t)=>{let n=0;if(ni(e,e))return!1;{let o=e.firstChild;if(!o)return!0;const r=new Ds(o,e);do{if(t){if(si(o)){o=r.next(!0);continue}if(ri(o)){o=r.next();continue}}if(as(o))n++,o=r.next();else{if(ni(o,e))return!1;o=r.next()}}while(o);return n<=1}},ii=(e,t=!0)=>ai(e.dom,t),li=e=>"span"===e.nodeName.toLowerCase(),di=(e,t)=>H(e)&&(ni(e,t)||Hs(bo.fromDom(e))),ci=(e,t)=>{const n=new Ds(e,t).prev(!1),o=new Ds(e,t).next(!1),r=z(n)||di(n,t),s=z(o)||di(o,t);return r&&s},mi=e=>li(e)&&"bookmark"===e.getAttribute("data-mce-type"),ui=(e,t)=>es(e)&&e.data.length>0&&ci(e,t),fi=e=>!!$r(e)&&e.childNodes.length>0,gi=e=>ss(e)||rs(e),pi=(e,t,n)=>{const o=n||t;if($r(t)&&mi(t))return t;const r=t.childNodes;for(let t=r.length-1;t>=0;t--)pi(e,r[t],o);if($r(t)){const e=t.childNodes;1===e.length&&mi(e[0])&&t.parentNode.insertBefore(e[0],t)}return gi(t)||ni(t,o)||fi(t)||ui(t,o)||e.remove(t),t},hi=kn.makeMap,bi=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,yi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vi=/[<>&\"\']/g,Ci=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,wi={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"},xi={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ki={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},Si=e=>{const t=bo.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},_i=(e,t)=>{let n,o,r;const s={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)o=String.fromCharCode(parseInt(e[n],t)),xi[o]||(r="&"+e[n+1]+";",s[o]=r,s[r]=o);return s}},Ei=_i("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Ni=(e,t)=>e.replace(t?bi:yi,(e=>xi[e]||e)),Ri=e=>(""+e).replace(vi,(e=>xi[e]||e)),Di=(e,t)=>e.replace(t?bi:yi,(e=>e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":xi[e]||"&#"+e.charCodeAt(0)+";")),Ai=(e,t,n)=>(n=n||Ei,e.replace(t?bi:yi,(e=>xi[e]||n[e]||e))),Ti=(e,t)=>{const n=_i(t)||Ei,o=(e,t)=>e.replace(t?bi:yi,(e=>void 0!==xi[e]?xi[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";")),r=(e,t)=>Ai(e,t,n),s=hi(e.replace(/\+/g,","));return s.named&&s.numeric?o:s.named?t?r:Ai:s.numeric?Di:Ni},Oi=e=>e.replace(Ci,((e,t)=>t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):wi[t]||String.fromCharCode(t):ki[e]||Ei[e]||Si(e))),Bi={encodeRaw:Ni,encodeAllRaw:Ri,encodeNumeric:Di,encodeNamed:Ai,getEncodeFunc:Ti,decode:Oi},Pi={},Li={},Mi=kn.makeMap,Ii=kn.each,Fi=kn.extend,Ui=kn.explode,zi=kn.inArray,ji=(e,t)=>(e=kn.trim(e))?e.split(t||" "):[],Hi=(e,t)=>{const n=Mi(e," ",Mi(e.toUpperCase()," "));return Fi(n,t)},Vi=e=>Hi("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),$i=e=>{const t={};let n,o,r,s,a,i;const l=(e,o="",r="")=>{const s=ji(r),a=ji(e);let i=a.length;for(;i--;){const e=ji([n,o].join(" "));t[a[i]]={attributes:Ne(e,(()=>({}))),attributesOrder:e,children:Ne(s,Y(Li))}}},d=(e,n)=>{const o=ji(e),r=ji(n);let s=o.length;for(;s--;){const e=t[o[s]];for(let t=0,n=r.length;t<n;t++)e.attributes[r[t]]={},e.attributesOrder.push(r[t])}};return Pi[e]?Pi[e]:(n="id accesskey class dir lang style tabindex title role",o="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",o+=" article aside details dialog figure main header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(n+=" xml:lang",i="acronym applet basefont big font strike tt",r=[r,i].join(" "),Ii(ji(i),(e=>{l(e,"",r)})),a="center dir isindex noframes",o=[o,a].join(" "),s=[o,r].join(" "),Ii(ji(a),(e=>{l(e,"",s)}))),s=s||[o,r].join(" "),l("html","manifest","head body"),l("head","","base command link meta noscript script style title"),l("title hr noscript br"),l("base","href target"),l("link","href rel media hreflang type sizes hreflang"),l("meta","name http-equiv content charset"),l("style","media type scoped"),l("script","src async defer type charset"),l("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),l("address dt dd div caption","",s),l("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),l("blockquote","cite",s),l("ol","reversed start type","li"),l("ul","","li"),l("li","value",s),l("dl","","dt dd"),l("a","href target rel media hreflang type",r),l("q","cite",r),l("ins del","cite datetime",s),l("img","src sizes srcset alt usemap ismap width height"),l("iframe","src name width height",s),l("embed","src type width height"),l("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),l("param","name value"),l("map","name",[s,"area"].join(" ")),l("area","alt coords shape href target rel media hreflang type"),l("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),l("colgroup","span","col"),l("col","span"),l("tbody thead tfoot","","tr"),l("tr","","td th"),l("td","colspan rowspan headers",s),l("th","colspan rowspan headers scope abbr",s),l("form","accept-charset action autocomplete enctype method name novalidate target",s),l("fieldset","disabled form name",[s,"legend"].join(" ")),l("label","form for",r),l("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),l("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?s:r),l("select","disabled form multiple name required size","option optgroup"),l("optgroup","disabled label","option"),l("option","disabled label selected value"),l("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),l("menu","type label",[s,"li"].join(" ")),l("noscript","",s),"html4"!==e&&(l("wbr"),l("ruby","",[r,"rt rp"].join(" ")),l("figcaption","",s),l("mark rt rp summary bdi","",r),l("canvas","width height",s),l("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),l("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),l("picture","","img source"),l("source","src srcset type media sizes"),l("track","kind src srclang label default"),l("datalist","",[r,"option"].join(" ")),l("article section nav aside main header footer","",s),l("hgroup","","h1 h2 h3 h4 h5 h6"),l("figure","",[s,"figcaption"].join(" ")),l("time","datetime",r),l("dialog","open",s),l("command","type label icon disabled checked radiogroup command"),l("output","for form name",r),l("progress","value max",r),l("meter","value min max low high optimum",r),l("details","open",[s,"summary"].join(" ")),l("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(d("script","language xml:space"),d("style","xml:space"),d("object","declare classid code codebase codetype archive standby align border hspace vspace"),d("embed","align name hspace vspace"),d("param","valuetype type"),d("a","charset name rev shape coords"),d("br","clear"),d("applet","codebase archive code object alt name width height align hspace vspace"),d("img","name longdesc align border hspace vspace"),d("iframe","longdesc frameborder marginwidth marginheight scrolling align"),d("font basefont","size color face"),d("input","usemap align"),d("select"),d("textarea"),d("h1 h2 h3 h4 h5 h6 div p legend caption","align"),d("ul","type compact"),d("li","type"),d("ol dl menu dir","compact"),d("pre","width xml:space"),d("hr","align noshade size width"),d("isindex","prompt"),d("table","summary width frame rules cellspacing cellpadding align bgcolor"),d("col","width align char charoff valign"),d("colgroup","width align char charoff valign"),d("thead","align char charoff valign"),d("tr","align char charoff valign bgcolor"),d("th","axis align char charoff valign nowrap bgcolor width height"),d("form","accept"),d("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),d("tfoot","align char charoff valign"),d("tbody","align char charoff valign"),d("area","nohref"),d("body","background bgcolor text link vlink alink")),"html4"!==e&&(d("input button select textarea","autofocus"),d("input textarea","placeholder"),d("a","download"),d("link script img","crossorigin"),d("img","loading"),d("iframe","sandbox seamless allowfullscreen loading")),"html4"!==e&&fe([t.video,t.audio],(e=>{delete e.children.audio,delete e.children.video})),Ii(ji("a form meter progress dfn"),(e=>{t[e]&&delete t[e].children[e]})),delete t.caption.children.table,delete t.script,Pi[e]=t,t)},qi=(e,t)=>{let n;return e&&(n={},"string"==typeof e&&(e={"*":e}),Ii(e,((e,o)=>{n[o]=n[o.toUpperCase()]="map"===t?Mi(e,/[, ]/):Ui(e,/[, ]/)}))),n},Wi=e=>{var t;const n={},o={};let r=[];const s={},a={},i=(t,n,o)=>{let r=e[t];return r?r=Mi(r,/[, ]/,Mi(r.toUpperCase(),/[, ]/)):(r=Pi[t],r||(r=Hi(n,o),Pi[t]=r)),r},l=null!==(t=(e=e||{}).schema)&&void 0!==t?t:"html5",d=$i(l);!1===e.verify_html&&(e.valid_elements="*[*]");const c=qi(e.valid_styles),m=qi(e.invalid_styles,"map"),u=qi(e.valid_classes,"map"),f=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),h=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),b="td th iframe video audio object script code",y=i("non_empty_elements",b+" pre",p),v=i("move_caret_before_on_enter_elements",b+" table",p),C=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),w=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",C),x=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp");Ii("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),(e=>{a[e]=new RegExp("</"+e+"[^>]*>","gi")}));const k=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),S=e=>{let t,o,s,a,i,l,d,c,m,u,f,g,p,h,b,y,v,C;const w=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,x=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,S=/[*?+]/;if(e){const _=ji(e,",");for(n["@"]&&(y=n["@"].attributes,v=n["@"].attributesOrder),t=0,o=_.length;t<o;t++)if(i=w.exec(_[t]),i){if(h=i[1],m=i[2],b=i[3],c=i[5],g={},p=[],l={attributes:g,attributesOrder:p},"#"===h&&(l.paddEmpty=!0),"-"===h&&(l.removeEmpty=!0),"!"===i[4]&&(l.removeEmptyAttrs=!0),y&&(Ie(y,((e,t)=>{g[t]=e})),p.push.apply(p,v)),c)for(c=ji(c,"|"),s=0,a=c.length;s<a;s++)if(i=x.exec(c[s]),i){if(d={},f=i[1],u=i[2].replace(/[\\:]:/g,":"),h=i[3],C=i[4],"!"===f&&(l.attributesRequired=l.attributesRequired||[],l.attributesRequired.push(u),d.required=!0),"-"===f){delete g[u],p.splice(zi(p,u),1);continue}h&&("="===h&&(l.attributesDefault=l.attributesDefault||[],l.attributesDefault.push({name:u,value:C}),d.defaultValue=C),"~"===h&&(l.attributesForced=l.attributesForced||[],l.attributesForced.push({name:u,value:C}),d.forcedValue=C),"<"===h&&(d.validValues=Mi(C,"?"))),S.test(u)?(l.attributePatterns=l.attributePatterns||[],d.pattern=k(u),l.attributePatterns.push(d)):(g[u]||p.push(u),g[u]=d)}y||"@"!==m||(y=g,v=p),b&&(l.outputName=m,n[b]=l),S.test(m)?(l.pattern=k(m),r.push(l)):n[m]=l}}},_=e=>{r=[],fe(Le(n),(e=>{delete n[e]})),S(e),Ii(d,((e,t)=>{o[t]=e.children}))},E=e=>{const t=/^(~)?(.+)$/;e&&(Pi.text_block_elements=Pi.block_elements=null,Ii(ji(e,","),(e=>{const r=t.exec(e),a="~"===r[1],i=a?"span":"div",l=r[2];if(o[l]=o[i],s[l]=i,y[l.toUpperCase()]={},y[l]={},a||(w[l.toUpperCase()]={},w[l]={}),!n[l]){let e=n[i];e=Fi({},e),delete e.removeEmptyAttrs,delete e.removeEmpty,n[l]=e}Ii(o,((e,t)=>{e[i]&&(o[t]=e=Fi({},o[t]),e[l]=e[i])}))})))},N=e=>{const t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Pi[l]=null,e&&Ii(ji(e,","),(e=>{const n=t.exec(e);let r,s;n&&(s=n[1],r=s?o[n[2]]:o[n[2]]={"#comment":{}},r=o[n[2]],Ii(ji(n[3],"|"),(e=>{"-"===s?delete r[e]:r[e]={}})))}))},R=e=>{let t,o=n[e];if(o)return o;for(t=r.length;t--;)if(o=r[t],o.pattern.test(e))return o};e.valid_elements?_(e.valid_elements):(Ii(d,((e,t)=>{n[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},o[t]=e.children})),Ii(ji("strong/b em/i"),(e=>{const t=ji(e,"/");n[t[1]].outputName=t[0]})),Ii(x,((t,o)=>{n[o]&&(e.padd_empty_block_inline_children&&(n[o].paddInEmptyBlock=!0),n[o].removeEmpty=!0)})),Ii(ji("ol ul blockquote a table tbody"),(e=>{n[e]&&(n[e].removeEmpty=!0)})),Ii(ji("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(e=>{n[e].paddEmpty=!0})),Ii(ji("span"),(e=>{n[e].removeEmptyAttrs=!0}))),E(e.custom_elements),N(e.valid_children),S(e.extended_valid_elements),N("+ol[ul|ol],+ul[ul|ol]"),Ii({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},((e,t)=>{n[t]&&(n[t].parentsRequired=ji(e))})),e.invalid_elements&&Ii(Ui(e.invalid_elements),(e=>{n[e]&&delete n[e]})),R("span")||S("span[!data-mce-type|*]");const D=Y(c),A=Y(m),T=Y(u),O=Y(h),B=Y(w),P=Y(C),L=Y(x),M=Y(Object.seal(p)),I=Y(g),F=Y(y),U=Y(v),z=Y(f),j=Y(Object.seal(a)),H=(e,t)=>{const n=o[e.toLowerCase()];return!(!n||!n[t.toLowerCase()])},V=(e,t)=>{let n,o;const r=R(e);if(r){if(!t)return!0;if(r.attributes[t])return!0;if(n=r.attributePatterns,n)for(o=n.length;o--;)if(n[o].pattern.test(t))return!0}return!1},$=Y(s);return{type:l,children:o,elements:n,getValidStyles:D,getValidClasses:T,getBlockElements:B,getInvalidStyles:A,getVoidElements:M,getTextBlockElements:P,getTextInlineElements:L,getBoolAttrs:O,getElementRule:R,getSelfClosingElements:I,getNonEmptyElements:F,getMoveCaretBeforeOnEnterElements:U,getWhitespaceElements:z,getSpecialElements:j,isValidChild:H,isValid:V,getCustomElements:$,addValidElements:S,setValidElements:_,addCustomElements:E,addValidChildren:N}},Ki=(e,t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,o=/\s*([^:]+):\s*([^;]+);?/g,r=/\s+$/;let s;const a={};let i,l;const d=Zs;e=e||{},t&&(i=t.getValidStyles(),l=t.getInvalidStyles());const c=("\\\" \\' \\; \\: ; : "+d).split(" ");for(s=0;s<c.length;s++)a[c[s]]=d+s,a[d+s]=c[s];const m={parse:t=>{const i={};let l,c,u,f;const g=e.url_converter,p=e.url_converter_scope||m,h=(e,t,n)=>{const o=i[e+"-top"+t];if(!o)return;const r=i[e+"-right"+t];if(!r)return;const a=i[e+"-bottom"+t];if(!a)return;const l=i[e+"-left"+t];if(!l)return;const d=[o,r,a,l];for(s=d.length-1;s--&&d[s]===d[s+1];);s>-1&&n||(i[e+t]=-1===s?d[0]:d.join(" "),delete i[e+"-top"+t],delete i[e+"-right"+t],delete i[e+"-bottom"+t],delete i[e+"-left"+t])},b=e=>{let t,n=i[e];if(n){for(n=n.split(" "),t=n.length;t--;)if(n[t]!==n[0])return!1;return i[e]=n[0],!0}},y=(e,t,n,o)=>{b(t)&&b(n)&&b(o)&&(i[e]=i[t]+" "+i[n]+" "+i[o],delete i[t],delete i[n],delete i[o])},v=e=>(f=!0,a[e]),C=(e,t)=>(f&&(e=e.replace(/\uFEFF[0-9]/g,(e=>a[e]))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e),w=e=>String.fromCharCode(parseInt(e.slice(1),16)),x=e=>e.replace(/\\[0-9a-f]+/gi,w),k=(t,n,o,r,s,a)=>{if(s=s||a)return"'"+(s=C(s)).replace(/\'/g,"\\'")+"'";if(n=C(n||o||r),!e.allow_script_urls){const t=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(t))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(t))return""}return g&&(n=g.call(p,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,v).replace(/\"[^\"]+\"|\'[^\']+\'/g,(e=>e.replace(/[;:]/g,v)));l=o.exec(t);)if(o.lastIndex=l.index+l[0].length,c=l[1].replace(r,"").toLowerCase(),u=l[2].replace(r,""),c&&u){if(c=x(c),u=x(u),-1!==c.indexOf(d)||-1!==c.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===c||/expression\s*\(|\/\*|\*\//.test(u)))continue;"font-weight"===c&&"700"===u?u="bold":"color"!==c&&"background-color"!==c||(u=u.toLowerCase()),u=u.replace(n,k),i[c]=f?C(u,!0):u}h("border","",!0),h("border","-width"),h("border","-color"),h("border","-style"),h("padding",""),h("margin",""),y("border","border-width","border-style","border-color"),"medium none"===i.border&&delete i.border,"none"===i["border-image"]&&delete i["border-image"]}return i},serialize:(e,t)=>{let n="";const o=t=>{let o;const r=i[t];if(r)for(let s=0,a=r.length;s<a;s++)t=r[s],o=e[t],o&&(n+=(n.length>0?" ":"")+t+": "+o+";")},r=(e,t)=>{let n=l["*"];return(!n||!n[e])&&(n=l[t],!(n&&n[e]))};return t&&i?(o("*"),o(t)):Ie(e,((e,o)=>{!e||l&&!r(o,t)||(n+=(n.length>0?" ":"")+o+": "+e+";")})),n}};return m},Gi={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},Yi=e=>e instanceof Event||V(e.initEvent),Xi=e=>e.isDefaultPrevented===oe||e.isDefaultPrevented===ne,Qi=e=>j(e.preventDefault)||Yi(e),Ji=(e,t)=>{const n=null!=t?t:{};for(const t in e)Ke(Gi,t)||(n[t]=e[t]);return H(n.composedPath)&&(n.composedPath=()=>e.composedPath()),n},Zi=(e,t,n,o)=>{var r;const s=Ji(t,o);return s.type=e,j(s.target)&&(s.target=null!==(r=s.srcElement)&&void 0!==r?r:n),Qi(t)&&(s.preventDefault=()=>{s.defaultPrevented=!0,s.isDefaultPrevented=oe,V(t.preventDefault)&&t.preventDefault()},s.stopPropagation=()=>{s.cancelBubble=!0,s.isPropagationStopped=oe,V(t.stopPropagation)&&t.stopPropagation()},s.stopImmediatePropagation=()=>{s.isImmediatePropagationStopped=oe,s.stopPropagation()},Xi(s)||(s.isDefaultPrevented=!0===s.defaultPrevented?oe:ne,s.isPropagationStopped=!0===s.cancelBubble?oe:ne,s.isImmediatePropagationStopped=ne)),s},el="mce-data-",tl=/^(?:mouse|contextmenu)|click/,nl=(e,t,n,o)=>{
e.addEventListener?e.addEventListener(t,n,o||!1):e.attachEvent&&e.attachEvent("on"+t,n)},ol=(e,t,n,o)=>{e.removeEventListener?e.removeEventListener(t,n,o||!1):e.detachEvent&&e.detachEvent("on"+t,n)},rl=e=>H(e)&&tl.test(e.type),sl=(e,t)=>{const n=Zi(e.type,e,document,t);if(rl(e)&&z(e.pageX)&&!z(e.clientX)){const t=n.target.ownerDocument||document,o=t.documentElement,r=t.body,s=n;s.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),s.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},al=(e,t,n)=>{const o=e.document,r={type:"ready"};if(n.domLoaded)return void t(r);const s=()=>{ol(e,"DOMContentLoaded",s),ol(e,"load",s),n.domLoaded||(n.domLoaded=!0,t(r)),e=null};(()=>"complete"===o.readyState||"interactive"===o.readyState&&o.body)()?s():nl(e,"DOMContentLoaded",s),n.domLoaded||nl(e,"load",s)};class il{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=el+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,t,n,o){const r=this;let s,a,i,l,d,c,m;const u=window,f=e=>{r.executeHandlers(sl(e||u.event),s)};if(!e||3===e.nodeType||8===e.nodeType)return;e[r.expando]?s=e[r.expando]:(s=r.count++,e[r.expando]=s,r.events[s]={}),o=o||e;const g=t.split(" ");for(i=g.length;i--;)l=g[i],c=f,d=m=!1,"DOMContentLoaded"===l&&(l="ready"),r.domLoaded&&"ready"===l&&"complete"===e.readyState?n.call(o,sl({type:l})):(r.hasMouseEnterLeave||(d=r.mouseEnterLeave[l],d&&(c=e=>{const t=e.currentTarget;let n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=sl(e||u.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,r.executeHandlers(e,s))})),r.hasFocusIn||"focusin"!==l&&"focusout"!==l||(m=!0,d="focusin"===l?"focus":"blur",c=e=>{(e=sl(e||u.event)).type="focus"===e.type?"focusin":"focusout",r.executeHandlers(e,s)}),a=r.events[s][l],a?"ready"===l&&r.domLoaded?n(sl({type:l})):a.push({func:n,scope:o}):(r.events[s][l]=a=[{func:n,scope:o}],a.fakeName=d,a.capture=m,a.nativeHandler=c,"ready"===l?al(e,c,r):nl(e,d||l,c,m)));return e=a=null,n}unbind(e,t,n){let o,r,s,a,i;if(!e||3===e.nodeType||8===e.nodeType)return this;const l=e[this.expando];if(l){if(i=this.events[l],t){const l=t.split(" ");for(r=l.length;r--;)if(a=l[r],o=i[a],o){if(n)for(s=o.length;s--;)if(o[s].func===n){const e=o.nativeHandler,t=o.fakeName,n=o.capture;o=o.slice(0,s).concat(o.slice(s+1)),o.nativeHandler=e,o.fakeName=t,o.capture=n,i[a]=o}n&&0!==o.length||(delete i[a],ol(e,o.fakeName||a,o.nativeHandler,o.capture))}}else Ie(i,((t,n)=>{ol(e,t.fakeName||n,t.nativeHandler,t.capture)})),i={};for(a in i)if(Ke(i,a))return this;delete this.events[l];try{delete e[this.expando]}catch(t){e[this.expando]=null}}return this}fire(e,t,n){return this.dispatch(e,t,n)}dispatch(e,t,n){let o;if(!e||3===e.nodeType||8===e.nodeType)return this;const r=sl({type:t,target:e},n);do{o=e[this.expando],o&&this.executeHandlers(r,o),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!r.isPropagationStopped());return this}clean(e){let t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),n=e.getElementsByTagName("*"),t=n.length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,t){const n=this.events[t],o=n&&n[e.type];if(o)for(let t=0,n=o.length;t<n;t++){const n=o[t];if(n&&!1===n.func.call(n.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}}}il.Event=new il;const ll=kn.each,dl=kn.grep,cl="data-mce-style",ml=(e,t,n)=>{j(n)||""===n?Yn(e,t):$n(e,t,n)},ul=(e,t,n)=>{const o=t.keep_values,r={set:(e,o,r)=>{const s=bo.fromDom(e);V(t.url_converter)&&H(o)&&(o=t.url_converter.call(t.url_converter_scope||n(),o,r,e[0]));ml(s,"data-mce-"+r,o),ml(s,r,o)},get:(e,t)=>{const n=bo.fromDom(e);return Wn(n,"data-mce-"+t)||Wn(n,t)}},s={style:{set:(t,n)=>{const r=bo.fromDom(t);L(n)?nr(r,n):(o&&ml(r,cl,n),Yn(r,"style"),P(n)&&nr(r,e.parse(n)))},get:t=>{const n=bo.fromDom(t),o=Wn(n,cl)||Wn(n,"style");return e.serialize(e.parse(o),Pn(n))}}};return o&&(s.href=s.src=r),s},fl=(e,t)=>{const n=Wn(t,"style"),o=e.serialize(e.parse(n),Pn(t));ml(t,cl,o)},gl=(e,t)=>{let n,o,r=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)o=e.nodeType,(!t||3!==o||o!==n&&e.nodeValue.length)&&(r++,n=o);return r},pl=kn.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),hl=e=>e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),bl=(e,t={})=>{const n={},o=window,r={};let s=0;const a=!0,i=!0,l=Rs.forElement(bo.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),d=[],c=t.schema?t.schema:Wi({}),m=Ki({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),u=t.ownEvents?new il:il.Event,f=c.getBlockElements(),g=e=>P(e)?Ke(f,e):$r(e)&&Ke(f,e.nodeName),p=t=>t&&e&&P(t)?e.getElementById(t):t,h=e=>{const t=p(e);return H(t)?bo.fromDom(t):null},b=(e,t,n)=>{let o;const r=h(e);if(H(r)&&Fn(r)){const e=Ee[t];o=e&&e.get?e.get(r.dom,t):Wn(r,t)}return H(o)?o:null!=n?n:""},y=e=>{const t=p(e);return j(t)?[]:t.attributes},v=(e,n,o)=>{F(e,(e=>{if($r(e)){const r=bo.fromDom(e);""===o&&(o=null);const s=Wn(r,n),a=Ee[n];a&&a.set?a.set(r.dom,o,n):ml(r,n,o),s!==o&&t.onSetAttrib&&t.onSetAttrib({attrElm:r,attrName:n,attrValue:o})}}))},C=(e,t)=>e.cloneNode(t),w=()=>t.root_element||e.body,x=e=>{const t=jr(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},k=(t,n)=>hs(e.body,p(t),n),S=(e,n,o)=>{const r=(e,t)=>P(e)?e:$(e)?Ke(pl,t)?e+"":e+"px":Fe(e,r),s=(e,t,n)=>{const o=hl(t);j(n)||""===n?ir(e,o):tr(e,o,r(n,o))};F(e,(e=>{const r=bo.fromDom(e);P(n)?s(r,n,o):Ie(n,((e,t)=>{s(r,t,e)})),t.update_styles&&fl(m,r)}))},_=(e,t)=>{S(e,t)},E=(e,t,n)=>{const o=p(e);if(!j(o)&&$r(o))return n?or(bo.fromDom(o),hl(t)):("float"===(t=t.replace(/-(\D)/g,((e,t)=>t.toUpperCase())))&&(t="cssFloat"),o.style?o.style[t]:void 0)},N=e=>{let t,n;const o=p(e);return t=E(o,"width"),n=E(o,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||o.offsetWidth||o.clientWidth,h:parseInt(n,10)||o.offsetHeight||o.clientHeight}},R=e=>{const t=p(e),n=k(t),o=N(t);return{x:n.x,y:n.y,w:o.w,h:o.h}},D=(e,t)=>{if(!e)return!1;const n=I(e)?e:[e];return me(n,(e=>vo(bo.fromDom(e),t)))},A=(e,t,n,o)=>{const r=[];let s,a=p(e);for(o=void 0===o,n=n||("BODY"!==w().nodeName?w().parentNode:null),P(t)&&(s=t,t="*"===t?$r:e=>D(e,s));a&&!(a===n||j(a.nodeType)||rs(a)||ss(a));){if(!t||t(a)){if(!o)return[a];r.push(a)}a=a.parentNode}return o?r:null},T=(e,t,n)=>{const o=A(e,t,n,!1);return o&&o.length>0?o[0]:null},O=(e,t,n)=>{let o=t;if(e)for(P(t)&&(o=e=>D(e,t)),e=e[n];e;e=e[n])if(V(o)&&o(e))return e;return null},B=(e,t)=>O(e,t,"nextSibling"),L=(e,t)=>O(e,t,"previousSibling"),M=(n,o)=>{var r,s;const a=null!==(s=null!==(r=p(o))&&void 0!==r?r:t.root_element)&&void 0!==s?s:e;return Oe(a.querySelectorAll(n))},F=function(e,t,n){const o=null!=n?n:this,r=P(e)?p(e):e;if(!r)return!1;if(I(r)&&(r.length||0===r.length)){const e=[];return ll(r,((n,r)=>{n&&e.push(t.call(o,P(n)?p(n):n,r))})),e}return t.call(o,r)},U=(e,t)=>{F(e,(e=>{Ie(t,((t,n)=>{v(e,n,t)}))}))},z=(e,t)=>{F(e,(e=>{const n=bo.fromDom(e);xr(n,t)}))},q=(t,n,o,r,s)=>F(t,(t=>{const a=P(n)?e.createElement(n):n;return H(o)&&U(a,o),r&&(!P(r)&&r.nodeType?a.appendChild(r):P(r)&&z(a,r)),s?a:t.appendChild(a)})),K=(t,n,o)=>q(e.createElement(t),t,n,o,!0),G=Bi.decode,X=Bi.encodeAllRaw,Q=(e,t,n="")=>{let o,r="";for(o in r+="<"+e,t)Ge(t,o)&&(r+=" "+o+'="'+X(t[o])+'"');return Dt(n)&&Ke(c.getVoidElements(),e)?r+" />":r+">"+n+"</"+e+">"},J=t=>{let n;const o=e.createElement("div"),r=e.createDocumentFragment();for(r.appendChild(o),t&&(o.innerHTML=t);n=o.firstChild;)r.appendChild(n);return r.removeChild(o),r},Z=(e,t)=>F(e,(e=>{const n=bo.fromDom(e);return t&&fe(Io(n),(e=>{Un(e)&&0===e.dom.length?br(e):dr(n,e)})),br(n),n.dom})),ee=e=>m.parse(e),te=(e,t)=>m.serialize(e,t),ne=t=>{let o,r;if(_e!==bl.DOM&&e===document){if(n[t])return;n[t]=!0}r=e.getElementById("mceDefaultStyles"),r||(r=e.createElement("style"),r.id="mceDefaultStyles",r.type="text/css",o=e.getElementsByTagName("head")[0],o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r)),r.styleSheet?r.styleSheet.cssText+=t:r.appendChild(e.createTextNode(t))},oe=e=>{e||(e=""),fe(e.split(","),(e=>{r[e]=!0,l.load(e).catch(W)}))},re=(e,t,n)=>{F(e,(e=>{if($r(e)){const o=bo.fromDom(e),r=t.split(" ");fe(r,(e=>{if(H(n)){(n?ao:lo)(o,e)}else co(o,e)}))}}))},se=(e,t)=>{F(e,(e=>{$r(e)&&(e.outerHTML=t)}))},ae=(e,t)=>{const n=p(t);return F(e,(e=>{const t=n.parentNode,o=n.nextSibling;return o?t.insertBefore(e,o):t.appendChild(e),e}))},ie=(e,t,n)=>F(t,(t=>(I(t)&&(e=e.cloneNode(!0)),n&&ll(dl(t.childNodes),(t=>{e.appendChild(t)})),t.parentNode.replaceChild(e,t)))),le=(e,t)=>{let n;return e.nodeName!==t.toUpperCase()&&(n=K(t),ll(y(e),(t=>{v(n,t.nodeName,b(e,t.nodeName))})),ie(n,e,!0)),n||e},de=e=>{if($r(e)){const t="a"===e.nodeName.toLowerCase()&&!b(e,"href")&&b(e,"id");if(b(e,"name")||b(e,"data-mce-bookmark")||t)return!0}return!1},ce=(e,t)=>{let n,o,r=0;if(de(e))return!1;if(e=e.firstChild){const s=new Ds(e,e.parentNode),a=c?c.getWhitespaceElements():{};t=t||(c?c.getNonEmptyElements():null);do{if(n=e.nodeType,$r(e)){const n=e.getAttribute("data-mce-bogus");if(n){e=s.next("all"===n);continue}if(o=e.nodeName.toLowerCase(),t&&t[o]){if("br"===o){r++,e=s.next();continue}return!1}if(de(e))return!1}if(8===n)return!1;if(3===n&&!Ga(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&Ga(e.nodeValue))return!1;e=s.next()}while(e)}return r<=1},ue=()=>e.createRange(),ge=(e,t,n)=>{let o,r,s,a=ue();if(e&&t)return a.setStart(e.parentNode,gl(e)),a.setEnd(t.parentNode,gl(t)),o=a.extractContents(),a=ue(),a.setStart(t.parentNode,gl(t)+1),a.setEnd(e.parentNode,gl(e)+1),r=a.extractContents(),s=e.parentNode,s.insertBefore(pi(_e,o),e),n?s.insertBefore(n,e):s.insertBefore(t,e),s.insertBefore(pi(_e,r),e),Z(e),n||t},pe=(n,r,s,a)=>{if(I(n)){let e=n.length;const t=[];for(;e--;)t[e]=pe(n[e],r,s,a);return t}return!t.collect||n!==e&&n!==o||d.push([n,r,s,a]),u.bind(n,r,s,a||_e)},he=(t,n,r)=>{if(I(t)){let e=t.length;const o=[];for(;e--;)o[e]=he(t[e],n,r);return o}if(d.length>0&&(t===e||t===o)){let e=d.length;for(;e--;){const o=d[e];t!==o[0]||n&&n!==o[1]||r&&r!==o[2]||u.unbind(o[0],o[1],o[2])}}return u.unbind(t,n,r)},be=(e,t,n)=>u.dispatch(e,t,n),ye=(e,t,n)=>u.dispatch(e,t,n),ve=e=>{if(e&&$r(e)){const t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},Ce=e=>{const t=w();let n=null;for(;e&&e!==t&&(n=ve(e),null===n);e=e.parentNode);return n},we=()=>{if(d.length>0){let e=d.length;for(;e--;){const t=d[e];u.unbind(t[0],t[1],t[2])}}Ie(r,((e,t)=>{l.unload(t),delete r[t]}))},xe=(e,t)=>e===t||t.contains(e),ke=e=>"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset,_e={doc:e,settings:t,win:o,files:r,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:d,styles:m,schema:c,events:u,isBlock:g,root:null,clone:C,getRoot:w,getViewPort:x,getRect:R,getSize:N,getParent:T,getParents:A,get:p,getNext:B,getPrev:L,select:M,is:D,add:q,create:K,createHTML:Q,createFragment:J,remove:Z,setStyle:S,getStyle:E,setStyles:_,removeAllAttribs:e=>F(e,(e=>{const t=e.attributes;for(let n=t.length-1;n>=0;n--)e.removeAttributeNode(t.item(n))})),setAttrib:v,setAttribs:U,getAttrib:b,getPos:k,parseStyle:ee,serializeStyle:te,addStyle:ne,loadCSS:oe,addClass:(e,t)=>{re(e,t,!0)},removeClass:(e,t)=>{re(e,t,!1)},hasClass:(e,t)=>{const n=h(e),o=t.split(" ");return Se(o,(e=>mo(n,e)))},toggleClass:re,show:e=>{F(e,(e=>ir(bo.fromDom(e),"display")))},hide:e=>{F(e,(e=>tr(bo.fromDom(e),"display","none")))},isHidden:e=>{const t=h(e);return Sn(sr(t,"display"),"none")},uniqueId:e=>(e||"mce_")+s++,setHTML:z,getOuterHTML:e=>{const t=h(e);return $r(t.dom)?t.dom.outerHTML:kr(t)},setOuterHTML:se,decode:G,encode:X,insertAfter:ae,replace:ie,rename:le,findCommonAncestor:(e,t)=>{let n,o=e;for(;o;){for(n=t;n&&o!==n;)n=n.parentNode;if(o===n)break;o=o.parentNode}return!o&&e.ownerDocument?e.ownerDocument.documentElement:o},run:F,getAttribs:y,isEmpty:ce,createRng:ue,nodeIndex:gl,split:ge,bind:pe,unbind:he,fire:ye,dispatch:be,getContentEditable:ve,getContentEditableParent:Ce,destroy:we,isChildOf:xe,dumpRng:ke},Ee=ul(m,t,Y(_e));return _e};bl.DOM=bl(document),bl.nodeIndex=gl;const yl=bl.DOM,vl=0,Cl=1,wl=2,xl=3;class kl{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise(((t,n)=>{const o=yl;let r;const s=()=>{o.remove(l),r&&(r.onerror=r.onload=r=null)},a=()=>{s(),t()},i=()=>{s(),n("Failed to load script: "+e)},l=o.uniqueId();r=document.createElement("script"),r.id=l,r.type="text/javascript",r.src=kn._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=a,r.onerror=i,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)}))}isDone(e){return this.states[e]===wl}markDone(e){this.states[e]=wl}add(e){const t=this;t.queue.push(e);return void 0===t.states[e]&&(t.states[e]=vl),new Promise(((n,o)=>{t.scriptLoadedCallbacks[e]||(t.scriptLoadedCallbacks[e]=[]),t.scriptLoadedCallbacks[e].push({resolve:n,reject:o})}))}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){const e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){const t=this,n=(e,n)=>{We(t.scriptLoadedCallbacks,n).each((t=>{fe(t,(t=>t[e](n)))})),delete t.scriptLoadedCallbacks[n]},o=e=>{const t=he(e,(e=>"rejected"===e.status));return t.length>0?Promise.reject(ke(t,(({reason:e})=>I(e)?e:[e]))):Promise.resolve()},r=e=>Promise.allSettled(ue(e,(e=>t.states[e]===wl?(n("resolve",e),Promise.resolve()):t.states[e]===xl?(n("reject",e),Promise.reject(e)):(t.states[e]=Cl,t.loadScript(e).then((()=>{t.states[e]=wl,n("resolve",e);const s=t.queue;if(s.length>0)return t.queue=[],r(s).then(o)}),(()=>(t.states[e]=xl,n("reject",e),Promise.reject(e)))))))),s=e=>(t.loading=!0,r(e).then((e=>{t.loading=!1;const n=t.queueLoadedCallbacks.shift();return re.from(n).each(te),o(e)}))),a=Xe(e);return t.loading?new Promise(((e,n)=>{t.queueLoadedCallbacks.push((()=>s(a).then(e,n)))})):s(a)}}kl.ScriptLoader=new kl;const Sl=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},_l=e=>L(e)&&Ke(e,"raw"),El=e=>I(e)&&e.length>1,Nl={},Rl=Sl("en"),Dl=()=>We(Nl,Rl.get()),Al=()=>Fe(Nl,(e=>({...e}))),Tl=(e,t)=>{let n=Nl[e];n||(Nl[e]=n={}),Ie(t,((e,t)=>{n[t.toLowerCase()]=e}))},Ol=e=>{const t=Dl().getOr({}),n=e=>V(e)?Object.prototype.toString.call(e):o(e)?"":""+e,o=e=>""===e||null==e,r=e=>{const o=n(e);return We(t,o.toLowerCase()).map(n).getOr(o)},s=e=>e.replace(/{context:\w+}$/,"");if(o(e))return"";if(_l(e))return n(e.raw);if(El(e)){const t=e.slice(1);return s(r(e[0]).replace(/\{([0-9]+)\}/g,((e,o)=>Ke(t,o)?n(t[o]):e)))}return s(r(e))},Bl={getData:Al,setCode:e=>{e&&Rl.set(e)},getCode:()=>Rl.get(),add:Tl,translate:Ol,isRtl:()=>Dl().bind((e=>We(e,"_dir"))).exists((e=>"rtl"===e)),hasCode:e=>Ke(Nl,e)},Pl=()=>{const e=[],t={},n={},o=[],r=(e,t)=>{const n=he(o,(n=>n.name===e&&n.state===t));fe(n,(e=>e.resolve()))},s=e=>Ke(t,e),a=e=>Ke(n,e),i=e=>{if(n[e])return n[e].instance},l=(e,n)=>{const o=Bl.getCode();!o||n&&-1===(","+(n||"")+",").indexOf(","+o+",")||kl.ScriptLoader.add(t[e]+"/langs/"+o+".js")},d=(e,t)=>{!1!==Pl.languageLoad&&(s(e)?l(e,t):f(e,"loaded").then((()=>l(e,t))))},c=(t,o)=>(e.push(o),n[t]={instance:o},r(t,"added"),o),m=e=>{delete t[e],delete n[e]},u=(e,o)=>{if(t[e])return Promise.resolve();let s=P(o)?o:o.prefix+o.resource+o.suffix;0!==s.indexOf("/")&&-1===s.indexOf("://")&&(s=Pl.baseURL+"/"+s),t[e]=s.substring(0,s.lastIndexOf("/"));const a=()=>(r(e,"loaded"),Promise.resolve());return n[e]?a():kl.ScriptLoader.add(s).then(a)},f=(e,t="added")=>"added"===t&&a(e)||"loaded"===t&&s(e)?Promise.resolve():new Promise((n=>{o.push({name:e,state:t,resolve:n})}));return{items:e,urls:t,lookup:n,get:i,requireLangPack:d,add:c,remove:m,createUrl:(e,t)=>P(t)?P(e)?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}:t,load:u,waitFor:f}};Pl.languageLoad=!0,Pl.baseURL="",Pl.PluginManager=Pl(),Pl.ThemeManager=Pl(),Pl.ModelManager=Pl();const Ll=e=>{const t=Sl(re.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(re.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{n(),t.set(re.some(e))}}},Ml=()=>{const e=Ll(W),t=t=>e.get().each(t);return{...e,on:t}},Il=(e,t)=>{let n=null;return{cancel:()=>{F(n)||(clearTimeout(n),n=null)},throttle:(...o)=>{F(n)&&(n=setTimeout((()=>{n=null,e.apply(null,o)}),t))}}},Fl=(e,t)=>{let n=null;const o=()=>{F(n)||(clearTimeout(n),n=null)},r=(...r)=>{o(),n=setTimeout((()=>{n=null,e.apply(null,r)}),t)};return{cancel:o,throttle:r}},Ul=Y("mce-annotation"),zl=Y("data-mce-annotation"),jl=Y("data-mce-annotation-uid"),Hl=Y("data-mce-annotation-active"),Vl=Y("data-mce-annotation-classes"),$l=Y("data-mce-annotation-attrs"),ql=e=>t=>ko(t,e),Wl=(e,t)=>{const n=e.selection.getRng(),o=bo.fromDom(n.startContainer),r=bo.fromDom(e.getBody()),s=t.fold((()=>"."+Ul()),(e=>`[${zl()}="${e}"]`)),a=Fo(o,n.startOffset).getOr(o),i=_s(a,s,ql(r)),l=(e,t)=>Gn(e,t)?re.some(Wn(e,t)):re.none();return i.bind((t=>l(t,`${jl()}`).bind((n=>l(t,`${zl()}`).map((t=>{const o=Yl(e,n);return{uid:n,name:t,elements:o}}))))))},Kl=e=>Fn(e)&&mo(e,Ul()),Gl=(e,t)=>Gn(e,"data-mce-bogus")||Js(e,'[data-mce-bogus="all"]',ql(t)),Yl=(e,t)=>{const n=bo.fromDom(e.getBody()),o=ra(n,`[${jl()}="${t}"]`);return he(o,(e=>!Gl(e,n)))},Xl=(e,t)=>{const n=bo.fromDom(e.getBody()),o=ra(n,`[${zl()}="${t}"]`),r={};return fe(o,(e=>{if(!Gl(e,n)){const t=Wn(e,jl()),n=We(r,t).getOr([]);r[t]=n.concat([e])}})),r},Ql=(e,t)=>{const n=Sl({}),o=()=>({listeners:[],previous:Ml()}),r=(e,t)=>{s(e,(e=>(t(e),e)))},s=(e,t)=>{const r=n.get(),s=t(We(r,e).getOrThunk(o));r[e]=s,n.set(r)},a=(e,t,n)=>{r(e,(o=>{fe(o.listeners,(o=>o(!0,e,{uid:t,nodes:ue(n,(e=>e.dom))})))}))},i=e=>{r(e,(t=>{fe(t.listeners,(t=>t(!1,e)))}))},l=(t,n)=>{fe(Yl(e,t),(e=>{n?$n(e,Hl(),"true"):Yn(e,Hl())}))},d=Fl((()=>{const n=Re(t.getNames());fe(n,(t=>{s(t,(n=>{const o=n.previous.get();return Wl(e,re.some(t)).fold((()=>{o.each((e=>{i(t),n.previous.clear(),l(e,!1)}))}),(({uid:e,name:t,elements:r})=>{Sn(o,e)||(o.each((e=>l(e,!1))),a(t,e,r),n.previous.set(e),l(e,!0))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);e.on("remove",(()=>{d.cancel()})),e.on("NodeChange",(()=>{d.throttle()}));const c=(e,t)=>{s(e,(e=>({previous:e.previous,listeners:e.listeners.concat([t])})))};return{addListener:c}},Jl=(e,t)=>{const n=zl(),o=e=>re.from(e.attr(n)).bind(t.lookup),r=e=>{var t,n;e.attr(jl(),null),e.attr(zl(),null),e.attr(Hl(),null);const o=re.from(e.attr($l())).map((e=>e.split(","))).getOr([]),r=re.from(e.attr(Vl())).map((e=>e.split(","))).getOr([]);fe(o,(t=>e.attr(t,null)));const s=null!==(n=null===(t=e.attr("class"))||void 0===t?void 0:t.split(" "))&&void 0!==n?n:[],a=Ee(s,[Ul()].concat(r));e.attr("class",a.length>0?a.join(" "):null),e.attr(Vl(),null),e.attr($l(),null)};e.serializer.addTempAttr(Hl()),e.serializer.addAttributeFilter(n,(e=>{for(const t of e)o(t).each((e=>{!1===e.persistent&&("span"===t.name?t.unwrap():r(t))}))}))},Zl=()=>{const e={},t=(t,n)=>{e[t]={name:t,settings:n}},n=t=>We(e,t).map((e=>e.settings));return{register:t,lookup:n,getNames:()=>Le(e)}};let ed=0;const td=e=>{const t=(new Date).getTime(),n=Math.floor(1e9*Math.random());return ed++,e+"_"+n+ed+String(t)},nd=(e,t)=>{fe(t,(t=>{ao(e,t)}))},od=(e,t)=>{fe(t,(t=>{lo(e,t)}))},rd=(e,t)=>bo.fromDom(e.dom.cloneNode(t)),sd=e=>rd(e,!1),ad=e=>rd(e,!0),id=(e,t)=>{const n=bo.fromTag(t),o=Qn(e);return qn(n,o),n},ld=(e,t)=>{const n=id(e,t);cr(e,n);const o=Io(e);return pr(n,o),br(e),n},dd=(e,t,n=ne)=>{const o=new Ds(e,t),r=e=>{let t;do{t=o[e]()}while(t&&!es(t)&&!n(t));return re.from(t).filter(es)};return{current:()=>re.from(o.current()).filter(es),next:()=>r("next"),prev:()=>r("prev"),prev2:()=>r("prev2")}},cd=(e,t)=>{const n=t||(t=>e.isBlock(t)||as(t)||ds(t)),o=(e,t,n,r)=>{if(es(e)){const n=r(e,t,e.data);if(-1!==n)return re.some({container:e,offset:n})}return n().bind((e=>o(e.container,e.offset,n,r)))},r=(e,t,r,s)=>{const a=dd(e,s,n);return o(e,t,(()=>a.prev().map((e=>({container:e,offset:e.length})))),r).getOrNull()},s=(e,t,r,s)=>{const a=dd(e,s,n);return o(e,t,(()=>a.next().map((e=>({container:e,offset:0})))),r).getOrNull()};return{backwards:r,forwards:s}},md=Math.round,ud=e=>e?{left:md(e.left),top:md(e.top),bottom:md(e.bottom),right:md(e.right),width:md(e.width),height:md(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},fd=(e,t)=>(e=ud(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),gd=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,pd=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,hd=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&pd(t.top-e.bottom,e,t)},bd=(e,t)=>e.top>t.bottom||!(e.bottom<t.top)&&pd(t.bottom-e.top,e,t),yd=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,vd=e=>ye(e,((e,t)=>e.fold((()=>re.some(t)),(e=>{const n=Math.min(t.left,e.left),o=Math.min(t.top,e.top),r=Math.max(t.right,e.right),s=Math.max(t.bottom,e.bottom);return re.some({top:o,right:r,bottom:s,left:n,width:r-n,height:s-o})}))),re.none()),Cd=(e,t,n)=>{const o=Math.max(Math.min(t,e.left+e.width),e.left),r=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-o)*(t-o)+(n-r)*(n-r))},wd=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),xd=(e,t,n)=>Math.min(Math.max(e,t),n),kd=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Sd=(e,t)=>{if($r(e)&&e.hasChildNodes()){const n=e.childNodes;return n[xd(t,0,n.length-1)]}return e},_d=(e,t)=>t<0&&$r(e)&&e.hasChildNodes()?void 0:Sd(e,t),Ed=new RegExp("[\u0300-\u036f\u0483-\u0487\u0488-\u0489\u0591-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e3-\u0902\u093a\u093c\u0941-\u0948\u094d\u0951-\u0957\u0962-\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a02\u0a3c\u0a41-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a51\u0a70-\u0a71\u0a75\u0a81-\u0a82\u0abc\u0ac1-\u0ac5\u0ac7-\u0ac8\u0acd\u0ae2-\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62-\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c00\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c62-\u0c63\u0c81\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc-\u0ccd\u0cd5-\u0cd6\u0ce2-\u0ce3\u0d01\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62-\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039-\u103a\u103d-\u103e\u1058-\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108d\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b4-\u17b5\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193b\u1a17-\u1a18\u1a1b\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1ab0-\u1abd\u1abe\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80-\u1b81\u1ba2-\u1ba5\u1ba8-\u1ba9\u1bab-\u1bad\u1be6\u1be8-\u1be9\u1bed\u1bef-\u1bf1\u1c2c-\u1c33\u1c36-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1cf4\u1cf8-\u1cf9\u1dc0-\u1df5\u1dfc-\u1dff\u200c-\u200d\u20d0-\u20dc\u20dd-\u20e0\u20e1\u20e2-\u20e4\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302d\u302e-\u302f\u3099-\u309a\ua66f\ua670-\ua672\ua674-\ua67d\ua69e-\ua69f\ua6f0-\ua6f1\ua802\ua806\ua80b\ua825-\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\ua9e5\uaa29-\uaa2e\uaa31-\uaa32\uaa35-\uaa36\uaa43\uaa4c\uaa7c\uaab0\uaab2-\uaab4\uaab7-\uaab8\uaabe-\uaabf\uaac1\uaaec-\uaaed\uaaf6\uabe5\uabe8\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\uff9e-\uff9f]"),Nd=e=>"string"==typeof e&&e.charCodeAt(0)>=768&&Ed.test(e),Rd=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},Dd=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},Ad=$r,Td=za,Od=Wr("display","block table"),Bd=Wr("float","left right"),Pd=Dd(Ad,Td,J(Bd)),Ld=J(Wr("white-space","pre pre-line pre-wrap")),Md=es,Id=as,Fd=bl.nodeIndex,Ud=_d,zd=e=>"createRange"in e?e.createRange():bl.DOM.createRng(),jd=e=>e&&/[\r\n\t ]/.test(e),Hd=e=>!!e.setStart&&!!e.setEnd,Vd=e=>{const t=e.startContainer,n=e.startOffset;if(jd(e.toString())&&Ld(t.parentNode)&&es(t)){const e=t.data;if(jd(e[n-1])||jd(e[n+1]))return!0}return!1},$d=e=>{const t=e.ownerDocument,n=zd(t),o=t.createTextNode(ea),r=e.parentNode;r.insertBefore(o,e),n.setStart(o,0),n.setEnd(o,1);const s=ud(n.getBoundingClientRect());return r.removeChild(o),s},qd=e=>{const t=e.startContainer,n=e.endContainer,o=e.startOffset,r=e.endOffset;if(t===n&&es(n)&&0===o&&1===r){const t=e.cloneRange();return t.setEndAfter(n),Kd(t)}return null},Wd=e=>0===e.left&&0===e.right&&0===e.top&&0===e.bottom,Kd=e=>{let t;const n=e.getClientRects();return t=n.length>0?ud(n[0]):ud(e.getBoundingClientRect()),!Hd(e)&&Id(e)&&Wd(t)?$d(e):Wd(t)&&Hd(e)?qd(e):t},Gd=(e,t)=>{const n=fd(e,t);return n.width=1,n.right=n.left+1,n},Yd=e=>{const t=[],n=e=>{0!==e.height&&(t.length>0&&gd(e,t[t.length-1])||t.push(e))},o=(e,o)=>{const r=zd(e.ownerDocument);if(o<e.data.length){if(Nd(e.data[o]))return t;if(Nd(e.data[o-1])&&(r.setStart(e,o),r.setEnd(e,o+1),!Vd(r)))return n(Gd(Kd(r),!1)),t}o>0&&(r.setStart(e,o-1),r.setEnd(e,o),Vd(r)||n(Gd(Kd(r),!1))),o<e.data.length&&(r.setStart(e,o),r.setEnd(e,o+1),Vd(r)||n(Gd(Kd(r),!0)))},r=e.container(),s=e.offset();if(Md(r))return o(r,s),t;if(Ad(r))if(e.isAtEnd()){const e=Ud(r,s);Md(e)&&o(e,e.data.length),Pd(e)&&!Id(e)&&n(Gd(Kd(e),!1))}else{const a=Ud(r,s);if(Md(a)&&o(a,0),Pd(a)&&e.isAtEnd())return n(Gd(Kd(a),!1)),t;const i=Ud(e.container(),e.offset()-1);Pd(i)&&!Id(i)&&(Od(i)||Od(a)||!Pd(a))&&n(Gd(Kd(i),!1)),Pd(a)&&n(Gd(Kd(a),!0))}return t},Xd=(e,t,n)=>{const o=()=>(Md(e),0===t),r=()=>Md(e)?t>=e.data.length:t>=e.childNodes.length,s=()=>{const n=zd(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},a=()=>(n||(n=Yd(Xd(e,t))),n),i=()=>a().length>0,l=n=>n&&e===n.container()&&t===n.offset(),d=n=>Ud(e,n?t-1:t);return{container:Y(e),offset:Y(t),toRange:s,getClientRects:a,isVisible:i,isAtStart:o,isAtEnd:r,isEqual:l,getNode:d}};Xd.fromRangeStart=e=>Xd(e.startContainer,e.startOffset),Xd.fromRangeEnd=e=>Xd(e.endContainer,e.endOffset),Xd.after=e=>Xd(e.parentNode,Fd(e)+1),Xd.before=e=>Xd(e.parentNode,Fd(e)),Xd.isAbove=(e,t)=>En(Ae(t.getClientRects()),Te(e.getClientRects()),hd).getOr(!1),Xd.isBelow=(e,t)=>En(Te(t.getClientRects()),Ae(e.getClientRects()),bd).getOr(!1),Xd.isAtStart=e=>!!e&&e.isAtStart(),Xd.isAtEnd=e=>!!e&&e.isAtEnd(),Xd.isTextPosition=e=>!!e&&es(e.container()),Xd.isElementPosition=e=>!1===Xd.isTextPosition(e);const Qd=(e,t)=>{es(t)&&0===t.data.length&&e.remove(t)},Jd=(e,t,n)=>{t.insertNode(n),Qd(e,n.previousSibling),Qd(e,n.nextSibling)},Zd=(e,t,n)=>{const o=re.from(n.firstChild),r=re.from(n.lastChild);t.insertNode(n),o.each((t=>Qd(e,t.previousSibling))),r.each((t=>Qd(e,t.nextSibling)))},ec=(e,t,n)=>{ss(n)?Zd(e,t,n):Jd(e,t,n)},tc=es,nc=Yr,oc=bl.nodeIndex,rc=e=>{const t=e.parentNode;return nc(t)?rc(t):t},sc=e=>e?ot(e.childNodes,((e,t)=>(nc(t)&&"BR"!==t.nodeName?e=e.concat(sc(t)):e.push(t),e)),[]):[],ac=(e,t)=>{for(;(e=e.previousSibling)&&tc(e);)t+=e.data.length;return t},ic=e=>t=>e===t,lc=e=>{let t,n;t=sc(rc(e)),n=rt(t,ic(e),e),t=t.slice(0,n+1);const o=ot(t,((e,n,o)=>(tc(n)&&tc(t[o-1])&&e++,e)),0);return t=tt(t,qr([e.nodeName])),n=rt(t,ic(e),e),n-o},dc=e=>{let t;return t=tc(e)?"text()":e.nodeName.toLowerCase(),t+"["+lc(e)+"]"},cc=(e,t,n)=>{const o=[];for(t=t.parentNode;t!==e&&(!n||!n(t));t=t.parentNode)o.push(t);return o},mc=(e,t)=>{let n,o,r,s,a,i=[];return n=t.container(),o=t.offset(),tc(n)?r=ac(n,o):(s=n.childNodes,o>=s.length?(r="after",o=s.length-1):r="before",n=s[o]),i.push(dc(n)),a=cc(e,n),a=tt(a,J(Yr)),i=i.concat(et(a,(e=>dc(e)))),i.reverse().join("/")+","+r},uc=(e,t,n)=>{let o=sc(e);return o=tt(o,((e,t)=>!tc(e)||!tc(o[t-1]))),o=tt(o,qr([t])),o[n]},fc=(e,t)=>{let n,o=e,r=0;for(;tc(o);){if(n=o.data.length,t>=r&&t<=r+n){e=o,t-=r;break}if(!tc(o.nextSibling)){e=o,t=n;break}r+=n,o=o.nextSibling}return tc(e)&&t>e.data.length&&(t=e.data.length),Xd(e,t)},gc=(e,t)=>{let n;if(!t)return null;const o=t.split(","),r=o[0].split("/");n=o.length>1?o[1]:"before";const s=ot(r,((e,t)=>{const n=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return n?("text()"===n[1]&&(n[1]="#text"),uc(e,n[1],parseInt(n[2],10))):null}),e);return s?tc(s)?fc(s,parseInt(n,10)):(n="after"===n?oc(s)+1:oc(s),Xd(s.parentNode,n)):null},pc=ds,hc=(e,t,n)=>{let o,r;for(r=e(t.data.slice(0,n)).length,o=t.previousSibling;o&&es(o);o=o.previousSibling)r+=e(o.data).length;return r},bc=(e,t,n,o,r)=>{let s=o[r?"startContainer":"endContainer"],a=o[r?"startOffset":"endOffset"];const i=[];let l,d=0;const c=e.getRoot();for(es(s)?i.push(n?hc(t,s,a):a):(l=s.childNodes,a>=l.length&&l.length&&(d=1,a=Math.max(0,l.length-1)),i.push(e.nodeIndex(l[a],n)+d));s&&s!==c;s=s.parentNode)i.push(e.nodeIndex(s,n));return i},yc=(e,t,n,o)=>{const r=t.dom,s=bc(r,e,n,o,!0),a=t.isForward(),i=Ta(o)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:s,forward:a,...i};return{start:s,end:bc(r,e,n,o,!1),forward:a,...i}},vc=(e,t,n)=>{let o=0;return kn.each(e.select(t),(e=>{if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void o++})),o},Cc=(e,t)=>{let n,o;const r=t?"start":"end";if(n=e[r+"Container"],o=e[r+"Offset"],$r(n)&&"TR"===n.nodeName){const r=n.childNodes;n=r[Math.min(t?o:o-1,r.length-1)],n&&(o=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,o))}},wc=e=>(Cc(e,!0),Cc(e,!1),e),xc=(e,t)=>{let n;if($r(e)&&(e=Sd(e,t),pc(e)))return e;if(wa(e)){if(es(e)&&va(e)&&(e=e.parentNode),n=e.previousSibling,pc(n))return n;if(n=e.nextSibling,pc(n))return n}},kc=e=>xc(e.startContainer,e.startOffset)||xc(e.endContainer,e.endOffset),Sc=(e,t,n)=>{const o=n.getNode();let r=o?o.nodeName:null;const s=n.getRng();if(pc(o)||"IMG"===r)return{name:r,index:vc(n.dom,r,o)};const a=kc(s);return a?(r=a.tagName,{name:r,index:vc(n.dom,r,a)}):yc(e,n,t,s)},_c=e=>{const t=e.getRng();return{start:mc(e.dom.getRoot(),Xd.fromRangeStart(t)),end:mc(e.dom.getRoot(),Xd.fromRangeEnd(t)),forward:e.isForward()}},Ec=e=>({rng:e.getRng(),forward:e.isForward()}),Nc=(e,t,n)=>{const o={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",o,"&#xFEFF;"):e.create("span",o)},Rc=(e,t)=>{const n=e.dom;let o=e.getRng();const r=n.uniqueId(),s=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if("IMG"===i)return{name:i,index:vc(n,i,a)};const d=wc(o.cloneRange());if(!s){d.collapse(!1);const e=Nc(n,r+"_end",t);ec(n,d,e)}o=wc(o),o.collapse(!0);const c=Nc(n,r+"_start",t);return ec(n,o,c),e.moveToBookmark({id:r,keep:!0,forward:l}),{id:r,forward:l}},Dc=(e,t,n)=>2===t?Sc(ha,n,e):3===t?_c(e):t?Ec(e):Rc(e,!1),Ac=e(Sc,X,!0),Tc=e=>{const t=t=>t(e),n=Y(e),o=()=>r,r={tag:!0,inner:e,fold:(t,n)=>n(e),isValue:oe,isError:ne,map:t=>Pc.value(t(e)),mapError:o,bind:t,exists:t,forall:t,getOr:n,or:o,getOrThunk:n,orThunk:o,getOrDie:n,each:t=>{t(e)},toOptional:()=>re.some(e)};return r},Oc=e=>{const t=()=>n,n={tag:!1,inner:e,fold:t=>t(e),isValue:ne,isError:oe,map:t,mapError:t=>Pc.error(t(e)),bind:t,exists:ne,forall:oe,getOr:X,or:X,getOrThunk:ee,orThunk:ee,getOrDie:Z(String(e)),each:W,toOptional:re.none};return n},Bc=(e,t)=>e.fold((()=>Oc(t)),Tc),Pc={value:Tc,error:Oc,fromOption:Bc},Lc=e=>{if(!I(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");const t=[],n={};return fe(e,((o,r)=>{const s=Le(o);if(1!==s.length)throw new Error("one and only one name per case");const a=s[0],i=o[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!I(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...n)=>{const o=n.length;if(o!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+o);return{fold:(...t)=>{
if(t.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);return t[r].apply(null,n)},match:e=>{const o=Le(e);if(t.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));if(!Se(t,(e=>ce(o,e))))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,n)},log:e=>{console.log(e,{constructors:t,constructor:a,params:n})}}}})),n},Mc={generate:Lc};Mc.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const Ic=e=>{const t=[],n=[];return fe(e,(e=>{e.fold((e=>{t.push(e)}),(e=>{n.push(e)}))})),{errors:t,values:n}},Fc=e=>"inline-command"===e.type||"inline-format"===e.type,Uc=e=>"block-command"===e.type||"block-format"===e.type,zc=e=>Re(e,((e,t)=>e.start.length===t.start.length?0:e.start.length>t.start.length?-1:1)),jc=e=>{const t=t=>Pc.error({message:t,pattern:e}),n=(n,o,r)=>{if(void 0!==e.format){let r;if(I(e.format)){if(!Se(e.format,P))return t(n+" pattern has non-string items in the `format` array");r=e.format}else{if(!P(e.format))return t(n+" pattern has non-string `format` parameter");r=[e.format]}return Pc.value(o(r))}return void 0!==e.cmd?P(e.cmd)?Pc.value(r(e.cmd,e.value)):t(n+" pattern has non-string `cmd` parameter"):t(n+" pattern is missing both `format` and `cmd` parameters")};if(!L(e))return t("Raw pattern is not an object");if(!P(e.start))return t("Raw pattern is missing `start` parameter");if(void 0!==e.end){if(!P(e.end))return t("Inline pattern has non-string `end` parameter");if(0===e.start.length&&0===e.end.length)return t("Inline pattern has empty `start` and `end` parameters");let o=e.start,r=e.end;return 0===r.length&&(r=o,o=""),n("Inline",(e=>({type:"inline-format",start:o,end:r,format:e})),((e,t)=>({type:"inline-command",start:o,end:r,cmd:e,value:t})))}return void 0!==e.replacement?P(e.replacement)?0===e.start.length?t("Replacement pattern has empty `start` parameter"):Pc.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):0===e.start.length?t("Block pattern has empty `start` parameter"):n("Block",(t=>({type:"block-format",start:e.start,format:t[0]})),((t,n)=>({type:"block-command",start:e.start,cmd:t,value:n})))},Hc=e=>zc(he(e,Uc)),Vc=e=>he(e,Fc),$c=e=>({inlinePatterns:Vc(e),blockPatterns:Hc(e)}),qc=e=>{const t=Ic(ue(e,jc));return fe(t.errors,(e=>console.error(e.message,e.pattern))),t.values},Wc=ln().deviceType,Kc=Wc.isTouch(),Gc=bl.DOM,Yc=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return ye(t,((e,t)=>{const n=t.split("="),o=n[0],r=n.length>1?n[1]:o;return e[_t(o)]=_t(r),e}),{})},Xc=e=>B(e,RegExp),Qc=e=>t=>t.options.get(e),Jc=e=>P(e)||L(e),Zc=(e,t="")=>n=>{const o=P(n);if(o){if(-1!==n.indexOf("=")){const r=Yc(n);return{value:We(r,e.id).getOr(t),valid:o}}return{value:n,valid:o}}return{valid:!1,message:"Must be a string."}},em=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean"}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:Zc(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:Zc(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:e=>{const t=P(e)&&Rt(e);return t?{value:e,valid:t}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:e=>{const t=ce(["block","linebreak","invert","default"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:e=>U(e)||P(e)?{valid:!0,value:e}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:e=>{const t=!1===e||P(e)||q(e,P);return t?P(e)?{value:ue(e.split(","),_t),valid:t}:I(e)?{value:e,valid:t}:!1===e?{value:[],valid:t}:{value:e,valid:t}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Ym(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:e=>{const t=P(e)||q(e,P);if(t){return{value:I(e)?e:ue(e.split(","),_t),valid:t}}return{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:e=>{const t=U(e)||P(e);return t?!1===e||Wc.isiPhone()||Wc.isiPad()?{value:"",valid:t}:{value:!0===e?"table,img,figure.image,div,video,iframe":e,valid:t}:{valid:!1,message:"Must be boolean or a string"}},default:!Kc}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:e=>!1===e||P(e)||V(e),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("preview_styles",{processor:e=>{const t=!1===e||P(e);return t?{value:!1===e?"":e,valid:t}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean"}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Jc}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Jc}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Jc}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:e=>P(e)||!0===e}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:e=>{if(q(e,L)||!1===e){return{value:qc(!1===e?[]:e),valid:!0}}return{valid:!1,message:"Must be an array of objects or false."}},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:e=>q(e,Xc)?{value:e,valid:!0}:Xc(e)?{value:[e],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",(()=>{t("directionality",{processor:"string",default:Bl.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:Gc.getAttrib(e.getElement(),"placeholder")})}))},tm=Qc("iframe_attrs"),nm=Qc("doctype"),om=Qc("document_base_url"),rm=Qc("body_id"),sm=Qc("body_class"),am=Qc("content_security_policy"),im=Qc("br_in_pre"),lm=Qc("forced_root_block"),dm=Qc("forced_root_block_attrs"),cm=Qc("newline_behavior"),mm=Qc("br_newline_selector"),um=Qc("no_newline_selector"),fm=Qc("keep_styles"),gm=Qc("end_container_on_empty_block"),pm=Qc("automatic_uploads"),hm=Qc("images_reuse_filename"),bm=Qc("images_replace_blob_uris"),ym=Qc("icons"),vm=Qc("icons_url"),Cm=Qc("images_upload_url"),wm=Qc("images_upload_base_path"),xm=Qc("images_upload_credentials"),km=Qc("images_upload_handler"),Sm=Qc("content_css_cors"),_m=Qc("referrer_policy"),Em=Qc("language"),Nm=Qc("language_url"),Rm=Qc("indent_use_margin"),Dm=Qc("indentation"),Am=Qc("content_css"),Tm=Qc("content_style"),Om=Qc("font_css"),Bm=Qc("directionality"),Pm=Qc("inline_boundaries_selector"),Lm=Qc("object_resizing"),Mm=Qc("resize_img_proportional"),Im=Qc("placeholder"),Fm=Qc("event_root"),Um=Qc("service_message"),zm=Qc("theme"),jm=Qc("theme_url"),Hm=Qc("model"),Vm=Qc("model_url"),$m=Qc("inline_boundaries"),qm=Qc("formats"),Wm=Qc("preview_styles"),Km=Qc("format_empty_lines"),Gm=Qc("custom_ui_selector"),Ym=Qc("inline"),Xm=Qc("hidden_input"),Qm=Qc("submit_patch"),Jm=Qc("add_form_submit_trigger"),Zm=Qc("add_unload_trigger"),eu=Qc("custom_undo_redo_levels"),tu=Qc("disable_nodechange"),nu=Qc("readonly"),ou=Qc("content_css_cors"),ru=Qc("plugins"),su=Qc("external_plugins"),au=Qc("block_unsupported_drop"),iu=Qc("visual"),lu=Qc("visual_table_class"),du=Qc("visual_anchor_class"),cu=Qc("iframe_aria_text"),mu=Qc("setup"),uu=Qc("init_instance_callback"),fu=Qc("urlconverter_callback"),gu=Qc("auto_focus"),pu=Qc("browser_spellcheck"),hu=Qc("protect"),bu=Qc("paste_block_drop"),yu=Qc("paste_data_images"),vu=Qc("paste_preprocess"),Cu=Qc("paste_postprocess"),wu=Qc("paste_webkit_styles"),xu=Qc("paste_remove_styles_if_webkit"),ku=Qc("paste_merge_formats"),Su=Qc("smart_paste"),_u=Qc("paste_as_text"),Eu=Qc("paste_tab_spaces"),Nu=Qc("allow_html_data_urls"),Ru=Qc("text_patterns"),Du=Qc("noneditable_class"),Au=Qc("editable_class"),Tu=Qc("noneditable_regexp"),Ou=e=>kn.explode(e.options.get("font_size_style_values")),Bu=e=>kn.explode(e.options.get("font_size_classes")),Pu=e=>"xml"===e.options.get("encoding"),Lu=e=>kn.explode(e.options.get("images_file_types")),Mu=Qc("table_tab_navigation"),Iu=$r,Fu=es,Uu=e=>{const t=e.parentNode;t&&t.removeChild(e)},zu=e=>{const t=ha(e);return{count:e.length-t.length,text:t}},ju=e=>{let t;for(;-1!==(t=e.data.lastIndexOf(ga));)e.deleteData(t,1)},Hu=(e,t)=>(Gu(e),t),Vu=(e,t)=>{const n=zu(e.data.substr(0,t.offset())),o=zu(e.data.substr(t.offset()));return(n.text+o.text).length>0?(ju(e),Xd(e,t.offset()-n.count)):t},$u=(e,t)=>{const n=t.container(),o=de(Oe(n.childNodes),e).map((e=>e<t.offset()?Xd(n,t.offset()-1):t)).getOr(t);return Gu(e),o},qu=(e,t)=>Fu(e)&&t.container()===e?Vu(e,t):Hu(e,t),Wu=(e,t)=>t.container()===e.parentNode?$u(e,t):Hu(e,t),Ku=(e,t)=>Xd.isTextPosition(t)?qu(e,t):Wu(e,t),Gu=e=>{Iu(e)&&wa(e)&&(xa(e)?e.removeAttribute("data-mce-caret"):Uu(e)),Fu(e)&&(ju(e),0===e.data.length&&Uu(e))},Yu=ds,Xu=ms,Qu=cs,Ju="*[contentEditable=false],video,audio,embed,object",Zu=(e,t,n)=>{const o=fd(t.getBoundingClientRect(),n);let r,s;if("BODY"===e.tagName){const t=e.ownerDocument.documentElement;r=e.scrollLeft||t.scrollLeft,s=e.scrollTop||t.scrollTop}else{const t=e.getBoundingClientRect();r=e.scrollLeft-t.left,s=e.scrollTop-t.top}o.left+=r,o.right+=r,o.top+=s,o.bottom+=s,o.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),o.left+=a,o.right+=a),o},ef=e=>{const t=ra(bo.fromDom(e),Ju);for(let e=0;e<t.length;e++){const n=t[e].dom;let o=n.previousSibling;if(Ra(o)){const e=o.data;1===e.length?o.parentNode.removeChild(o):o.deleteData(e.length-1,1)}if(o=n.nextSibling,Na(o)){1===o.data.length?o.parentNode.removeChild(o):o.deleteData(0,1)}}},tf=(e,t,n,o)=>{const r=Ml();let s,a;const i=lm(e),l=e.dom,d=(e,o)=>{let s;if(c(),Qu(o))return null;if(!n(o))return a=ka(o,e),s=o.ownerDocument.createRange(),of(a.nextSibling)?(s.setStart(a,0),s.setEnd(a,0)):(s.setStart(a,1),s.setEnd(a,1)),s;{a=Ea(i,o,e);const n=Zu(t,o,e);l.setStyle(a,"top",n.top);const d=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(d,{...n}),l.add(t,d),r.set({caret:d,element:o,before:e}),e&&l.addClass(d,"mce-visual-caret-before"),m(),s=o.ownerDocument.createRange(),s.setStart(a,0),s.setEnd(a,0)}return s},c=()=>{ef(t),a&&(Gu(a),a=null),r.on((e=>{l.remove(e.caret),r.clear()})),s&&(clearInterval(s),s=void 0)},m=()=>{s=setInterval((()=>{r.on((e=>{o()?l.toggleClass(e.caret,"mce-visual-caret-hidden"):l.addClass(e.caret,"mce-visual-caret-hidden")}))}),500)};return{show:d,hide:c,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{r.on((e=>{const n=Zu(t,e.element,e.before);l.setStyles(e.caret,{...n})}))},destroy:()=>clearInterval(s)}},nf=()=>pn.browser.isFirefox(),of=e=>Yu(e)||Xu(e),rf=e=>of(e)||Qr(e)&&nf(),sf=ls,af=ds,lf=ms,df=Wr("display","block table table-cell table-caption list-item"),cf=wa,mf=va,uf=$r,ff=za,gf=e=>e>0,pf=e=>e<0,hf=(e,t)=>{let n;for(;n=e(t);)if(!mf(n))return n;return null},bf=(e,t,n,o,r)=>{const s=new Ds(e,o),a=af(e)||mf(e);if(pf(t)){if(a&&n(e=hf(s.prev.bind(s),!0)))return e;for(;e=hf(s.prev.bind(s),r);)if(n(e))return e}if(gf(t)){if(a&&n(e=hf(s.next.bind(s),!0)))return e;for(;e=hf(s.next.bind(s),r);)if(n(e))return e}return null},yf=(e,t)=>{const n=e=>sf(e.dom),o=e=>e.dom===t;return ys(bo.fromDom(e),n,o).map((e=>e.dom)).getOr(t)},vf=(e,t)=>{for(;e&&e!==t;){if(df(e))return e;e=e.parentNode}return null},Cf=(e,t,n)=>vf(e.container(),n)===vf(t.container(),n),wf=(e,t)=>{if(!t)return null;const n=t.container(),o=t.offset();return uf(n)?n.childNodes[o+e]:null},xf=(e,t)=>{const n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},kf=(e,t,n)=>vf(t,e)===vf(n,e),Sf=(e,t,n)=>{const o=e?"previousSibling":"nextSibling";for(;n&&n!==t;){let e=n[o];if(cf(e)&&(e=e[o]),af(e)||lf(e)){if(kf(t,e,n))return e;break}if(ff(e))break;n=n.parentNode}return null},_f=e(xf,!0),Ef=e(xf,!1),Nf=(t,n,o)=>{let r;const s=e(Sf,!0,n),a=e(Sf,!1,n);let i=o.startContainer;const l=o.startOffset;if(va(i)){uf(i)||(i=i.parentNode);const e=i.getAttribute("data-mce-caret");if("before"===e&&(r=i.nextSibling,rf(r)))return _f(r);if("after"===e&&(r=i.previousSibling,rf(r)))return Ef(r)}if(!o.collapsed)return o;if(es(i)){if(cf(i)){if(1===t){if(r=a(i),r)return _f(r);if(r=s(i),r)return Ef(r)}if(-1===t){if(r=s(i),r)return Ef(r);if(r=a(i),r)return _f(r)}return o}if(Ra(i)&&l>=i.data.length-1)return 1===t&&(r=a(i),r)?_f(r):o;if(Na(i)&&l<=1)return-1===t&&(r=s(i),r)?Ef(r):o;if(l===i.data.length)return r=a(i),r?_f(r):o;if(0===l)return r=s(i),r?Ef(r):o}return o},Rf=(e,t)=>re.from(wf(e?0:-1,t)).filter(af),Df=(e,t,n)=>{const o=Nf(e,t,n);return-1===e?Xd.fromRangeStart(o):Xd.fromRangeEnd(o)},Af=e=>re.from(e.getNode()).map(bo.fromDom),Tf=e=>re.from(e.getNode(!0)).map(bo.fromDom),Of=(e,t)=>{for(;t=e(t);)if(t.isVisible())return t;return t},Bf=(e,t)=>{const n=Cf(e,t);return!(n||!as(e.getNode()))||n};var Pf;!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(Pf||(Pf={}));const Lf=ds,Mf=es,If=$r,Ff=as,Uf=za,zf=qa,jf=Wa,Hf=(e,t)=>{const n=[];for(;e&&e!==t;)n.push(e),e=e.parentNode;return n},Vf=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,$f=(e,t)=>{if(gf(e)){if(Uf(t.previousSibling)&&!Mf(t.previousSibling))return Xd.before(t);if(Mf(t))return Xd(t,0)}if(pf(e)){if(Uf(t.nextSibling)&&!Mf(t.nextSibling))return Xd.after(t);if(Mf(t))return Xd(t,t.data.length)}return pf(e)?Ff(t)?Xd.before(t):Xd.after(t):Xd.before(t)},qf=(e,t)=>{const n=t.nextSibling;return n&&Uf(n)?Mf(n)?Xd(n,0):Xd.before(n):Wf(Pf.Forwards,Xd.after(t),e)},Wf=(e,t,n)=>{let o,r,s,a;if(!If(n)||!t)return null;if(t.isEqual(Xd.after(n))&&n.lastChild){if(a=Xd.after(n.lastChild),pf(e)&&Uf(n.lastChild)&&If(n.lastChild))return Ff(n.lastChild)?Xd.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(Mf(i)){if(pf(e)&&l>0)return Xd(i,--l);if(gf(e)&&l<i.length)return Xd(i,++l);o=i}else{if(pf(e)&&l>0&&(r=Vf(i,l-1),Uf(r)))return!zf(r)&&(s=bf(r,e,jf,r),s)?Mf(s)?Xd(s,s.data.length):Xd.after(s):Mf(r)?Xd(r,r.data.length):Xd.before(r);if(gf(e)&&l<i.childNodes.length&&(r=Vf(i,l),Uf(r)))return Ff(r)?qf(n,r):!zf(r)&&(s=bf(r,e,jf,r),s)?Mf(s)?Xd(s,0):Xd.before(s):Mf(r)?Xd(r,0):Xd.after(r);o=r||a.getNode()}if((gf(e)&&a.isAtEnd()||pf(e)&&a.isAtStart())&&(o=bf(o,e,oe,n,!0),jf(o,n)))return $f(e,o);r=bf(o,e,jf,n);const d=st(he(Hf(i,n),Lf));return!d||r&&d.contains(r)?r?$f(e,r):null:(a=gf(e)?Xd.after(d):Xd.before(d),a)},Kf=e=>({next:t=>Wf(Pf.Forwards,t,e),prev:t=>Wf(Pf.Backwards,t,e)}),Gf=(e,t,n)=>{const o=e?Xd.before(n):Xd.after(n);return tg(e,t,o)},Yf=e=>as(e)?Xd.before(e):Xd.after(e),Xf=e=>Xd.isTextPosition(e)?0===e.offset():za(e.getNode()),Qf=e=>{if(Xd.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}return za(e.getNode(!0))},Jf=(e,t)=>!Xd.isTextPosition(e)&&!Xd.isTextPosition(t)&&e.getNode()===t.getNode(!0),Zf=e=>!Xd.isTextPosition(e)&&as(e.getNode()),eg=(e,t,n)=>e?!Jf(t,n)&&!Zf(t)&&Qf(t)&&Xf(n):!Jf(n,t)&&Xf(t)&&Qf(n),tg=(e,t,n)=>{const o=Kf(t);return re.from(e?o.next(n):o.prev(n))},ng=(e,t,n)=>tg(e,t,n).bind((o=>Cf(n,o,t)&&eg(e,n,o)?tg(e,t,o):re.some(o))),og=(e,t,n,o)=>ng(e,t,n).bind((n=>o(n)?og(e,t,n,o):re.some(n))),rg=(e,t)=>{const n=e?t.firstChild:t.lastChild;return es(n)?re.some(Xd(n,e?0:n.data.length)):n?za(n)?re.some(e?Xd.before(n):Yf(n)):Gf(e,t,n):re.none()},sg=e(tg,!0),ag=e(tg,!1),ig=e(rg,!0),lg=e(rg,!1),dg="_mce_caret",cg=e=>$r(e)&&e.id===dg,mg=(e,t)=>{for(;t&&t!==e;){if(t.id===dg)return t;t=t.parentNode}return null},ug=e=>P(e.start),fg=e=>Ke(e,"rng"),gg=e=>Ke(e,"id"),pg=e=>Ke(e,"name"),hg=e=>kn.isArray(e.start),bg=e=>!(!pg(e)&&U(e.forward))||e.forward,yg=(e,t)=>($r(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),vg=(e,t)=>{const n=e.createRng(),o=gc(e.getRoot(),t.start);n.setStart(o.container(),o.offset());const r=gc(e.getRoot(),t.end);return n.setEnd(r.container(),r.offset()),{range:n,forward:bg(t)}},Cg=(e,t)=>{const n=e.ownerDocument.createTextNode(ga);e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)},wg=e=>!1===e.hasChildNodes(),xg=(e,t)=>lg(e).fold(ne,(e=>(t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0))),kg=(e,t,n)=>!(!wg(t)||!mg(e,t))&&(Cg(t,n),!0),Sg=(e,t,n,o)=>{const r=n[t?"start":"end"];let s,a,i,l;const d=e.getRoot();if(r){for(i=r[0],a=d,s=r.length-1;s>=1;s--){if(l=a.childNodes,kg(d,a,o))return!0;if(r[s]>l.length-1)return!!kg(d,a,o)||xg(a,o);a=l[r[s]]}3===a.nodeType&&(i=Math.min(r[0],a.nodeValue.length)),1===a.nodeType&&(i=Math.min(r[0],a.childNodes.length)),t?o.setStart(a,i):o.setEnd(a,i)}return!0},_g=e=>es(e)&&e.data.length>0,Eg=(e,t,n)=>{let o,r,s,a,i=e.get(n.id+"_"+t);const l=n.keep;let d,c;if(i){if(o=i.parentNode,"start"===t?(l?i.hasChildNodes()?(o=i.firstChild,r=1):_g(i.nextSibling)?(o=i.nextSibling,r=0):_g(i.previousSibling)?(o=i.previousSibling,r=i.previousSibling.data.length):(o=i.parentNode,r=e.nodeIndex(i)+1):r=e.nodeIndex(i),d=o,c=r):(l?i.hasChildNodes()?(o=i.firstChild,r=1):_g(i.previousSibling)?(o=i.previousSibling,r=i.previousSibling.data.length):(o=i.parentNode,r=e.nodeIndex(i)):r=e.nodeIndex(i),d=o,c=r),!l){for(a=i.previousSibling,s=i.nextSibling,kn.each(kn.grep(i.childNodes),(e=>{es(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));i=e.get(n.id+"_"+t);)e.remove(i,!0);a&&s&&a.nodeType===s.nodeType&&es(a)&&!pn.browser.isOpera()&&(r=a.nodeValue.length,a.appendData(s.nodeValue),e.remove(s),d=a,c=r)}return re.some(Xd(d,c))}return re.none()},Ng=(e,t)=>{const n=e.createRng();return Sg(e,!0,t,n)&&Sg(e,!1,t,n)?re.some({range:n,forward:bg(t)}):re.none()},Rg=(e,t)=>{const n=Eg(e,"start",t),o=Eg(e,"end",t);return En(n,o.or(n),((n,o)=>{const r=e.createRng();return r.setStart(yg(e,n.container()),n.offset()),r.setEnd(yg(e,o.container()),o.offset()),{range:r,forward:bg(t)}}))},Dg=(e,t)=>re.from(e.select(t.name)[t.index]).map((t=>{const n=e.createRng();return n.selectNode(t),{range:n,forward:!0}})),Ag=(e,t)=>{const n=e.dom;if(t){if(hg(t))return Ng(n,t);if(ug(t))return re.some(vg(n,t));if(gg(t))return Rg(n,t);if(pg(t))return Dg(n,t);if(fg(t))return re.some({range:t.rng,forward:bg(t)})}return re.none()},Tg=(e,t,n)=>Dc(e,t,n),Og=(e,t)=>{Ag(e,t).each((({range:t,forward:n})=>{e.setRng(t,n)}))},Bg=e=>$r(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type"),Pg=(e=>t=>e===t)(ea),Lg=e=>""!==e&&-1!==" \f\n\r\t\v".indexOf(e),Mg=e=>!Lg(e)&&!Pg(e)&&!ta(e),Ig=e=>({value:e}),Fg=e=>{const t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},Ug=e=>{const t=Fg(e.red)+Fg(e.green)+Fg(e.blue);return Ig(t)},zg=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,jg=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Hg=(e,t,n,o)=>({red:e,green:t,blue:n,alpha:o}),Vg=(e,t,n,o)=>{const r=parseInt(e,10),s=parseInt(t,10),a=parseInt(n,10),i=parseFloat(o);return Hg(r,s,a,i)},$g=e=>{if("transparent"===e)return re.some(Hg(0,0,0,0));const t=zg.exec(e);if(null!==t)return re.some(Vg(t[1],t[2],t[3],"1"));const n=jg.exec(e);return null!==n?re.some(Vg(n[1],n[2],n[3],n[4])):re.none()},qg=e=>$g(e).map(Ug).map((e=>"#"+e.value)).getOr(e),Wg=e=>!!e.nodeType,Kg=e=>e&&/^(IMG)$/.test(e.nodeName),Gg=(e,t,n)=>{const o=n.startOffset;let r=n.startContainer;if((r!==n.endContainer||!Kg(r.childNodes[o]))&&$r(r)){const s=r.childNodes;let a;o<s.length?(r=s[o],a=new Ds(r,e.getParent(r,e.isBlock))):(r=s[s.length-1],a=new Ds(r,e.getParent(r,e.isBlock)),a.next(!0));for(let e=a.current();e;e=a.next())if(es(e)&&!Jg(e))return n.setStart(e,0),void t.setRng(n)}},Yg=(e,t,n)=>{if(e){const o=t?"nextSibling":"previousSibling";for(e=n?e:e[o];e;e=e[o])if($r(e)||!Jg(e))return e}},Xg=(e,t)=>(Wg(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]),Qg=(e,t,n)=>e.schema.isValidChild(t,n),Jg=(e,t=!1)=>{if(H(e)&&es(e)){const n=t?e.data.replace(/ /g,"\xa0"):e.data;return Ga(n)}return!1},Zg=e=>H(e)&&es(e)&&0===e.length,ep=(e,t)=>(V(e)?e=e(t):H(t)&&(e=e.replace(/%(\w+)/g,((e,n)=>t[n]||e))),e),tp=(e,t)=>(t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),np=(e,t)=>("color"!==t&&"backgroundColor"!==t||(e=qg(e)),"fontWeight"===t&&700===e&&(e="bold"),"fontFamily"===t&&(e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+e),op=(e,t,n)=>np(e.getStyle(t,n),n),rp=(e,t)=>{let n;return e.getParent(t,(t=>(n=e.getStyle(t,"text-decoration"),n&&"none"!==n))),n},sp=(e,t,n)=>e.getParents(t,n,e.getRoot()),ap=(e,t)=>{const n=e=>{const t=e=>e.length>1&&"%"===e.charAt(0);return me(["styles","attributes"],(n=>We(e,n).exists((e=>{const n=I(e)?e:qe(e);return me(n,t)}))))};return me(e.formatter.get(t),n)},ip=(e,t,n)=>{const o=["inline","block","selector","attributes","styles","classes"],r=e=>Ve(e,((e,t)=>me(o,(e=>e===t))));return me(e.formatter.get(t),(t=>{const o=r(t);return me(e.formatter.get(n),(e=>{const t=r(e);return Ye(o,t)}))}))},lp=e=>Ge(e,"block"),dp=e=>Ge(e,"selector"),cp=e=>Ge(e,"inline"),mp=e=>dp(e)&&cp(e)&&Sn(We(e,"mixed"),!0),up=e=>dp(e)&&!1!==e.expand&&!cp(e),fp=Bg,gp=sp,pp=Jg,hp=Xg,bp=e=>as(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,yp=(e,t)=>{let n=t;for(;n;){if($r(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},vp=(e,t,n,o)=>{const r=t.data;for(let t=n;e?t>=0:t<r.length;e?t--:t++)if(o(r.charAt(t)))return e?t+1:t;return-1},Cp=(e,t,n)=>vp(e,t,n,(e=>Pg(e)||Lg(e))),wp=(e,t,n)=>vp(e,t,n,Mg),xp=(e,t,n,o,r,s)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(t,n,o)=>{const s=cd(e),l=r?s.backwards:s.forwards;return re.from(l(t,n,((e,t)=>fp(e.parentNode)?-1:(a=e,o(r,e,t))),i))};return l(n,o,Cp).bind((e=>s?l(e.container,e.offset+(r?-1:0),wp):re.some(e))).orThunk((()=>a?re.some({container:a,offset:r?0:a.length}):re.none()))},kp=(e,t,n,o,r)=>{es(o)&&Dt(o.data)&&o[r]&&(o=o[r]);const s=gp(e,o);for(let o=0;o<s.length;o++)for(let r=0;r<t.length;r++){const a=t[r];if((!H(a.collapsed)||a.collapsed===n.collapsed)&&(dp(a)&&e.is(s[o],a.selector)))return s[o]}return o},Sp=(e,t,n,o)=>{let r=n;const s=e.dom,a=s.getRoot(),i=t[0];if(lp(i)&&(r=i.wrapper?null:s.getParent(n,i.block,a)),!r){const t=s.getParent(n,"LI,TD,TH");r=s.getParent(es(n)?n.parentNode:n,(t=>t!==a&&hp(e,t)),t)}if(r&&lp(i)&&i.wrapper&&(r=gp(s,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r[o]&&!s.isBlock(r[o])&&(r=r[o],!tp(r,"br")););return r||n},_p=(e,t,n,o)=>{const r=n.parentNode;return!H(n[o])&&(!(r!==t&&!j(r)&&!e.isBlock(r))||_p(e,t,r,o))},Ep=(e,t,n,o,r)=>{let s=n;const a=r?"previousSibling":"nextSibling",i=e.getRoot();if(es(n)&&!pp(n)&&(r?o>0:o<n.data.length))return n;for(;;){if(!t[0].block_expand&&e.isBlock(s))return s;for(let t=s[a];t;t=t[a]){const n=es(t)&&!_p(e,i,t,a);if(!fp(t)&&!bp(t)&&!pp(t,n))return s}if(s===i||s.parentNode===i){n=s;break}s=s.parentNode}return n},Np=e=>fp(e.parentNode)||fp(e),Rp=(e,t,n,o=!1)=>{let{startContainer:r,startOffset:s,endContainer:a,endOffset:i}=t;const l=e.dom,d=n[0];if($r(r)&&r.hasChildNodes()&&(r=Sd(r,s),es(r)&&(s=0)),$r(a)&&a.hasChildNodes()&&(a=Sd(a,t.collapsed?i:i-1),es(a)&&(i=a.nodeValue.length)),r=yp(l,r),a=yp(l,a),Np(r)&&(r=fp(r)?r:r.parentNode,r=t.collapsed?r.previousSibling||r:r.nextSibling||r,es(r)&&(s=t.collapsed?r.length:0)),Np(a)&&(a=fp(a)?a:a.parentNode,a=t.collapsed?a.nextSibling||a:a.previousSibling||a,es(a)&&(i=t.collapsed?0:a.length)),t.collapsed){xp(l,e.getBody(),r,s,!0,o).each((({container:e,offset:t})=>{r=e,s=t}));xp(l,e.getBody(),a,i,!1,o).each((({container:e,offset:t})=>{a=e,i=t}))}return(cp(d)||d.block_expand)&&(cp(d)&&es(r)&&0!==s||(r=Ep(l,n,r,s,!0)),cp(d)&&es(a)&&i!==a.nodeValue.length||(a=Ep(l,n,a,i,!1))),up(d)&&(r=kp(l,n,t,r,"previousSibling"),a=kp(l,n,t,a,"nextSibling")),(lp(d)||dp(d))&&(r=Sp(e,n,r,"previousSibling"),a=Sp(e,n,a,"nextSibling"),lp(d)&&(l.isBlock(r)||(r=Ep(l,n,r,s,!0)),l.isBlock(a)||(a=Ep(l,n,a,i,!1)))),$r(r)&&(s=l.nodeIndex(r),r=r.parentNode),$r(a)&&(i=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:r,startOffset:s,endContainer:a,endOffset:i}},Dp=(e,t,n)=>{const o=t.startOffset,r=Sd(t.startContainer,o),s=t.endOffset,a=Sd(t.endContainer,s-1),i=e=>{const t=e[0];es(t)&&t===r&&o>=t.data.length&&e.splice(0,1);const n=e[e.length-1];return 0===s&&e.length>0&&n===a&&es(n)&&e.splice(e.length-1,1),e},l=(e,t,n)=>{const o=[];for(;e&&e!==n;e=e[t])o.push(e);return o},d=(t,n)=>e.getParent(t,(e=>e.parentNode===n),n),c=(e,t,o)=>{const r=o?"nextSibling":"previousSibling";for(let s=e,a=s.parentNode;s&&s!==t;s=a){a=s.parentNode;const t=l(s===e?s:s[r],r);t.length&&(o||t.reverse(),n(i(t)))}};if(r===a)return n(i([r]));const m=e.findCommonAncestor(r,a);if(e.isChildOf(r,a))return c(r,m,!0);if(e.isChildOf(a,r))return c(a,m);const u=d(r,m)||r,f=d(a,m)||a;c(r,u,!0);const g=l(u===r?u:u.nextSibling,"nextSibling",f===a?f.nextSibling:f);g.length&&n(i(g)),c(a,f)},Ap=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},Tp=e=>ke(e,(e=>{const t=kd(e);return t?[bo.fromDom(t)]:[]})),Op=e=>Ap(e).length>1,Bp=e=>he(Tp(e),Gs),Pp=e=>ra(e,"td[data-mce-selected],th[data-mce-selected]"),Lp=(e,t)=>{const n=Pp(t);return n.length>0?n:Bp(e)},Mp=e=>Lp(Ap(e.selection.getSel()),bo.fromDom(e.getBody())),Ip=(e,t)=>ks(e,"table",t),Fp=e=>{const t=e.startContainer,n=e.startOffset;return es(t)?0===n?re.some(bo.fromDom(t)):re.none():re.from(t.childNodes[n]).map(bo.fromDom)},Up=e=>{const t=e.endContainer,n=e.endOffset;return es(t)?n===t.data.length?re.some(bo.fromDom(t)):re.none():re.from(t.childNodes[n-1]).map(bo.fromDom)},zp=e=>Uo(e).fold(Y([e]),(t=>[e].concat(zp(t)))),jp=e=>zo(e).fold(Y([e]),(t=>"br"===Pn(t)?Bo(t).map((t=>[e].concat(jp(t)))).getOr([]):[e].concat(jp(t)))),Hp=(t,n)=>En(Fp(n),Up(n),((n,o)=>{const r=Ce(zp(t),e(ko,n)),s=Ce(jp(t),e(ko,o));return r.isSome()&&s.isSome()})).getOr(!1),Vp=(e,t,n,o)=>{const r=n,s=new Ds(n,r),a=Ve(e.schema.getMoveCaretBeforeOnEnterElements(),((e,t)=>!ce(["td","th","table"],t.toLowerCase())));do{
if(es(n)&&0!==kn.trim(n.nodeValue).length)return void(o?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(o?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=o?s.next():s.prev());"BODY"===r.nodeName&&(o?t.setStart(r,0):t.setEnd(r,r.childNodes.length))},$p=e=>{const t=e.selection.getSel();return t&&t.rangeCount>0},qp=(e,t)=>{const n=Mp(e);n.length>0?fe(n,(n=>{const o=n.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)})):t(e.selection.getRng(),!1)},Wp=(e,t,n)=>{const o=Rc(e,t);n(o),e.moveToBookmark(o)},Kp=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],Gp=e=>Un(e)&&ia(e)===ga,Yp=(e,t,n,o)=>Do(t).fold((()=>"skipping"),(r=>"br"===o||Gp(t)?"valid":Kl(t)?"existing":cg(t.dom)?"caret":me(Kp,(e=>vo(t,e)))?"valid-block":Qg(e,n,o)&&Qg(e,Pn(r),n)?"valid":"invalid-child")),Xp=(e,t)=>{const n=Rp(e,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},Qp=(e,t,n,o,r,s)=>{const{uid:a=t,...i}=n;ao(e,Ul()),$n(e,`${jl()}`,a),$n(e,`${zl()}`,o);const{attributes:l={},classes:d=[]}=r(a,i);if(qn(e,l),nd(e,d),s){d.length>0&&$n(e,`${Vl()}`,d.join(","));const t=Le(l);t.length>0&&$n(e,`${$l()}`,t.join(","))}},Jp=e=>{lo(e,Ul()),Yn(e,`${jl()}`),Yn(e,`${zl()}`),Yn(e,`${Hl()}`);const t=Kn(e,`${$l()}`).map((e=>e.split(","))).getOr([]),n=Kn(e,`${Vl()}`).map((e=>e.split(","))).getOr([]);fe(t,(t=>Yn(e,t))),od(e,n),Yn(e,`${Vl()}`),Yn(e,`${$l()}`)},Zp=(e,t,n,o,r)=>{const s=bo.fromTag("span",e);return Qp(s,t,n,o,r,!1),s},eh=(e,t,n,o,r,s)=>{const a=[],i=Zp(e.getDoc(),n,s,o,r),l=Ml(),d=()=>{l.clear()},c=()=>l.get().getOrThunk((()=>{const e=sd(i);return a.push(e),l.set(e),e})),m=e=>{fe(e,u)},u=t=>{switch(Yp(e,t,"span",Pn(t))){case"invalid-child":{d();const e=Io(t);m(e),d();break}case"valid-block":d(),Qp(t,n,s,o,r,!0);break;case"valid":{const e=c();fr(t,e);break}}},f=e=>{const t=ue(e,bo.fromDom);m(t)};return Dp(e.dom,t,(e=>{d(),f(e)})),a},th=(e,t,n,o)=>{e.undoManager.transact((()=>{const r=e.selection,s=r.getRng(),a=Mp(e).length>0,i=td("mce-annotation");if(s.collapsed&&!a&&Xp(e,s),r.getRng().collapsed&&!a){const s=Zp(e.getDoc(),i,o,t,n.decorate);xr(s,ea),r.getRng().insertNode(s.dom),r.select(s.dom)}else Wp(r,!1,(()=>{qp(e,(r=>{eh(e,r,i,t,n.decorate,o)}))}))}))},nh=e=>{const t=Zl();Jl(e,t);const n=Ql(e,t),o=Hn("span"),r=e=>{fe(e,(e=>{o(e)?yr(e):Jp(e)}))};return{register:(e,n)=>{t.register(e,n)},annotate:(n,o)=>{t.lookup(n).each((t=>{th(e,n,t,o)}))},annotationChanged:(e,t)=>{n.addListener(e,t)},remove:t=>{const n=e.selection.getBookmark();Wl(e,re.some(t)).each((({elements:e})=>{r(e)})),e.selection.moveToBookmark(n)},removeAll:t=>{const n=e.selection.getBookmark();Ie(Xl(e,t),(e=>{r(e)})),e.selection.moveToBookmark(n)},getAll:t=>{const n=Xl(e,t);return Fe(n,(e=>ue(e,(e=>e.dom))))}}},oh=t=>({getBookmark:e(Tg,t),moveToBookmark:e(Og,t)});oh.isBookmarkNode=Bg;const rh=(e,t,n)=>!n.collapsed&&me(n.getClientRects(),(n=>yd(n,e,t))),sh=(e,t)=>e.dispatch("PreProcess",t),ah=(e,t)=>e.dispatch("PostProcess",t),ih=e=>e.dispatch("remove"),lh=e=>e.dispatch("detach"),dh=(e,t)=>e.dispatch("SwitchMode",{mode:t}),ch=(e,t,n,o,r)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:o,origin:r})},mh=(e,t,n,o,r)=>{e.dispatch("ObjectResized",{target:t,width:n,height:o,origin:r})},uh=e=>e.dispatch("PreInit"),fh=e=>e.dispatch("PostRender"),gh=e=>e.dispatch("Init"),ph=(e,t)=>e.dispatch("PlaceholderToggle",{state:t}),hh=(e,t,n)=>e.dispatch(t,n),bh=(e,t,n,o)=>e.dispatch("FormatApply",{format:t,node:n,vars:o}),yh=(e,t,n,o)=>e.dispatch("FormatRemove",{format:t,node:n,vars:o}),vh=(e,t)=>e.dispatch("BeforeSetContent",t),Ch=(e,t)=>e.dispatch("SetContent",t),wh=(e,t)=>e.dispatch("BeforeGetContent",t),xh=(e,t)=>e.dispatch("GetContent",t),kh=(e,t)=>e.dispatch("AutocompleterStart",t),Sh=(e,t)=>e.dispatch("AutocompleterUpdate",t),_h=e=>e.dispatch("AutocompleterEnd"),Eh=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),Nh=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),Rh=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),Dh={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||Dh.metaKeyPressed(e),metaKeyPressed:e=>pn.os.isMacOS()||pn.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},Ah="data-mce-selected",Th="table,img,figure.image,hr,video,span.mce-preview-object",Oh=Math.abs,Bh=Math.round,Ph={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},Lh=e=>"longpress"===e.type||0===e.type.indexOf("touch"),Mh=(e,t)=>{const n=t.dom,o=t.getDoc(),r=document,s=t.getBody();let a,i,l,d,c,m,u,f,g,p,h,b,y,v,C,w,x;const k=e=>H(e)&&(is(e)||n.is(e,"figure.image")),S=e=>ms(e)||n.hasClass(e,"mce-preview-object"),_=(e,t)=>{if(Lh(e)){const n=e.touches[0];return k(e.target)&&!rh(n.clientX,n.clientY,t)}return k(e.target)&&!rh(e.clientX,e.clientY,t)},E=e=>{const n=e.target;_(e,t.selection.getRng())&&!e.isDefaultPrevented()&&t.selection.select(n)},N=e=>n.is(e,"figure.image")?[e.querySelector("img")]:n.hasClass(e,"mce-preview-object")&&H(e.firstElementChild)?[e,e.firstElementChild]:[e],R=e=>{const o=Lm(t);return!!o&&("false"!==e.getAttribute("data-mce-resize")&&(e!==t.getBody()&&(n.hasClass(e,"mce-preview-object")?vo(bo.fromDom(e.firstElementChild),o):vo(bo.fromDom(e),o))))},D=e=>S(e)?n.create("img",{src:pn.transparentSrc}):e.cloneNode(!0),A=(e,o,r)=>{if(H(r)){const s=N(e);fe(s,(e=>{e.style[o]||!t.schema.isValid(e.nodeName.toLowerCase(),o)?n.setStyle(e,o,r):n.setAttrib(e,o,""+r)}))}},T=(e,t,n)=>{A(e,"width",t),A(e,"height",n)},O=e=>{let o,r,c,_,E;o=e.screenX-m,r=e.screenY-u,v=o*d[2]+p,C=r*d[3]+h,v=v<5?5:v,C=C<5?5:C,c=(k(a)||S(a))&&!1!==Mm(t)?!Dh.modifierPressed(e):Dh.modifierPressed(e),c&&(Oh(o)>Oh(r)?(C=Bh(v*b),v=Bh(C/b)):(v=Bh(C/b),C=Bh(v*b))),T(i,v,C),_=d.startPos.x+o,E=d.startPos.y+r,_=_>0?_:0,E=E>0?E:0,n.setStyles(l,{left:_,top:E,display:"block"}),l.innerHTML=v+" &times; "+C,d[2]<0&&i.clientWidth<=v&&n.setStyle(i,"left",f+(p-v)),d[3]<0&&i.clientHeight<=C&&n.setStyle(i,"top",g+(h-C)),o=s.scrollWidth-w,r=s.scrollHeight-x,o+r!==0&&n.setStyles(l,{left:_-o,top:E-r}),y||(ch(t,a,p,h,"corner-"+d.name),y=!0)},B=()=>{const e=y;y=!1,e&&(A(a,"width",v),A(a,"height",C)),n.unbind(o,"mousemove",O),n.unbind(o,"mouseup",B),r!==o&&(n.unbind(r,"mousemove",O),n.unbind(r,"mouseup",B)),n.remove(i),n.remove(l),n.remove(c),P(a),e&&(mh(t,a,v,C,"corner-"+d.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},P=e=>{U();const f=n.getPos(e,s),g=f.x,y=f.y,k=e.getBoundingClientRect(),S=k.width||k.right-k.left,_=k.height||k.bottom-k.top;a!==e&&(M(),a=e,v=C=0);const E=t.dispatch("ObjectSelected",{target:e});R(e)&&!E.isDefaultPrevented()?Ie(Ph,((e,t)=>{let f;const v=f=>{const v=N(a)[0];m=f.screenX,u=f.screenY,p=v.clientWidth,h=v.clientHeight,b=h/p,d=e,d.name=t,d.startPos={x:S*e[0]+g,y:_*e[1]+y},w=s.scrollWidth,x=s.scrollHeight,c=n.add(s,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(c,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=D(a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:g,top:y,margin:0}),T(i,S,_),i.removeAttribute(Ah),s.appendChild(i),n.bind(o,"mousemove",O),n.bind(o,"mouseup",B),r!==o&&(n.bind(r,"mousemove",O),n.bind(r,"mouseup",B)),l=n.add(s,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},p+" &times; "+h)};f=n.get("mceResizeHandle"+t),f&&n.remove(f),f=n.add(s,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),n.bind(f,"mousedown",(e=>{e.stopImmediatePropagation(),e.preventDefault(),v(e)})),e.elm=f,n.setStyles(f,{left:S*e[0]+g-f.offsetWidth/2,top:_*e[1]+y-f.offsetHeight/2})})):M(!1)},L=Il(P,0),M=(e=!0)=>{L.cancel(),U(),a&&e&&a.removeAttribute(Ah),Ie(Ph,((e,t)=>{const o=n.get("mceResizeHandle"+t);o&&(n.unbind(o),n.remove(o))}))},I=(e,t)=>H(e)&&n.isChildOf(e,t),F=o=>{if(y||t.removed||t.composing)return;const r="mousedown"===o.type?o.target:e.getNode(),a=_s(bo.fromDom(r),Th).map((e=>e.dom)).getOrUndefined(),i=H(a)?n.getAttrib(a,Ah,"1"):"1";if(fe(n.select(`img[${Ah}],hr[${Ah}]`),(e=>{e.removeAttribute(Ah)})),I(a,s)){z();const t=e.getStart(!0);if(I(t,a)&&I(e.getEnd(!0),a))return n.setAttrib(a,Ah,i),void L.throttle(a)}M()},U=()=>{Ie(Ph,(e=>{e.elm&&(n.unbind(e.elm),delete e.elm)}))},z=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}};t.on("init",(()=>{z(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",F),t.on("keyup compositionend",(e=>{a&&"TABLE"===a.nodeName&&F(e)})),t.on("hide blur",M),t.on("contextmenu longpress",E,!0)})),t.on("remove",U);return{isResizable:R,showResizeRect:P,hideResizeRect:M,updateResizeRect:F,destroy:()=>{L.cancel(),a=i=c=null}}},Ih=(e,t)=>{t.fold((t=>{e.setStartBefore(t.dom)}),((t,n)=>{e.setStart(t.dom,n)}),(t=>{e.setStartAfter(t.dom)}))},Fh=(e,t)=>{t.fold((t=>{e.setEndBefore(t.dom)}),((t,n)=>{e.setEnd(t.dom,n)}),(t=>{e.setEndAfter(t.dom)}))},Uh=(e,t,n)=>{const o=e.document.createRange();return Ih(o,t),Fh(o,n),o},zh=(e,t,n,o,r)=>{const s=e.document.createRange();return s.setStart(t.dom,n),s.setEnd(o.dom,r),s},jh=Mc.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Hh=(e,t,n)=>t(bo.fromDom(n.startContainer),n.startOffset,bo.fromDom(n.endContainer),n.endOffset),Vh=(e,t)=>t.match({domRange:e=>({ltr:Y(e),rtl:re.none}),relative:(t,n)=>({ltr:at((()=>Uh(e,t,n))),rtl:at((()=>re.some(Uh(e,n,t))))}),exact:(t,n,o,r)=>({ltr:at((()=>zh(e,t,n,o,r))),rtl:at((()=>re.some(zh(e,o,r,t,n))))})}),$h=(e,t)=>{const n=t.ltr();if(n.collapsed){return t.rtl().filter((e=>!1===e.collapsed)).map((e=>jh.rtl(bo.fromDom(e.endContainer),e.endOffset,bo.fromDom(e.startContainer),e.startOffset))).getOrThunk((()=>Hh(e,jh.ltr,n)))}return Hh(e,jh.ltr,n)},qh=(e,t)=>{const n=Vh(e,t);return $h(e,n)};jh.ltr,jh.rtl;const Wh=(e,t,n,o)=>({start:e,soffset:t,finish:n,foffset:o}),Kh={create:Wh},Gh=(e,t,n)=>{var o,r;return re.from(null===(r=(o=e.dom).caretPositionFromPoint)||void 0===r?void 0:r.call(o,t,n)).bind((t=>{if(null===t.offsetNode)return re.none();const n=e.dom.createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),re.some(n)}))},Yh=(e,t,n)=>{var o,r;return re.from(null===(r=(o=e.dom).caretRangeFromPoint)||void 0===r?void 0:r.call(o,t,n))},Xh=document.caretPositionFromPoint?Gh:document.caretRangeFromPoint?Yh:re.none,Qh=(e,t,n)=>{const o=bo.fromDom(e.document);return Xh(o,t,n).map((e=>Kh.create(bo.fromDom(e.startContainer),e.startOffset,bo.fromDom(e.endContainer),e.endOffset)))},Jh=Mc.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Zh=(e,t,n,o)=>e.fold(t,n,o),eb=e=>e.fold(X,X,X),tb={before:Jh.before,on:Jh.on,after:Jh.after,cata:Zh,getStart:eb},nb=Mc.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ob=e=>nb.exact(e.start,e.soffset,e.finish,e.foffset),rb=e=>e.match({domRange:e=>bo.fromDom(e.startContainer),relative:e=>tb.getStart(e),exact:e=>e}),sb=e=>{const t=rb(e);return Ro(t)},ab={domRange:nb.domRange,relative:nb.relative,exact:nb.exact,exactFromRange:ob,getWin:sb,range:Kh.create},ib=(e,t)=>{const n=Pn(e);return"input"===n?tb.after(e):ce(["br","img"],n)?0===t?tb.before(e):tb.after(e):tb.on(e,t)},lb=(e,t)=>{const n=e.fold(tb.before,ib,tb.after),o=t.fold(tb.before,ib,tb.after);return ab.relative(n,o)},db=(e,t,n,o)=>{const r=ib(e,t),s=ib(n,o);return ab.relative(r,s)},cb=e=>e.match({domRange:e=>{const t=bo.fromDom(e.startContainer),n=bo.fromDom(e.endContainer);return db(t,e.startOffset,n,e.endOffset)},relative:lb,exact:db}),mb=(e,t)=>{const n=(t||document).createDocumentFragment();return fe(e,(e=>{n.appendChild(e.dom)})),bo.fromDom(n)},ub=e=>{const t=ab.getWin(e).dom,n=(e,n,o,r)=>zh(t,e,n,o,r),o=cb(e);return qh(t,o).match({ltr:n,rtl:n})},fb=(e,t,n)=>Qh(e,t,n),gb=(e,t,n)=>fb(n.defaultView,e,t).map((e=>{const t=n.createRange();return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),t})).getOrUndefined(),pb=(e,t)=>e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,hb=(e,t,n)=>{for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null},bb=(e,t,n)=>null!==hb(e,t,n),yb=(e,t,n)=>bb(e,t,(e=>e.nodeName===n)),vb=e=>e&&"TABLE"===e.nodeName,Cb=e=>e&&/^(TD|TH|CAPTION)$/.test(e.nodeName),wb=(e,t)=>wa(e)&&!1===bb(e,t,cg),xb=(e,t,n)=>{const o=new Ds(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());for(;t=o[n?"prev":"next"]();)if(as(t))return!0},kb=(e,t)=>e.previousSibling&&e.previousSibling.nodeName===t,Sb=(e,t)=>{for(;t&&t!==e;){if(ds(t))return!0;t=t.parentNode}return!1},_b=(e,t,n,o,r)=>{let s;const a=e.getRoot();let i;const l=e.schema.getNonEmptyElements(),d=e.getParent(r.parentNode,e.isBlock)||a;if(o&&as(r)&&t&&e.isEmpty(d))return re.some(Xd(r.parentNode,e.nodeIndex(r)));const c=new Ds(r,d);for(;i=c[o?"prev":"next"]();){if("false"===e.getContentEditableParent(i)||wb(i,a))return re.none();if(es(i)&&i.nodeValue.length>0)return!1===yb(i,a,"A")?re.some(Xd(i,o?i.nodeValue.length:0)):re.none();if(e.isBlock(i)||l[i.nodeName.toLowerCase()])return re.none();s=i}return os(s)?re.none():n&&s?re.some(Xd(s,0)):re.none()},Eb=(e,t,n,o)=>{let r,s;const a=e.getRoot();let i,l,d=!1;r=o[(n?"start":"end")+"Container"],s=o[(n?"start":"end")+"Offset"];const c=$r(r)&&s===r.childNodes.length,m=e.schema.getNonEmptyElements();if(l=n,wa(r))return re.none();if($r(r)&&s>r.childNodes.length-1&&(l=!1),rs(r)&&(r=a,s=0),r===a){if(l&&(i=r.childNodes[s>0?s-1:0],i)){if(wa(i))return re.none();if(m[i.nodeName]||vb(i))return re.none()}if(r.hasChildNodes()){if(s=Math.min(!l&&s>0?s-1:s,r.childNodes.length-1),r=r.childNodes[s],s=es(r)&&c?r.data.length:0,!t&&r===a.lastChild&&vb(r))return re.none();if(Sb(a,r)||wa(r))return re.none();if(r.hasChildNodes()&&!1===vb(r)){i=r;const t=new Ds(r,a);do{if(ds(i)||wa(i)){d=!1;break}if(es(i)&&i.nodeValue.length>0){s=l?0:i.nodeValue.length,r=i,d=!0;break}if(m[i.nodeName.toLowerCase()]&&!Cb(i)){s=e.nodeIndex(i),r=i.parentNode,l||s++,d=!0;break}}while(i=l?t.next():t.prev())}}}return t&&(es(r)&&0===s&&_b(e,c,t,!0,r).each((e=>{r=e.container(),s=e.offset(),d=!0})),$r(r)&&(i=r.childNodes[s],i||(i=r.childNodes[s-1]),!i||!as(i)||kb(i,"A")||xb(e,i,!1)||xb(e,i,!0)||_b(e,c,t,!0,i).each((e=>{r=e.container(),s=e.offset(),d=!0})))),l&&!t&&es(r)&&s===r.nodeValue.length&&_b(e,c,t,!1,r).each((e=>{r=e.container(),s=e.offset(),d=!0})),d?re.some(Xd(r,s)):re.none()},Nb=(e,t)=>{const n=t.collapsed,o=t.cloneRange(),r=Xd.fromRangeStart(t);return Eb(e,n,!0,o).each((e=>{n&&Xd.isAbove(r,e)||o.setStart(e.container(),e.offset())})),n||Eb(e,n,!1,o).each((e=>{o.setEnd(e.container(),e.offset())})),n&&o.collapse(!0),pb(t,o)?re.none():re.some(o)},Rb=(e,t)=>e.splitText(t),Db=e=>{let t=e.startContainer,n=e.startOffset,o=e.endContainer,r=e.endOffset;return t===o&&es(t)?n>0&&n<t.nodeValue.length&&(o=Rb(t,n),t=o.previousSibling,r>n?(r-=n,t=o=Rb(o,r).previousSibling,r=o.nodeValue.length,n=0):r=0):(es(t)&&n>0&&n<t.nodeValue.length&&(t=Rb(t,n),n=0),es(o)&&r>0&&r<o.nodeValue.length&&(o=Rb(o,r).previousSibling,r=o.nodeValue.length)),{startContainer:t,startOffset:n,endContainer:o,endOffset:r}},Ab=e=>({walk:(t,n)=>Dp(e,t,n),split:Db,normalize:t=>Nb(e,t).fold(ne,(e=>(t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0)))});Ab.compareRanges=pb,Ab.getCaretRangeFromPoint=gb,Ab.getSelectedNode=kd,Ab.getNode=Sd;const Tb=(e,t)=>{const n=(t,n)=>{if(!$(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);const o=t.dom;uo(o)&&(o.style[e]=n+"px")},o=n=>{const o=t(n);if(o<=0||null===o){const t=or(n,e);return parseFloat(t)||0}return o},r=(e,t)=>ye(t,((t,n)=>{const o=or(e,n),r=void 0===o?0:parseInt(o,10);return isNaN(r)?t:t+r}),0),s=(e,t,n)=>{const o=r(e,n);return t>o?t-o:0};return{set:n,get:o,getOuter:o,aggregate:r,max:s}},Ob=Tb("height",(e=>{const t=e.dom;return Jo(e)?t.getBoundingClientRect().height:t.offsetHeight})),Bb=e=>Ob.get(e),Pb=()=>bo.fromDom(document),Lb=(e,t)=>e.view(t).fold(Y([]),(t=>{const n=e.owner(t),o=Lb(e,n);return[t].concat(o)})),Mb=(e,t)=>{const n=t.owner(e);return Lb(t,n)},Ib=e=>{var t;return(e.dom===document?re.none():re.from(null===(t=e.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(bo.fromDom)},Fb=e=>Eo(e);var Ub=Object.freeze({__proto__:null,view:Ib,owner:Fb});const zb=e=>{const t=Pb(),n=Mr(t),o=Mb(e,Ub),r=Lr(e),s=be(o,((e,t)=>{const n=Lr(t);return{left:e.left+n.left,top:e.top+n.top}}),{left:0,top:0});return Tr(s.left+r.left+n.left,s.top+r.top+n.top)},jb=e=>"textarea"===Pn(e),Hb=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),Vb=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},$b=(e,t)=>{const n=Io(e);if(0===n.length||jb(e))return{element:e,offset:t};if(t<n.length&&!jb(n[t]))return{element:n[t],offset:0};{const o=n[n.length-1];return jb(o)?{element:e,offset:t}:"img"===Pn(o)?{element:o,offset:1}:Un(o)?{element:o,offset:ia(o).length}:{element:o,offset:Io(o).length}}},qb=(e,t)=>{const n=Pr(e),o=Bb(e);return{element:e,bottom:n.top+o,height:o,pos:n,cleanup:t}},Wb=(e,t)=>{const n=$b(e,t),o=bo.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+ga+"</span>");return dr(n.element,o),qb(o,(()=>br(o)))},Kb=e=>qb(bo.fromDom(e),W),Gb=(e,t,n,o)=>{Jb(e,(()=>Xb(e,t,n,o)),n)},Yb=(e,t,n,o,r)=>{const s={elm:o.element.dom,alignToTop:r};if(Hb(e,s))return;n(t,Mr(t).top,o,r),Vb(e,s)},Xb=(e,t,n,o)=>{const r=bo.fromDom(e.getBody()),s=bo.fromDom(e.getDoc());lr(r);const a=Wb(bo.fromDom(n.startContainer),n.startOffset);Yb(e,s,t,a,o),a.cleanup()},Qb=(e,t,n,o)=>{const r=bo.fromDom(e.getDoc());Yb(e,r,n,Kb(t),o)},Jb=(e,t,n)=>{const o=n.startContainer,r=n.startOffset,s=n.endContainer,a=n.endOffset;t(bo.fromDom(o),bo.fromDom(s));const i=e.dom.createRng();i.setStart(o,r),i.setEnd(s,a),e.selection.setRng(n)},Zb=(e,t,n,o)=>{const r=e.pos;if(n)Ir(r.left,r.top,o);else{const n=r.top-t+e.height;Ir(r.left,n,o)}},ey=(e,t,n,o,r)=>{const s=n+t,a=o.pos.top,i=o.bottom,l=i-a>=n;if(a<t)Zb(o,n,!1!==r,e);else if(a>s){Zb(o,n,l?!1!==r:!0===r,e)}else i>s&&!l&&Zb(o,n,!0===r,e)},ty=(e,t,n,o)=>{const r=e.dom.defaultView.innerHeight;ey(e,t,r,n,o)},ny=(e,t,n,o)=>{const r=e.dom.defaultView.innerHeight;ey(e,t,r,n,o);const s=zb(n.element),a=jr(window);s.top<a.y?Fr(n.element,!1!==o):s.top>a.bottom&&Fr(n.element,!0===o)},oy=(e,t,n)=>Gb(e,ty,t,n),ry=(e,t,n)=>Qb(e,t,ty,n),sy=(e,t,n)=>Gb(e,ny,t,n),ay=(e,t,n)=>Qb(e,t,ny,n),iy=(e,t,n)=>{(e.inline?ry:ay)(e,t,n)},ly=(e,t,n)=>{(e.inline?oy:sy)(e,t,n)},dy=e=>e.dom.focus(),cy=e=>{const t=Wo(e).dom;return e.dom===t.activeElement},my=(e=Pb())=>re.from(e.dom.activeElement).map(bo.fromDom),uy=e=>my(Wo(e)).filter((t=>e.dom.contains(t.dom))),fy=(e,t)=>{const n=Un(t)?ia(t).length:Io(t).length+1;return e>n?n:e<0?0:e},gy=e=>ab.range(e.start,fy(e.soffset,e.start),e.finish,fy(e.foffset,e.finish)),py=(e,t)=>!Vr(t.dom)&&(So(e,t)||ko(e,t)),hy=e=>t=>py(e,t.start)&&py(e,t.finish),by=e=>e.inline,yy=e=>ab.range(bo.fromDom(e.startContainer),e.startOffset,bo.fromDom(e.endContainer),e.endOffset),vy=e=>{const t=e.getSelection();return(t&&0!==t.rangeCount?re.from(t.getRangeAt(0)):re.none()).map(yy)},Cy=e=>{const t=Ro(e);return vy(t.dom).filter(hy(e))},wy=(e,t)=>re.from(t).filter(hy(e)).map(gy),xy=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),re.some(t)}catch(e){return re.none()}},ky=e=>{const t=by(e)?Cy(bo.fromDom(e.getBody())):re.none();e.bookmark=t.isSome()?t:e.bookmark},Sy=e=>(e.bookmark?e.bookmark:re.none()).bind((t=>wy(bo.fromDom(e.getBody()),t))).bind(xy),_y=e=>{Sy(e).each((t=>e.selection.setRng(t)))},Ey={isEditorUIElement:e=>{const t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Ny=(e,t)=>($(t)||(t=0),setTimeout(e,t)),Ry=(e,t)=>($(t)||(t=0),setInterval(e,t)),Dy={setEditorTimeout:(e,t,n)=>Ny((()=>{e.removed||t()}),n),setEditorInterval:(e,t,n)=>{const o=Ry((()=>{e.removed?clearInterval(o):t()}),n);return o}},Ay=e=>"nodechange"===e.type&&e.selectionChange,Ty=(e,t)=>{const n=()=>{t.throttle()};bl.DOM.bind(document,"mouseup",n),e.on("remove",(()=>{bl.DOM.unbind(document,"mouseup",n)}))},Oy=(e,t)=>{e.on("mouseup touchend",(()=>{t.throttle()}))},By=(e,t)=>{Oy(e,t),e.on("keyup NodeChange AfterSetSelectionRange",(t=>{Ay(t)||ky(e)}))},Py=e=>{const t=Il((()=>{ky(e)}),0);e.on("init",(()=>{e.inline&&Ty(e,t),By(e,t)})),e.on("remove",(()=>{t.cancel()}))};let Ly;const My=bl.DOM,Iy=e=>Ey.isEditorUIElement(e),Fy=e=>{const t=e.classList;return void 0!==t&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"))},Uy=(e,t)=>{const n=Gm(e),o=My.getParent(t,(t=>Iy(t)||!!n&&e.dom.is(t,n)));return null!==o},zy=e=>{try{const t=Wo(bo.fromDom(e.getElement()));return my(t).fold((()=>document.body),(e=>e.dom))}catch(e){return document.body}},jy=(e,t)=>{const n=t.editor;Py(n),n.on("focusin",(()=>{const t=e.focusedEditor;t!==n&&(t&&t.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:t}),n.focus(!0))})),n.on("focusout",(()=>{Dy.setEditorTimeout(n,(()=>{const t=e.focusedEditor;Uy(n,zy(n))||t!==n||(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),Ly||(Ly=t=>{const n=e.activeEditor;n&&Xo(t).each((t=>{t.ownerDocument===document&&(t===document.body||Uy(n,t)||e.focusedEditor!==n||(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null))}))},My.bind(document,"focusin",Ly))},Hy=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(My.unbind(document,"focusin",Ly),Ly=null)},Vy=t=>{t.on("AddEditor",e(jy,t)),t.on("RemoveEditor",e(Hy,t))},$y=(e,t)=>e.dom.getParent(t,(t=>"true"===e.dom.getContentEditable(t))),qy=e=>e.collapsed?re.from(Sd(e.startContainer,e.startOffset)).map(bo.fromDom):re.none(),Wy=(e,t)=>qy(t).bind((t=>Ks(t)?re.some(t):!1===So(e,t)?re.some(e):re.none())),Ky=(e,t)=>{Wy(bo.fromDom(e.getBody()),t).bind((e=>ig(e.dom))).fold((()=>{e.selection.normalize()}),(t=>e.selection.setRng(t.toRange())))},Gy=e=>{if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},Yy=e=>cy(e)||uy(e).isSome(),Xy=e=>e.iframeElement&&cy(bo.fromDom(e.iframeElement)),Qy=e=>{const t=e.getBody();return t&&Yy(bo.fromDom(t))},Jy=e=>{const t=Wo(bo.fromDom(e.getElement()));return my(t).filter((t=>!Fy(t.dom)&&Uy(e,t.dom))).isSome()},Zy=e=>e.inline?Qy(e):Xy(e),ev=e=>Zy(e)||Jy(e),tv=e=>{const t=e.selection,n=e.getBody();let o=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===Zy(e)&&Sy(e).each((t=>{e.selection.setRng(t),o=t}));const r=$y(e,t.getNode());if(e.dom.isChildOf(r,n))return Gy(r),Ky(e,o),void nv(e);e.inline||(pn.browser.isOpera()||Gy(n),e.getWin().focus()),(pn.browser.isFirefox()||e.inline)&&(Gy(n),Ky(e,o)),nv(e)},nv=e=>e.editorManager.setActive(e),ov=(e,t)=>{e.removed||(t?nv(e):tv(e))},rv=(e,t,n,o,r)=>{const s=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return re.from(s).map(bo.fromDom).map((e=>o&&t.collapsed?e:Fo(e,r(e,a)).getOr(e))).bind((e=>Fn(e)?re.some(e):Do(e).filter(Fn))).map((e=>e.dom)).getOr(e)},sv=(e,t,n)=>rv(e,t,!0,n,((e,t)=>Math.min(jo(e),t))),av=(e,t,n)=>rv(e,t,!1,n,((e,t)=>t>0?t-1:t)),iv=(e,t)=>{const n=e;for(;e&&es(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},lv=(e,t)=>{let n,o,r;if(!t)return e;o=t.startContainer,r=t.endContainer;const s=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(o===r&&a-s<2&&o.hasChildNodes()&&(n=o.childNodes[s]),3===o.nodeType&&3===r.nodeType&&(o=o.length===s?iv(o.nextSibling,!0):o.parentNode,r=0===a?iv(r.previousSibling,!1):r.parentNode,o&&o===r))?o:n&&3===n.nodeType?n.parentNode:n},dv=(e,t,n,o)=>{let r;const s=[],a=e.getRoot();if(n=e.getParent(n||sv(a,t,t.collapsed),e.isBlock),o=e.getParent(o||av(a,t,t.collapsed),e.isBlock),n&&n!==a&&s.push(n),n&&o&&n!==o){r=n;const t=new Ds(n,a);for(;(r=t.next())&&r!==o;)e.isBlock(r)&&s.push(r)}return o&&n!==o&&o!==a&&s.push(o),s},cv=(e,t,n)=>re.from(t).map((t=>{const o=e.nodeIndex(t),r=e.createRng();return r.setStart(t.parentNode,o),r.setEnd(t.parentNode,o+1),n&&(Vp(e,r,t,!0),Vp(e,r,t,!1)),r})),mv=(e,t)=>ue(t,(t=>{const n=e.dispatch("GetSelectionRange",{range:t});return n.range!==t?n.range:t})),uv=e=>"img"===Pn(e)?1:la(e).fold((()=>Io(e).length),(e=>e.length)),fv=e=>la(e).filter((e=>0!==e.trim().length||e.indexOf(ea)>-1)).isSome(),gv=["img","br"],pv=e=>fv(e)||ce(gv,Pn(e)),hv=e=>xs(e,pv),bv=e=>yv(e,pv),yv=(e,t)=>{const n=e=>{const o=Io(e);for(let e=o.length-1;e>=0;e--){const r=o[e];if(t(r))return re.some(r);const s=n(r);if(s.isSome())return s}return re.none()};return n(e)},vv="[data-mce-autocompleter]",Cv=(e,t)=>{if(xv(bo.fromDom(e.getBody())).isNone()){const n=bo.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());ur(n,bo.fromDom(t.extractContents())),t.insertNode(n.dom),Do(n).each((e=>e.dom.normalize())),bv(n).map((t=>{e.selection.setCursorLocation(t.dom,uv(t))}))}},wv=e=>_s(e,vv),xv=e=>Ss(e,vv),kv=(e,t)=>xv(t).each((t=>{const n=e.selection.getBookmark();yr(t),e.selection.moveToBookmark(n)})),Sv={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},_v=(e,t,n)=>{const o=n?"lastChild":"firstChild",r=n?"prev":"next";if(e[o])return e[o];if(e!==t){let n=e[r];if(n)return n;for(let o=e.parent;o&&o!==t;o=o.parent)if(n=o[r],n)return n}},Ev=e=>{if(!Ga(e.value))return!1;const t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},Nv=e=>{const t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class Rv{constructor(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}static create(e,t){const n=new Rv(e,Sv[e]||1);return t&&Ie(t,((e,t)=>{n.attr(t,e)})),n}replace(e){const t=this;return e.parent&&e.remove(),t.insert(e,t),t.remove(),t}attr(e,t){const n=this;let o;if("string"!=typeof e)return null!=e&&Ie(e,((e,t)=>{n.attr(t,e)})),n;if(o=n.attributes){if(void 0!==t){if(null===t){if(e in o.map){delete o.map[e];let t=o.length;for(;t--;)if(o[t].name===e)return o.splice(t,1),n}return n}if(e in o.map){let n=o.length;for(;n--;)if(o[n].name===e){o[n].value=t;break}}else o.push({name:e,value:t});return o.map[e]=t,n}return o.map[e]}}clone(){const e=this,t=new Rv(e.name,e.type);let n;if(n=e.attributes){const e=[];e.map={};for(let t=0,o=n.length;t<o;t++){const o=n[t];"id"!==o.name&&(e[e.length]={name:o.name,value:o.value},e.map[o.name]=o.value)}t.attributes=e}return t.value=e.value,t}wrap(e){const t=this;return t.parent.insert(e,t),e.append(t),t}unwrap(){const e=this;for(let t=e.firstChild;t;){const n=t.next;e.insert(t,e,!0),t=n}e.remove()}remove(){const e=this,t=e.parent,n=e.next,o=e.prev;return t&&(t.firstChild===e?(t.firstChild=n,n&&(n.prev=null)):o.next=n,t.lastChild===e?(t.lastChild=o,o&&(o.next=null)):n.prev=o,e.parent=e.next=e.prev=null),e}append(e){const t=this;e.parent&&e.remove();const n=t.lastChild;return n?(n.next=e,e.prev=n,t.lastChild=e):t.lastChild=t.firstChild=e,e.parent=t,e}insert(e,t,n){e.parent&&e.remove();const o=t.parent||this;return n?(t===o.firstChild?o.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===o.lastChild?o.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=o,e}getAll(e){const t=this,n=[];for(let o=t.firstChild;o;o=_v(o,t))o.name===e&&n.push(o);return n}children(){const e=[];for(let t=this.firstChild;t;t=t.next)e.push(t);return e}empty(){const e=this;if(e.firstChild){const t=[];for(let n=e.firstChild;n;n=_v(n,e))t.push(n);let n=t.length;for(;n--;){const e=t[n];e.parent=e.firstChild=e.lastChild=e.next=e.prev=null}}return e.firstChild=e.lastChild=null,e}isEmpty(e,t={},n){const o=this;let r=o.firstChild;if(Nv(o))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(Nv(r))return!1}if(8===r.type)return!1;if(3===r.type&&!Ev(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&Ga(r.value))return!1;if(n&&n(r))return!1}while(r=_v(r,o));return!0}walk(e){return _v(this,null,e)}}const Dv=(e,t)=>/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t)),Av=(e,t,n=0)=>{const o=e.toLowerCase();if(-1!==o.indexOf("[if ",n)&&Dv(o,n)){const e=o.indexOf("[endif]",n);return o.indexOf(">",e)}if(t){const e=o.indexOf(">",n);return-1!==e?e:o.length}{const t=/--!?>/g;t.lastIndex=n;const r=t.exec(e);return r?r.index+r[0].length:o.length}},Tv=(e,t,n)=>{const o=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,r=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,s=e.getVoidElements();let a=1,i=n;for(;0!==a;)for(o.lastIndex=i;;){const e=o.exec(t);if(null===e)return i;if("!"===e[1]){i=xt(e[2],"--")?Av(t,!1,e.index+"!--".length):Av(t,!0,e.index+1);break}{r.lastIndex=o.lastIndex;const n=r.exec(t);if(F(n)||n.index!==o.lastIndex)continue;"/"===e[1]?a-=1:Ke(s,e[2])||(a+=1),i=o.lastIndex+n[0].length;break}}return i},Ov=(e,t)=>{const n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")},Bv=(e,t)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,o=e.schema;let r=Ov(e.getTempAttrs(),t);const s=o.getVoidElements();let a;for(;a=n.exec(r);){const e=n.lastIndex,t=a[0].length;let i;i=s[a[1]]?e:Tv(o,r,e),r=r.substring(0,e-t)+r.substring(i),n.lastIndex=e-t}return ha(r)},Pv=Bv,Lv=(e,t)=>{const n=lm(e),o=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s|\xa0|<br \\/>|)<\\/${n}>[\r\n]*|<br \\/>[\r\n]*)$`);return t.replace(o,"")},Mv=(e,t,n)=>{let o;"raw"===t.format?o=kn.trim(Pv(e.serializer,n.innerHTML)):"text"===t.format?(o=ha(n.innerText),o="\n"===o?"":o):o="tree"===t.format?e.serializer.serialize(n,t):Lv(e,e.serializer.serialize(n,t));return"text"!==t.format&&!Ys(bo.fromDom(n))&&P(o)?kn.trim(o):o},Iv=(e,t)=>re.from(e.getBody()).fold(Y("tree"===t.format?new Rv("body",11):""),(n=>Mv(e,t,n))),Fv=kn.each,Uv=e=>{const t=(t,n)=>{if(t.nodeName!==n.nodeName)return!1;const o=t=>{const n={};return Fv(e.getAttribs(t),(o=>{const r=o.nodeName.toLowerCase();0!==r.indexOf("_")&&"style"!==r&&0!==r.indexOf("data-")&&(n[r]=e.getAttrib(t,r))})),n},r=(e,t)=>{let n,o;for(o in e)if(Ke(e,o)){if(n=t[o],void 0===n)return!1;if(e[o]!==n)return!1;delete t[o]}for(o in t)if(Ke(t,o))return!1;return!0};return!!r(o(t),o(n))&&(!!r(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))&&(!Bg(t)&&!Bg(n)))};return{compare:t}},zv=kn.makeMap,jv=e=>{const t=[],n=(e=e||{}).indent,o=zv(e.indent_before||""),r=zv(e.indent_after||""),s=Bi.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="xhtml"!==e.element_format;return{start:(e,i,l)=>{let d,c,m,u;if(n&&o[e]&&t.length>0&&(u=t[t.length-1],u.length>0&&"\n"!==u&&t.push("\n")),t.push("<",e),i)for(d=0,c=i.length;d<c;d++)m=i[d],t.push(" ",m.name,'="',s(m.value,!0),'"');t[t.length]=!l||a?">":" />",l&&n&&r[e]&&t.length>0&&(u=t[t.length-1],u.length>0&&"\n"!==u&&t.push("\n"))},end:e=>{let o;t.push("</",e,">"),n&&r[e]&&t.length>0&&(o=t[t.length-1],o.length>0&&"\n"!==o&&t.push("\n"))},text:(e,n)=>{e.length>0&&(t[t.length]=n?e:s(e))},cdata:e=>{t.push("<![CDATA[",e,"]]>")},comment:e=>{t.push("<!--",e,"-->")},pi:(e,o)=>{o?t.push("<?",e," ",s(o),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:e=>{t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Hv=(e,t=Wi())=>{const n=jv(e);(e=e||{}).validate=!("validate"in e)||e.validate;const o=o=>{const r=e.validate,s={3:e=>{n.text(e.value,e.raw)},8:e=>{n.comment(e.value)},7:e=>{n.pi(e.name,e.value)},10:e=>{n.doctype(e.value)},4:e=>{n.cdata(e.value)},11:e=>{if(e=e.firstChild)do{a(e)}while(e=e.next)}};n.reset();const a=e=>{const o=s[e.type];if(o)o(e);else{const o=e.name,s=o in t.getVoidElements();let i=e.attributes;if(r&&i&&i.length>1){const n=[];n.map={};const o=t.getElementRule(e.name);if(o){for(let e=0,t=o.attributesOrder.length;e<t;e++){const t=o.attributesOrder[e];if(t in i.map){const e=i.map[t];n.map[t]=e,n.push({name:t,value:e})}}for(let e=0,t=i.length;e<t;e++){const t=i[e].name;if(!(t in n.map)){const e=i.map[t];n.map[t]=e,n.push({name:t,value:e})}}i=n}}if(n.start(o,i,s),!s){let t=e.firstChild;if(t){"pre"!==o&&"textarea"!==o||3!==t.type||"\n"!==t.value[0]||n.text("\n",!0);do{a(t)}while(t=t.next)}n.end(o)}}};return 1!==o.type||e.inner?3===o.type?s[3](o):s[11](o):a(o),n.getContent()};return{serialize:o}},Vv=new Set
;fe(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],(e=>{Vv.add(e)}));const $v=["font","text-decoration","text-emphasis"],qv=(e,t)=>Le(e.parseStyle(e.getAttrib(t,"style"))),Wv=e=>Vv.has(e),Kv=(e,t)=>Se(qv(e,t),(e=>!Wv(e))),Gv=e=>he(e,(e=>me($v,(t=>xt(e,t))))),Yv=(e,t,n)=>{const o=qv(e,t),r=qv(e,n),s=o=>{var r,s;const a=null!==(r=e.getStyle(t,o))&&void 0!==r?r:"",i=null!==(s=e.getStyle(n,o))&&void 0!==s?s:"";return Rt(a)&&Rt(i)&&a!==i};return me(o,(e=>{const t=t=>me(t,(t=>t===e));if(!t(r)&&t($v)){const e=Gv(r);return me(e,s)}return s(e)}))},Xv=(e,t,n)=>re.from(n.container()).filter(es).exists((o=>{const r=e?0:-1;return t(o.data.charAt(n.offset()+r))})),Qv=e(Xv,!0,Lg),Jv=e(Xv,!1,Lg),Zv=e=>{const t=e.container();return es(t)&&(0===t.data.length||pa(t.data)&&oh.isBookmarkNode(t.parentNode))},eC=(e,t)=>n=>re.from(wf(e?0:-1,n)).filter(t).isSome(),tC=e=>is(e)&&"block"===or(bo.fromDom(e),"display"),nC=e=>ds(e)&&!Xr(e),oC=eC(!0,tC),rC=eC(!1,tC),sC=eC(!0,ms),aC=eC(!1,ms),iC=eC(!0,Qr),lC=eC(!1,Qr),dC=eC(!0,nC),cC=eC(!1,nC),mC=e=>e.slice(0,-1),uC=(e,t,n)=>So(t,e)?mC(To(e,(e=>n(e)||ko(e,t)))):[],fC=(e,t)=>uC(e,t,ne),gC=(e,t)=>[e].concat(fC(e,t)),pC=(e,t,n)=>og(e,t,n,Zv),hC=(e,t)=>Ce(gC(bo.fromDom(t.container()),e),zs),bC=(e,t,n)=>pC(e,t.dom,n).forall((e=>hC(t,n).fold((()=>!1===Cf(e,n,t.dom)),(o=>!1===Cf(e,n,t.dom)&&So(o,bo.fromDom(e.container())))))),yC=(e,t,n)=>hC(t,n).fold((()=>pC(e,t.dom,n).forall((e=>!1===Cf(e,n,t.dom)))),(t=>pC(e,t.dom,n).isNone())),vC=e(yC,!1),CC=e(yC,!0),wC=e(bC,!1),xC=e(bC,!0),kC=e=>Af(e).exists(Vs),SC=(e,t,n)=>{const o=he(gC(bo.fromDom(n.container()),t),zs),r=Ae(o).getOr(t);return tg(e,r.dom,n).filter(kC)},_C=(e,t)=>Af(t).exists(Vs)||SC(!0,e,t).isSome(),EC=(e,t)=>Tf(t).exists(Vs)||SC(!1,e,t).isSome(),NC=e(SC,!1),RC=e(SC,!0),DC=e=>Xd.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),AC=(e,t)=>{const n=he(gC(bo.fromDom(t.container()),e),zs);return Ae(n).getOr(e)},TC=(e,t)=>DC(t)?Jv(t):Jv(t)||ag(AC(e,t).dom,t).exists(Jv),OC=(e,t)=>DC(t)?Qv(t):Qv(t)||sg(AC(e,t).dom,t).exists(Qv),BC=e=>ce(["pre","pre-wrap"],e),PC=e=>Af(e).bind((e=>vs(e,Fn))).exists((e=>BC(or(e,"white-space")))),LC=(e,t)=>ag(e.dom,t).isNone(),MC=(e,t)=>sg(e.dom,t).isNone(),IC=(e,t)=>LC(e,t)||MC(e,t)||vC(e,t)||CC(e,t)||EC(e,t)||_C(e,t),FC=e=>H(e)&&ds(e)&&df(e),UC=e=>t=>FC(new Ds(t,e).next()),zC=(e,t)=>{const n=sg(e.dom,t).getOr(t),o=UC(e.dom);return t.isAtEnd()&&(o(t.container())||o(n.container()))},jC=(e,t)=>!PC(t)&&(IC(e,t)||TC(e,t)||OC(e,t)),HC=(e,t)=>!PC(t)&&(vC(e,t)||wC(e,t)||EC(e,t)||TC(e,t)),VC=e=>{const t=e.container(),n=e.offset();return es(t)&&n<t.data.length?Xd(t,n+1):e},$C=(e,t)=>!PC(t)&&(CC(e,t)||xC(e,t)||_C(e,t)||OC(e,t)||zC(e,t)),qC=(e,t)=>HC(e,t)||$C(e,VC(t)),WC=(e,t)=>Pg(e.charAt(t)),KC=e=>{const t=e.container();return es(t)&&wt(t.data,ea)},GC=e=>{const t=e.split("");return ue(t,((e,n)=>Pg(e)&&n>0&&n<t.length-1&&Mg(t[n-1])&&Mg(t[n+1])?" ":e)).join("")},YC=(e,t)=>{const n=t.data,o=Xd(t,0);return!(!WC(n,0)||qC(e,o))&&(t.data=" "+n.slice(1),!0)},XC=e=>{const t=e.data,n=GC(t);return n!==t&&(e.data=n,!0)},QC=(e,t)=>{const n=t.data,o=Xd(t,n.length-1);return!(!WC(n,n.length-1)||qC(e,o))&&(t.data=n.slice(0,-1)+" ",!0)},JC=(e,t)=>re.some(t).filter(KC).bind((t=>{const n=t.container();return YC(e,n)||XC(n)||QC(e,n)?re.some(t):re.none()})),ZC=e=>{const t=bo.fromDom(e.getBody());e.selection.isCollapsed()&&JC(t,Xd.fromRangeStart(e.selection.getRng())).each((t=>{e.selection.setRng(t.toRange())}))},ew=(e,t,n)=>{if(0===n)return;const o=bo.fromDom(e),r=ys(o,zs).getOr(o),s=e.data.slice(t,t+n),a=t+n>=e.data.length&&$C(r,Xd(e,e.data.length)),i=0===t&&HC(r,Xd(e,0));e.replaceData(t,n,Ja(s,4,i,a))},tw=(e,t)=>{const n=e.data.slice(t),o=n.length-Et(n).length;ew(e,t,o)},nw=(e,t)=>{const n=e.data.slice(0,t),o=n.length-Nt(n).length;ew(e,t-o,o)},ow=(e,t,n,o=!0)=>{const r=Nt(e.data).length,s=o?e:t,a=o?t:e;return o?s.appendData(a.data):s.insertData(0,a.data),br(bo.fromDom(a)),n&&tw(s,r),s},rw=(e,t)=>{const n=e.container(),o=e.offset();return!1===Xd.isTextPosition(e)&&n===t.parentNode&&o>Xd.before(t).offset()},sw=(e,t)=>rw(t,e)?Xd(t.container(),t.offset()-1):t,aw=e=>es(e)?Xd(e,0):Xd.before(e),iw=e=>es(e)?Xd(e,e.data.length):Xd.after(e),lw=e=>za(e.previousSibling)?re.some(iw(e.previousSibling)):e.previousSibling?lg(e.previousSibling):re.none(),dw=e=>za(e.nextSibling)?re.some(aw(e.nextSibling)):e.nextSibling?ig(e.nextSibling):re.none(),cw=(e,t)=>{const n=Xd.before(t.previousSibling?t.previousSibling:t.parentNode);return ag(e,n).fold((()=>sg(e,Xd.after(t))),re.some)},mw=(e,t)=>sg(e,Xd.after(t)).fold((()=>ag(e,Xd.before(t))),re.some),uw=(e,t)=>lw(t).orThunk((()=>dw(t))).orThunk((()=>cw(e,t))),fw=(e,t)=>dw(t).orThunk((()=>lw(t))).orThunk((()=>mw(e,t))),gw=(e,t,n)=>e?fw(t,n):uw(t,n),pw=(t,n,o)=>gw(t,n,o).map(e(sw,o)),hw=(e,t,n)=>{n.fold((()=>{e.focus()}),(n=>{e.selection.setRng(n.toRange(),t)}))},bw=e=>t=>t.dom===e,yw=(e,t)=>t&&Ke(e.schema.getBlockElements(),Pn(t)),vw=e=>{if(ii(e)){const t=bo.fromHtml('<br data-mce-bogus="1">');return hr(e),ur(e,t),re.some(Xd.before(t.dom))}return re.none()},Cw=(e,t,n)=>{const o=Bo(e).filter(Un),r=Po(e).filter(Un);return br(e),Nn(o,r,t,((e,t,o)=>{const r=e.dom,s=t.dom,a=r.data.length;return ow(r,s,n),o.container()===s?Xd(r,a):o})).orThunk((()=>(n&&(o.each((e=>nw(e.dom,e.dom.length))),r.each((e=>tw(e.dom,0)))),t)))},ww=(e,t)=>Ke(e.schema.getTextInlineElements(),Pn(t)),xw=(t,n,o,r=!0)=>{const s=pw(n,t.getBody(),o.dom),a=ys(o,e(yw,t),bw(t.getBody())),i=Cw(o,s,ww(t,o));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):a.bind(vw).fold((()=>{r&&hw(t,n,i)}),(e=>{r&&hw(t,n,re.some(e))}))},kw=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Sw=e=>kw.test(e),_w=(e,t)=>vo(bo.fromDom(t),Pm(e)),Ew=e=>"rtl"===bl.DOM.getStyle(e,"direction",!0)||Sw(e.textContent),Nw=(e,t,n)=>he(bl.DOM.getParents(n.container(),"*",t),e),Rw=(e,t,n)=>{const o=Nw(e,t,n);return re.from(o[o.length-1])},Dw=(e,t,n)=>{const o=vf(t,e),r=vf(n,e);return o&&o===r},Aw=e=>Sa(e)||_a(e),Tw=(e,t)=>{if(!t)return t;const n=t.container(),o=t.offset();return e?Ca(n)?es(n.nextSibling)?Xd(n.nextSibling,0):Xd.after(n):Sa(t)?Xd(n,o+1):t:Ca(n)?es(n.previousSibling)?Xd(n.previousSibling,n.previousSibling.data.length):Xd.before(n):_a(t)?Xd(n,o-1):t},Ow=e(Tw,!0),Bw=e(Tw,!1),Pw=(e,t)=>{const n=e=>e.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},Lw=e=>Pw(e,"Delete"),Mw=e=>Pw(e,"ForwardDelete"),Iw=e=>t=>ko(e,bo.fromDom(t.dom.parentNode)),Fw=e=>$s(e)||Ws(e),Uw=(e,t)=>So(e,t)?vs(t,Fw,Iw(e)):re.none(),zw=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},jw=(e,t,n)=>En(ig(n),lg(n),((o,r)=>{const s=Tw(!0,o),a=Tw(!1,r),i=Tw(!1,t);return e?sg(n,i).exists((e=>e.isEqual(a)&&t.isEqual(s))):ag(n,i).exists((e=>e.isEqual(s)&&t.isEqual(a)))})).getOr(!0),Hw=e=>(In(e)?Bo(e):zo(e)).bind(Hw).orThunk((()=>re.some(e))),Vw=(e,t,n,o=!0)=>{var r;t.deleteContents();const s=Hw(n).getOr(n),a=bo.fromDom(null!==(r=e.dom.getParent(s.dom,e.dom.isBlock))&&void 0!==r?r:n.dom);if(a.dom===e.getBody()?zw(e,o):ii(a)&&(ua(a),o&&e.selection.setCursorLocation(a.dom,0)),!ko(n,a)){const e=Sn(Do(a),n)?[]:Oo(a);fe(e.concat(Io(n)),(e=>{ko(e,a)||So(e,a)||!ii(e)||br(e)}))}},$w=e=>t=>ko(e,t),qw=e=>ra(e,"td,th"),Ww=(e,t)=>{const n=e=>Ip(bo.fromDom(e),t),o=n(e.startContainer),r=n(e.endContainer),s=o.isSome(),a=r.isSome(),i=En(o,r,ko).getOr(!1);return{startTable:o,endTable:r,isStartInTable:s,isEndInTable:a,isSameTable:i,isMultiTable:!i&&s&&a}},Kw=(e,t)=>({start:e,end:t}),Gw=(e,t,n)=>({rng:e,table:t,cells:n}),Yw=Mc.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),Xw=(e,t)=>_s(bo.fromDom(e),"td,th",t),Qw=e=>!ko(e.start,e.end),Jw=(e,t)=>Ip(e.start,t).bind((n=>Ip(e.end,t).bind((e=>Rn(ko(n,e),n))))),Zw=(e,t)=>!Qw(e)&&Jw(e,t).exists((e=>{const t=e.dom.rows;return 1===t.length&&1===t[0].cells.length})),ex=(e,t)=>{const n=Xw(e.startContainer,t),o=Xw(e.endContainer,t);return En(n,o,Kw)},tx=e=>t=>Ip(t,e).bind((e=>Te(qw(e)).map((e=>Kw(t,e))))),nx=e=>t=>Ip(t,e).bind((e=>Ae(qw(e)).map((e=>Kw(e,t))))),ox=e=>t=>Jw(t,e).map((e=>Gw(t,e,qw(e)))),rx=(e,t,n,o)=>{if(n.collapsed||!e.forall(Qw))return re.none();if(t.isSameTable){const t=e.bind(ox(o));return re.some({start:t,end:t})}{const e=Xw(n.startContainer,o),t=Xw(n.endContainer,o),r=e.bind(tx(o)).bind(ox(o)),s=t.bind(nx(o)).bind(ox(o));return re.some({start:r,end:s})}},sx=(e,t)=>we(e,(e=>ko(e,t))),ax=e=>En(sx(e.cells,e.rng.start),sx(e.cells,e.rng.end),((t,n)=>e.cells.slice(t,n+1))),ix=(e,t,n)=>e.exists((e=>Zw(e,n)&&Hp(e.start,t))),lx=(e,t)=>{const{startTable:n,endTable:o}=t,r=e.cloneRange();return n.each((e=>r.setStartAfter(e.dom))),o.each((e=>r.setEndBefore(e.dom))),r},dx=(e,t,n,o)=>rx(e,t,n,o).bind((({start:e,end:t})=>e.or(t))).bind((e=>{const{isSameTable:o}=t,r=ax(e).getOr([]);if(o&&e.cells.length===r.length)return re.some(Yw.fullTable(e.table));if(r.length>0){if(o)return re.some(Yw.partialTable(r,re.none()));{const e=lx(n,t);return re.some(Yw.partialTable(r,re.some({...t,rng:e})))}}return re.none()})),cx=(e,t,n,o)=>rx(e,t,n,o).bind((({start:e,end:o})=>{const r=e.bind(ax).getOr([]),s=o.bind(ax).getOr([]);if(r.length>0&&s.length>0){const e=lx(n,t);return re.some(Yw.multiTable(r,s,e))}return re.none()})),mx=(e,t)=>{const n=$w(e),o=ex(t,n),r=Ww(t,n);return ix(o,t,n)?o.map((e=>Yw.singleCellTable(t,e.start))):r.isMultiTable?cx(o,r,t,n):dx(o,r,t,n)},ux=e=>fe(e,(e=>{Yn(e,"contenteditable"),ua(e)})),fx=(e,t)=>re.from(e.dom.getParent(t,e.dom.isBlock)).map(bo.fromDom),gx=(e,t,n)=>{n.each((n=>{t?br(n):(ua(n),e.selection.setCursorLocation(n.dom,0))}))},px=(e,t,n,o)=>{const r=n.cloneRange();o?(r.setStart(n.startContainer,n.startOffset),r.setEndAfter(t.dom.lastChild)):(r.setStartBefore(t.dom.firstChild),r.setEnd(n.endContainer,n.endOffset)),vx(e,r,t,!1).each((e=>e()))},hx=e=>{const t=Mp(e),n=bo.fromDom(e.selection.getNode());cs(n.dom)&&ii(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&me(t,(e=>ko(e,n)))&&$n(n,"data-mce-selected","1")},bx=(e,t,n)=>re.some((()=>{const o=e.selection.getRng(),r=n.bind((({rng:n,isStartInTable:r})=>{const s=fx(e,r?n.endContainer:n.startContainer);n.deleteContents(),gx(e,r,s.filter(ii));const a=r?t[0]:t[t.length-1];return px(e,a,o,r),ii(a)?re.none():re.some(r?t.slice(1):t.slice(0,-1))})).getOr(t);ux(r),hx(e)})),yx=(e,t,n,o)=>re.some((()=>{const r=e.selection.getRng(),s=t[0],a=n[n.length-1];px(e,s,r,!0),px(e,a,r,!1);const i=ii(s)?t:t.slice(1),l=ii(a)?n:n.slice(0,-1);ux(i.concat(l)),o.deleteContents(),hx(e)})),vx=(e,t,n,o=!0)=>re.some((()=>{Vw(e,t,n,o)})),Cx=(e,t)=>re.some((()=>xw(e,!1,t))),wx=(t,n,o)=>mx(n,o).bind((n=>n.fold(e(vx,t),e(Cx,t),e(bx,t),e(yx,t)))),xx=(e,t)=>Rx(e,t),kx=(e,t,n,o)=>Ex(t,o).fold((()=>wx(e,t,n)),(t=>xx(e,t))),Sx=(e,t,n)=>{const o=bo.fromDom(e.getBody()),r=e.selection.getRng();return 0!==n.length?bx(e,n,re.none()):kx(e,o,r,t)},_x=(e,t)=>Ce(gC(t,e),Gs),Ex=(e,t)=>Ce(gC(t,e),Hn("caption")),Nx=(e,t,n,o,r)=>ng(n,e.getBody(),r).bind((e=>_x(t,bo.fromDom(e.getNode())).bind((e=>ko(e,o)?re.none():re.some(W))))),Rx=(e,t)=>re.some((()=>{ua(t),e.selection.setCursorLocation(t.dom,0)})),Dx=(e,t,n,o)=>ig(e.dom).bind((r=>lg(e.dom).map((e=>t?n.isEqual(r)&&o.isEqual(e):n.isEqual(e)&&o.isEqual(r))))).getOr(!0),Ax=(e,t)=>Rx(e,t),Tx=(e,t,n)=>Ex(e,bo.fromDom(n.getNode())).fold((()=>re.some(W)),(e=>Rn(!ko(e,t),W))),Ox=(e,t,n,o,r)=>ng(n,e.getBody(),r).fold((()=>re.some(W)),(s=>Dx(o,n,r,s)?Ax(e,o):Tx(t,o,s))),Bx=(e,t,n,o)=>{const r=Xd.fromRangeStart(e.selection.getRng());return _x(n,o).bind((o=>ii(o)?Rx(e,o):Nx(e,n,t,o,r)))},Px=(e,t,n,o)=>{const r=Xd.fromRangeStart(e.selection.getRng());return ii(o)?Rx(e,o):Ox(e,n,t,o,r)},Lx=(e,t)=>e?iC(t):lC(t),Mx=(e,t)=>{const n=Xd.fromRangeStart(e.selection.getRng());return Lx(t,n)||tg(t,e.getBody(),n).exists((e=>Lx(t,e)))},Ix=(e,t,n)=>{const o=bo.fromDom(e.getBody());return Ex(o,n).fold((()=>Bx(e,t,o,n).orThunk((()=>Rn(Mx(e,t),W)))),(n=>Px(e,t,o,n)))},Fx=(e,t)=>{const n=bo.fromDom(e.selection.getStart(!0)),o=Mp(e);return e.selection.isCollapsed()&&0===o.length?Ix(e,t,n):Sx(e,n,o)},Ux=(e,t)=>{for(;t&&t!==e;){if(ls(t)||ds(t))return t;t=t.parentNode}return null},zx=(e,t)=>{t(e),e.firstChild&&zx(e.firstChild,t),e.next&&zx(e.next,t)},jx=(e,t,n,o)=>{const r=n.name;for(let t=0,s=e.length;t<s;t++){const s=e[t];if(s.name===r){const e=o.nodes[r];e?e.nodes.push(n):o.nodes[r]={filter:s,nodes:[n]}}}if(n.attributes)for(let e=0,r=t.length;e<r;e++){const r=t[e],s=r.name;if(s in n.attributes.map){const e=o.attributes[s];e?e.nodes.push(n):o.attributes[s]={filter:r,nodes:[n]}}}},Hx=(e,t,n)=>{const o={nodes:{},attributes:{}};return n.firstChild&&zx(n.firstChild,(n=>{jx(e,t,n,o)})),o},Vx=(e,t)=>{const n=e=>{Ie(e,(e=>{const n=he(e.nodes,(e=>H(e.parent)));fe(e.filter.callbacks,(o=>{o(n,e.filter.name,t)}))}))};n(e.nodes),n(e.attributes)},$x=(e,t,n,o={})=>{const r=Hx(e,t,n);Vx(r,o)},qx=(e,t,n,o)=>{t.insert&&n[o.name]?o.empty().append(new Rv("br",1)):o.empty().append(new Rv("#text",3)).value=ea},Wx=e=>Kx(e,"#text")&&e.firstChild.value===ea,Kx=(e,t)=>e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t,Gx=(e,t)=>{const n=e.getElementRule(t.name);return n&&n.paddEmpty},Yx=(e,t,n,o)=>o.isEmpty(t,n,(t=>Gx(e,t))),Xx=(e,t)=>e&&(e.name in t||"br"===e.name),Qx=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const o=e.children();for(const e of o)t.isValidChild(n.name,e.name)||Qx(e,t,n);e.unwrap()}},Jx=(e,t,n=W)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),s=t.getWhitespaceElements(),a=kn.makeMap("tr,td,th,tbody,thead,tfoot,table"),i=new Set;for(let l=0;l<e.length;l++){const d=e[l];let c,m,u;if(!d.parent||i.has(d))continue;if(o[d.name]&&"li"===d.parent.name){let e=d.next;for(;e&&o[e.name];)e.name="li",i.add(e),d.parent.insert(e,d.parent),e=e.next;d.unwrap();continue}const f=[d];for(c=d.parent;c&&!t.isValidChild(c.name,d.name)&&!a[c.name];c=c.parent)f.push(c);if(c&&f.length>1)if(t.isValidChild(c.name,d.name)){f.reverse(),m=f[0].clone(),n(m);let e=m;for(let o=0;o<f.length-1;o++){t.isValidChild(e.name,f[o].name)?(u=f[o].clone(),n(u),e.append(u)):u=e;for(let e=f[o].firstChild;e&&e!==f[o+1];){const t=e.next;u.append(e),e=t}e=u}Yx(t,r,s,m)?c.insert(d,f[0],!0):(c.insert(m,f[0],!0),c.insert(d,m)),c=f[0],(Yx(t,r,s,c)||Kx(c,"br"))&&c.empty().remove()}else Qx(d,t);else if(d.parent){if("li"===d.name){let e=d.prev;if(e&&("ul"===e.name||"ol"===e.name)){e.append(d);continue}if(e=d.next,e&&("ul"===e.name||"ol"===e.name)){e.insert(d,e.firstChild,!0);continue}const t=new Rv("ul",1);n(t),d.wrap(t);continue}if(t.isValidChild(d.parent.name,"div")&&t.isValidChild("div",d.name)){const e=new Rv("div",1);n(e),d.wrap(e)}else Qx(d,t)}}},Zx=(e,t,n,o)=>{const r=document.createRange();return r.setStart(e,t),r.setEnd(n,o),r},ek=e=>{const t=Xd.fromRangeStart(e),n=Xd.fromRangeEnd(e),o=e.commonAncestorContainer;return tg(!1,o,n).map((r=>!Cf(t,n,o)&&Cf(t,r,o)?Zx(t.container(),t.offset(),r.container(),r.offset()):e)).getOr(e)},tk=e=>e.collapsed?e:ek(e),nk=e=>e.firstChild&&e.firstChild===e.lastChild,ok=e=>"br"===e.name||e.value===ea,rk=(e,t)=>e.getBlockElements()[t.name]&&nk(t)&&ok(t.firstChild),sk=(e,t)=>{const n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||rk(e,t))},ak=(e,t)=>{let n=t.firstChild,o=t.lastChild;return n&&"meta"===n.name&&(n=n.next),o&&"mce_marker"===o.attr("id")&&(o=o.prev),sk(e,o)&&(o=o.prev),!(!n||n!==o)&&("ul"===n.name||"ol"===n.name)},ik=e=>{const t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e},lk=(e,t,n)=>{const o=t.serialize(n),r=e.createFragment(o);return ik(r)},dk=e=>he(e.childNodes,(e=>"LI"===e.nodeName)),ck=e=>e.data===ea||as(e),mk=e=>e&&e.firstChild&&e.firstChild===e.lastChild&&ck(e.firstChild),uk=e=>!e.firstChild||mk(e),fk=e=>e.length>0&&uk(e[e.length-1])?e.slice(0,-1):e,gk=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},pk=(e,t)=>!!gk(e,t),hk=(e,t)=>{const n=t.cloneRange(),o=t.cloneRange();return n.setStartBefore(e),o.setEndAfter(e),[n.cloneContents(),o.cloneContents()]},bk=(e,t)=>{const n=Xd.before(e),o=Kf(t).next(n);return o?o.toRange():null},yk=(e,t)=>{const n=Xd.after(e),o=Kf(t).prev(n);return o?o.toRange():null},vk=(e,t,n,o)=>{const r=hk(e,o),s=e.parentNode;return s.insertBefore(r[0],e),kn.each(t,(t=>{s.insertBefore(t,e)})),s.insertBefore(r[1],e),s.removeChild(e),yk(t[t.length-1],n)},Ck=(e,t,n)=>{const o=e.parentNode;return kn.each(t,(t=>{o.insertBefore(t,e)})),bk(e,n)},wk=(e,t,n,o)=>(o.insertAfter(t.reverse(),e),yk(t[0],n)),xk=(e,t,n,o)=>{const r=lk(t,e,o),s=gk(t,n.startContainer),a=fk(dk(r.firstChild)),i=1,l=2,d=t.getRoot(),c=e=>{const o=Xd.fromRangeStart(n),r=Kf(t.getRoot()),a=e===i?r.prev(o):r.next(o);return!a||gk(t,a.getNode())!==s};return c(i)?Ck(s,a,d):c(l)?wk(s,a,d,t):vk(s,a,d,n)},kk=["pre"],Sk=(e,t,n,o)=>{var r;const s=t.firstChild,a=t.lastChild,i=s===("bookmark"===a.attr("data-mce-type")?a.prev:a),l=ce(kk,s.name);if(i&&l){const t="false"!==s.attr("contenteditable"),a=(null===(r=e.getParent(n,e.isBlock))||void 0===r?void 0:r.nodeName.toLowerCase())===s.name,i=re.from(Ux(o,n)).forall(ls);return t&&a&&i}return!1},_k=cs,Ek=(e,t,n)=>{if(null!==n){return n===e.getParent(t.endContainer,_k)&&Hp(bo.fromDom(n),t)}return!1},Nk=(e,t,n)=>{if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{const o=n.firstChild,r=n.lastChild;!o||o===r&&"BR"===o.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},Rk=(e,t)=>{re.from(e.getParent(t,"td,th")).map(bo.fromDom).each(fa)},Dk=(e,t)=>{const n=e.schema.getTextInlineElements(),o=e.dom;if(t){const t=e.getBody(),r=Uv(o);kn.each(o.select("*[data-mce-fragment]"),(e=>{if(H(n[e.nodeName.toLowerCase()])&&Kv(o,e))for(let n=e.parentNode;H(n)&&n!==t;n=n.parentNode){if(Yv(o,e,n))break;if(r.compare(n,e)){o.remove(e,!0);break}}}))}},Ak=e=>{let t=e;for(;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")},Tk=e=>{kn.each(e.getElementsByTagName("*"),(e=>{e.removeAttribute("data-mce-fragment")}))},Ok=e=>!!e.getAttribute("data-mce-fragment"),Bk=(e,t)=>t&&!e.schema.getVoidElements()[t.nodeName],Pk=(e,t)=>{let n;const o=e.dom,r=e.selection;if(!t)return;r.scrollIntoView(t);const s=Ux(e.getBody(),t);if("false"===o.getContentEditable(s))return o.remove(t),void r.select(s);let a=o.createRng();const i=t.previousSibling;if(es(i)){a.setStart(i,i.nodeValue.length);const e=t.nextSibling;es(e)&&(i.appendData(e.data),e.parentNode.removeChild(e))}else a.setStartBefore(t),a.setEndBefore(t);const l=t=>{let n=Xd.fromRangeStart(t);if(n=Kf(e.getBody()).next(n),n)return n.toRange()},d=o.getParent(t,o.isBlock);o.remove(t),d&&o.isEmpty(d)&&(hr(bo.fromDom(d)),a.setStart(d,0),a.setEnd(d,0),_k(d)||Ok(d)||!(n=l(a))?o.add(d,o.create("br",{"data-mce-bogus":"1"})):(a=n,o.remove(d))),r.setRng(a)},Lk=e=>{const t=e.dom,n=tk(e.selection.getRng());e.selection.setRng(n);const o=t.getParent(n.startContainer,_k);Ek(t,n,o)?vx(e,n,bo.fromDom(o)):e.getDoc().execCommand("Delete",!1,null)},Mk=(e,t,n)=>{var o;let r,s,a;const i=e.selection,l=e.dom,d=e.parser,c=n.merge,m=Hv({validate:!0},e.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===t.indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,u),s=i.getRng();const f=s.startContainer||(s.parentElement?s.parentElement():null),g=e.getBody();f===g&&i.isCollapsed()&&l.isBlock(g.firstChild)&&Bk(e,g.firstChild)&&l.isEmpty(g.firstChild)&&(s=l.createRng(),s.setStart(g.firstChild,0),s.setEnd(g.firstChild,0),i.setRng(s)),i.isCollapsed()||Lk(e),r=i.getNode();const p={context:r.nodeName.toLowerCase(),data:n.data,insert:!0},h=d.parse(t,p);if(!0===n.paste&&ak(e.schema,h)&&pk(l,r))return s=xk(m,l,i.getRng(),h),i.setRng(s),t;if(!0===n.paste&&Sk(l,h,r,e.getBody())&&(null===(o=h.firstChild)||void 0===o||o.unwrap()),Ak(h),a=h.lastChild,"mce_marker"===a.attr("id")){const t=a;for(a=a.prev;a;a=a.walk(!0))if(3===a.type||!l.isBlock(a.name)){e.schema.isValidChild(a.parent.name,"span")&&a.parent.insert(t,a,"br"===a.name);break}}if(e._selectionOverrides.showBlockCaretContainer(r),p.invalid){e.selection.setContent(u),r=i.getNode();const n=e.getBody();for(9===r.nodeType?r=a=n:a=r;a!==n;)r=a,a=a.parentNode;t=r===n?n.innerHTML:l.getOuterHTML(r);const o=d.parse(t);for(let e=o;e;e=e.walk())if("mce_marker"===e.attr("id")){e.replace(h);break}const s=h.children(),c=h.parent.name;h.unwrap();const f=he(s,(t=>!e.schema.isValidChild(c,t.name)));Jx(f,e.schema),$x(d.getNodeFilters(),d.getAttributeFilters(),o),t=m.serialize(o),r===n?l.setHTML(n,t):l.setOuterHTML(r,t)}else t=m.serialize(h),Nk(e,t,r);return Dk(e,c),Pk(e,l.get("mce_marker")),Tk(e.getBody()),Rk(l,i.getStart()),t},Ik=e=>e instanceof Rv,Fk=e=>{Zy(e)&&ig(e.getBody()).each((t=>{const n=t.getNode(),o=Qr(n)?ig(n).getOr(t):t;e.selection.setRng(o.toRange())}))},Uk=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),!0!==n&&Fk(e)},zk=(e,t,n,o)=>{if(0===n.length||/^\s+$/.test(n)){const r='<br data-mce-bogus="1">';"TABLE"===t.nodeName?n="<tr><td>"+r+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+r+"</li>");const s=lm(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),s.toLowerCase())?(n=r,n=e.dom.createHTML(s,dm(e),n)):n||(n=r),Uk(e,n,o.no_selection),{content:n,html:n}}{"raw"!==o.format&&(n=Hv({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const r=Ys(bo.fromDom(t))?n:kn.trim(n);return Uk(e,r,o.no_selection),{content:r,html:r}}},jk=(e,t,n,o)=>{$x(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const r=Hv({validate:!1},e.schema).serialize(n),s=Ys(bo.fromDom(t))?r:kn.trim(r);return Uk(e,s,o.no_selection),{content:n,html:s}},Hk=(e,t,n)=>re.from(e.getBody()).map((o=>Ik(t)?jk(e,o,t,n):zk(e,o,t,n))).getOr({content:t,html:Ik(n.content)?"":n.content}),Vk=(e,t)=>Cs(e,t).isSome(),$k=e=>V(e)?e:ne,qk=(e,t,n)=>{let o=e.dom;const r=$k(n);for(;o.parentNode;){o=o.parentNode;const e=bo.fromDom(o),n=t(e);if(n.isSome())return n;if(r(e))break}return re.none()},Wk=(e,t,n)=>{const o=t(e),r=$k(n);return o.orThunk((()=>r(e)?re.none():qk(e,t,r)))},Kk=tp,Gk=(e,t,n)=>{const o=e.formatter.get(n);if(o)for(let n=0;n<o.length;n++){const r=o[n];if(dp(r)&&!1===r.inherit&&e.dom.is(t,r.selector))return!0}return!1},Yk=(e,t,n,o,r)=>{const s=e.dom.getRoot();return t!==s&&(t=e.dom.getParent(t,(t=>!!Gk(e,t,n)||(t.parentNode===s||!!Jk(e,t,n,o,!0)))),!!Jk(e,t,n,o,r))},Xk=(e,t,n)=>!(!cp(n)||!Kk(t,n.inline))||(!(!lp(n)||!Kk(t,n.block))||!!dp(n)&&($r(t)&&e.is(t,n.selector))),Qk=(e,t,n,o,r,s)=>{const a=n[o];if(V(n.onmatch))return n.onmatch(t,n,o);if(a)if(z(a.length)){for(const i in a)if(Ke(a,i)){const l="attributes"===o?e.getAttrib(t,i):op(e,t,i),d=ep(a[i],s),c=j(l)||Dt(l);if(c&&j(d))continue;if(r&&c&&!n.exact)return!1;if((!r||n.exact)&&!Kk(l,np(d,i)))return!1}}else for(let n=0;n<a.length;n++)if("attributes"===o?e.getAttrib(t,a[n]):op(e,t,a[n]))return!0;return!0},Jk=(e,t,n,o,r)=>{const s=e.formatter.get(n),a=e.dom;if(s&&t)for(let n=0;n<s.length;n++){const i=s[n];if(Xk(e.dom,t,i)&&Qk(a,t,i,"attributes",r,o)&&Qk(a,t,i,"styles",r,o)){const n=i.classes;if(n)for(let r=0;r<n.length;r++)if(!e.dom.hasClass(t,ep(n[r],o)))return;return i}}},Zk=(e,t,n,o,r)=>{if(o)return Yk(e,o,t,n,r);if(o=e.selection.getNode(),Yk(e,o,t,n,r))return!0;const s=e.selection.getStart();return!(s===o||!Yk(e,s,t,n,r))},eS=(e,t,n)=>{const o=[],r={},s=e.selection.getStart();return e.dom.getParent(s,(s=>{for(let a=0;a<t.length;a++){const i=t[a];!r[i]&&Jk(e,s,i,n)&&(r[i]=!0,o.push(i))}}),e.dom.getRoot()),o},tS=(e,t)=>{const n=t=>ko(t,bo.fromDom(e.getBody())),o=(t,n)=>Jk(e,t.dom,n)?re.some(n):re.none();return re.from(e.selection.getStart(!0)).bind((e=>Wk(bo.fromDom(e),(e=>Be(t,(t=>o(e,t)))),n))).getOrNull()},nS=(e,t)=>{const n=e.formatter.get(t),o=e.dom;if(n){const t=e.selection.getStart(),r=sp(o,t);for(let e=n.length-1;e>=0;e--){const t=n[e];if(!dp(t))return!0;for(let e=r.length-1;e>=0;e--)if(o.is(r[e],t.selector))return!0}}return!1},oS=(e,t,n)=>ye(n,((n,o)=>{const r=ap(e,o);return e.formatter.matchNode(t,o,{},r)?n.concat([o]):n}),[]),rS=ga,sS="_mce_caret",aS=(e,t)=>e.importNode(t,!0),iS=e=>{const t=[];for(;e;){if(3===e.nodeType&&e.nodeValue!==rS||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t},lS=e=>iS(e).length>0,dS=e=>{if(e){const t=new Ds(e,e);for(e=t.current();e;e=t.next())if(es(e))return e}return null},cS=e=>{const t=bo.fromTag("span");return qn(t,{id:sS,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&ur(t,bo.fromText(rS)),t},mS=e=>{const t=dS(e);return t&&t.nodeValue.charAt(0)===rS&&t.deleteData(0,1),t},uS=(e,t,n=!0)=>{const o=e.dom,r=e.selection;if(lS(t))xw(e,!1,bo.fromDom(t),n);else{const e=r.getRng(),n=o.getParent(t,o.isBlock),s=e.startContainer,a=e.startOffset,i=e.endContainer,l=e.endOffset,d=mS(t);o.remove(t,!0),s===d&&a>0&&e.setStart(d,a-1),i===d&&l>0&&e.setEnd(d,l-1),n&&o.isEmpty(n)&&ua(bo.fromDom(n)),r.setRng(e)}},fS=(e,t,n=!0)=>{const o=e.dom,r=e.selection;if(t)uS(e,t,n);else if(!(t=mg(e.getBody(),r.getStart())))for(;t=o.get(sS);)uS(e,t,!1)},gS=(t,n,o)=>{const r=t.dom,s=r.getParent(o,e(Xg,t));s&&r.isEmpty(s)?o.parentNode.replaceChild(n,o):(ca(bo.fromDom(o)),r.isEmpty(o)?o.parentNode.replaceChild(n,o):r.insertAfter(n,o))},pS=(e,t)=>(e.appendChild(t),t),hS=(e,t)=>{const n=be(e,((e,t)=>pS(e,t.cloneNode(!1))),t);return pS(n,n.ownerDocument.createTextNode(rS))},bS=(e,t,n,o,r,s)=>{const a=e.formatter,i=e.dom,l=he(Le(a.get()),(e=>e!==o&&!wt(e,"removeformat"))),d=oS(e,n,l);if(he(d,(t=>!ip(e,t,o))).length>0){const e=n.cloneNode(!1);return i.add(t,e),a.remove(o,r,e,s),i.remove(e),re.some(e)}return re.none()},yS=(e,t,n)=>{let o,r;const s=e.selection,a=s.getRng();let i=a.startOffset;const l=a.startContainer.nodeValue;o=mg(e.getBody(),s.getStart()),o&&(r=dS(o));const d=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(l&&i>0&&i<l.length&&d.test(l.charAt(i))&&d.test(l.charAt(i-1))){const o=s.getBookmark();a.collapse(!0);let r=Rp(e,a,e.formatter.get(t));r=Db(r),e.formatter.apply(t,n,r),s.moveToBookmark(o)}else o&&r.nodeValue===rS||(o=aS(e.getDoc(),cS(!0).dom),r=o.firstChild,a.insertNode(o),i=1),e.formatter.apply(t,n,o),s.setCursorLocation(r,i)},vS=(e,t,n,o)=>{const r=e.dom,s=e.selection;let a,i,l;const d=[],c=s.getRng(),m=c.startContainer,u=c.startOffset;for(i=m,3===m.nodeType&&(u!==m.nodeValue.length&&(a=!0),i=i.parentNode);i;){if(Jk(e,i,t,n,o)){l=i;break}i.nextSibling&&(a=!0),d.push(i),i=i.parentNode}if(l)if(a){const r=s.getBookmark();c.collapse(!0);let a=Rp(e,c,e.formatter.get(t),!0);a=Db(a),e.formatter.remove(t,n,a,o),s.moveToBookmark(r)}else{const a=mg(e.getBody(),l),i=cS(!1).dom;gS(e,i,null!==a?a:l);const c=bS(e,i,l,t,n,o),m=hS(d.concat(c.toArray()),i);uS(e,a,!1),s.setCursorLocation(m,1),r.isEmpty(l)&&r.remove(l)}},CS=(e,t)=>{const n=e.selection,o=e.getBody();fS(e,null,!1),8!==t&&46!==t||!n.isCollapsed()||n.getStart().innerHTML!==rS||fS(e,mg(o,n.getStart())),37!==t&&39!==t||fS(e,mg(o,n.getStart()))},wS=e=>{e.on("mouseup keydown",(t=>{CS(e,t.keyCode)}))},xS=(e,t)=>{const n=cS(!1),o=hS(t,n.dom);return dr(bo.fromDom(e),n),br(bo.fromDom(e)),Xd(o,0)},kS=(e,t)=>{const n=e.schema.getTextInlineElements();return Ke(n,Pn(t))&&!cg(t.dom)&&!Yr(t.dom)},SS=e=>cg(e.dom)&&lS(e.dom),_S={},ES=tt,NS=Ze,RS=(e,t)=>{_S[e]||(_S[e]=[]),_S[e].push(t)},DS=(e,t)=>{NS(_S[e],(e=>{e(t)}))};RS("pre",(e=>{const t=e.selection.getRng();let n;const o=e=>s(e.previousSibling)&&-1!==nt(n,e.previousSibling),r=(e,t)=>{const n=bo.fromDom(t),o=Eo(n).dom;br(n),pr(bo.fromDom(e),[bo.fromTag("br",o),bo.fromTag("br",o),...Io(n)])},s=qr(["pre"]);t.collapsed||(n=e.selection.getSelectedBlocks(),NS(ES(ES(n,s),o),(e=>{r(e.previousSibling,e)})))}));const AS=kn.each,TS=e=>$r(e)&&!Bg(e)&&!cg(e)&&!Yr(e),OS=(e,t)=>{for(let n=e;n;n=n[t]){if(es(n)&&Rt(n.data))return e;if($r(n)&&!Bg(n))return n}return e},BS=(e,t,n)=>{const o=Uv(e);if(t&&n&&(t=OS(t,"previousSibling"),n=OS(n,"nextSibling"),o.compare(t,n))){for(let e=t.nextSibling;e&&e!==n;){const n=e;e=e.nextSibling,t.appendChild(n)}return e.remove(n),kn.each(kn.grep(n.childNodes),(e=>{t.appendChild(e)})),t}return n},PS=(e,t,n,o)=>{if(o&&!1!==t.merge_siblings){const t=BS(e,Yg(o),o);BS(e,t,Yg(t,!0))}},LS=(e,t,n)=>{if(t.clear_child_styles){const o=t.links?"*:not(a)":"*";AS(e.select(o,n),(n=>{TS(n)&&AS(t.styles,((t,o)=>{e.setStyle(n,o,"")}))}))}},MS=(e,t,n)=>{AS(e.childNodes,(e=>{TS(e)&&(t(e)&&n(e),e.hasChildNodes()&&MS(e,t,n))}))},IS=(e,t)=>{"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)},FS=(e,t)=>n=>!(!n||!op(e,n,t)),US=(e,t,n)=>o=>{e.setStyle(o,t,n),""===o.getAttribute("style")&&o.removeAttribute("style"),IS(e,o)},zS=Mc.generate([{keep:[]},{rename:["name"]},{removed:[]}]),jS=/^(src|href|style)$/,HS=kn.each,VS=tp,$S=e=>/^(TR|TH|TD)$/.test(e.nodeName),qS=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),WS=(e,t,n)=>{let o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"];if($r(o)){const e=o.childNodes.length-1;!n&&r&&r--,o=o.childNodes[r>e?e:r]}return es(o)&&n&&r>=o.nodeValue.length&&(o=new Ds(o,e.getBody()).next()||o),es(o)&&!n&&0===r&&(o=new Ds(o,e.getBody()).prev()||o),o},KS=(e,t)=>{const n=t?"firstChild":"lastChild";if($S(e)&&e[n]){const t=e[n];return"TR"===e.nodeName&&t[n]||t}return e},GS=(e,t,n,o)=>{const r=e.create(n,o);return t.parentNode.insertBefore(r,t),r.appendChild(t),r},YS=(e,t,n,o,r)=>{const s=bo.fromDom(t),a=bo.fromDom(e.create(o,r)),i=n?Mo(s):Lo(s);return pr(a,i),n?(dr(s,a),mr(a,s)):(cr(s,a),ur(a,s)),a.dom},XS=(e,t)=>t.links&&"A"===e.nodeName,QS=(e,t,n)=>{const o=t.parentNode;let r;const s=e.dom,a=lm(e);lp(n)&&o===s.getRoot()&&(n.list_block&&VS(t,n.list_block)||fe(Oe(t.childNodes),(t=>{Qg(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=GS(s,t,a),s.setAttribs(r,dm(e))):r=null}))),mp(n)&&!VS(n.inline,t)||s.remove(t,!0)},JS=(e,t,n,o,r)=>{let s;const a=e.dom;if(!Xk(a,o,t)&&!XS(o,t))return zS.keep();const i=o;if(cp(t)&&"all"===t.remove&&I(t.preserve_attributes)){const e=he(a.getAttribs(i),(e=>ce(t.preserve_attributes,e.name.toLowerCase())));if(a.removeAllAttribs(i),fe(e,(e=>a.setAttrib(i,e.name,e.value))),e.length>0)return zS.rename("span")}if("all"!==t.remove){HS(t.styles,((e,o)=>{e=np(ep(e,n),o+""),$(o)&&(o=e,r=null),(t.remove_similar||!r||VS(op(a,r,o),e))&&a.setStyle(i,o,""),s=!0})),s&&""===a.getAttrib(i,"style")&&(i.removeAttribute("style"),i.removeAttribute("data-mce-style")),HS(t.attributes,((e,o)=>{let s;if(e=ep(e,n),$(o)&&(o=e,r=null),t.remove_similar||!r||VS(a.getAttrib(r,o),e)){if("class"===o&&(e=a.getAttrib(i,o))&&(s="",fe(e.split(/\s+/),(e=>{/mce\-\w+/.test(e)&&(s+=(s?" ":"")+e)})),s))return void a.setAttrib(i,o,s);if(jS.test(o)&&i.removeAttribute("data-mce-"+o),"style"===o&&qr(["li"])(i)&&"none"===a.getStyle(i,"list-style-type"))return i.removeAttribute(o),void a.setStyle(i,"list-style-type","none");"class"===o&&i.removeAttribute("className"),i.removeAttribute(o)}})),HS(t.classes,(e=>{e=ep(e,n),r&&!a.hasClass(r,e)||a.removeClass(i,e)}));const e=a.getAttribs(i);for(let t=0;t<e.length;t++){const n=e[t].nodeName;if(0!==n.indexOf("_")&&0!==n.indexOf("data-"))return zS.keep()}}return"none"!==t.remove?(QS(e,i,t),zS.removed()):zS.keep()},ZS=(e,t,n,o,r)=>JS(e,t,n,o,r).fold(ne,(t=>(e.dom.rename(o,t),!0)),oe),e_=(e,t,n,o,r)=>{let s;return fe(sp(e.dom,t.parentNode).reverse(),(t=>{if(!s&&"_start"!==t.id&&"_end"!==t.id){const a=Jk(e,t,n,o,r);a&&!1!==a.split&&(s=t)}})),s},t_=(e,t,n,o)=>JS(e,t,n,o,o).fold(Y(o),(t=>(e.dom.createFragment().appendChild(o),e.dom.rename(o,t))),Y(null)),n_=(e,t,n,o,r,s,a,i)=>{let l,d,c;const m=e.dom;if(n){const u=n.parentNode;for(let n=o.parentNode;n&&n!==u;n=n.parentNode){l=m.clone(n,!1);for(let n=0;n<t.length&&(l=t_(e,t[n],i,l),null!==l);n++);l&&(d&&l.appendChild(d),c||(c=l),d=l)}!s||a.mixed&&m.isBlock(n)||(o=m.split(n,o)),d&&(r.parentNode.insertBefore(d,r),c.appendChild(r),cp(a)&&PS(m,a,i,d))}return o},o_=(e,t,n,o,r)=>{const s=e.formatter.get(t),a=s[0];let i=!0;const l=e.dom,d=e.selection,c=o=>{const i=e_(e,o,t,n,r);return n_(e,s,i,o,o,!0,a,n)},m=e=>Bg(e)&&$r(e)&&("_start"===e.id||"_end"===e.id),u=t=>me(s,(o=>ZS(e,o,n,t,t))),f=t=>{let n=!0,o=!1;$r(t)&&l.getContentEditable(t)&&(n=i,i="true"===l.getContentEditable(t),o=!0)
;const r=Oe(t.childNodes);if(i&&!o){const e=u(t)||me(s,(e=>Xk(l,t,e))),n=t.parentNode;!e&&H(n)&&up(a)&&u(n)}if(a.deep&&r.length){for(let e=0;e<r.length;e++)f(r[e]);o&&(i=n)}fe(["underline","line-through","overline"],(n=>{$r(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&rp(l,t.parentNode)===n&&ZS(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))},g=e=>{const t=l.get(e?"_start":"_end");let n=t[e?"firstChild":"lastChild"];return m(n)&&(n=n[e?"firstChild":"lastChild"]),es(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),l.remove(t,!0),n},p=t=>{let n,o,r=Rp(e,t,s,t.collapsed);if(a.split){if(r=Db(r),n=WS(e,r,!0),o=WS(e,r),n!==o){if(n=KS(n,!0),o=KS(o,!1),qS(l,n,o)){const e=re.from(n.firstChild).getOr(n);return c(YS(l,e,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void g(!0)}if(qS(l,o,n)){const e=re.from(o.lastChild).getOr(o);return c(YS(l,e,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void g(!1)}n=GS(l,n,"span",{id:"_start","data-mce-type":"bookmark"}),o=GS(l,o,"span",{id:"_end","data-mce-type":"bookmark"});const e=l.createRng();e.setStartAfter(n),e.setEndBefore(o),Dp(l,e,(e=>{fe(e,(e=>{Bg(e)||Bg(e.parentNode)||c(e)}))})),c(n),c(o),n=g(!0),o=g()}else n=o=c(n);r.startContainer=n.parentNode?n.parentNode:n,r.startOffset=l.nodeIndex(n),r.endContainer=o.parentNode?o.parentNode:o,r.endOffset=l.nodeIndex(o)+1}Dp(l,r,(e=>{fe(e,f)}))};if(o){if(Wg(o)){const e=l.createRng();e.setStartBefore(o),e.setEndAfter(o),p(e)}else p(o);yh(e,t,o,n)}else if("false"!==l.getContentEditable(d.getNode()))d.isCollapsed()&&cp(a)&&!Mp(e).length?vS(e,t,n,r):(Wp(d,!0,(()=>{qp(e,p)})),cp(a)&&Zk(e,t,n,d.getStart())&&Gg(l,d,d.getRng()),e.nodeChanged()),yh(e,t,o,n);else{o=d.getNode();for(let t=0;t<s.length&&(!s[t].ceFalseOverride||!ZS(e,s[t],n,o,o));t++);yh(e,t,o,n)}},r_=kn.each,s_=(e,t,n,o)=>{const r=t=>{if(1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType){const n=rp(e,t.parentNode);e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(kn.walk(o,r,"childNodes"),r(o))},a_=(e,t,n,o)=>{t.styles&&t.styles.backgroundColor&&MS(o,FS(e,"fontSize"),US(e,"backgroundColor",ep(t.styles.backgroundColor,n)))},i_=(e,t,n,o)=>{!cp(t)||"sub"!==t.inline&&"sup"!==t.inline||(MS(o,FS(e,"fontSize"),US(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",o),!0))},l_=(e,t,n,o)=>{r_(t,(t=>{cp(t)&&r_(e.dom.select(t.inline,o),(o=>{TS(o)&&ZS(e,t,n,o,t.exact?o:null)})),LS(e.dom,t,o)}))},d_=(e,t,n,o,r)=>{Jk(e,r.parentNode,n,o)&&ZS(e,t,o,r)||t.merge_with_parents&&e.dom.getParent(r.parentNode,(s=>{if(Jk(e,s,n,o))return ZS(e,t,o,r),!0}))},c_=kn.each,m_=e=>$r(e)&&!Bg(e)&&!cg(e)&&!Yr(e),u_=(e,t,n,o)=>{if(Km(e)&&cp(t)){const t=Vi(e.schema),r=Vk(bo.fromDom(n),(e=>cg(e.dom)));return Ge(t,o)&&ii(bo.fromDom(n.parentNode),!1)&&!r}return!1},f_=(e,t,n,o)=>{const r=e.formatter.get(t),s=r[0],a=!o&&e.selection.isCollapsed(),i=e.dom,l=e.selection,d=(e,t=s)=>{if(V(t.onformat)&&t.onformat(e,t,n,o),c_(t.styles,((t,o)=>{i.setStyle(e,o,ep(t,n))})),t.styles){const t=i.getAttrib(e,"style");t&&i.setAttrib(e,"data-mce-style",t)}c_(t.attributes,((t,o)=>{i.setAttrib(e,o,ep(t,n))})),c_(t.classes,(t=>{t=ep(t,n),i.hasClass(e,t)||i.addClass(e,t)}))},c=(e,t)=>{let n=!1;return c_(e,(e=>!!dp(e)&&(H(e.collapsed)&&e.collapsed!==a?void 0:i.is(t,e.selector)&&!cg(t)?(d(t,e),n=!0,!1):void 0))),n},m=e=>{if(P(e)){const t=i.create(e);return d(t),t}return null},u=(o,a,i)=>{const l=[];let u=!0;const f=s.inline||s.block,g=m(f);Dp(o,a,(a=>{let m;const p=a=>{let h=!1,b=u;const y=a.nodeName.toLowerCase(),v=a.parentNode,C=v.nodeName.toLowerCase();if($r(a)&&o.getContentEditable(a)&&(b=u,u="true"===o.getContentEditable(a),h=!0),as(a)&&!u_(e,s,a,C))return m=null,void(lp(s)&&o.remove(a));if(lp(s)&&s.wrapper&&Jk(e,a,t,n))m=null;else{if(u&&!h&&lp(s)&&!s.wrapper&&Xg(e,y)&&Qg(e,C,f)){const e=o.rename(a,f);return d(e),l.push(e),void(m=null)}if(dp(s)){let e=c(r,a);if(!e&&H(v)&&up(s)&&(e=c(r,v)),!cp(s)||e)return void(m=null)}!u||h||!Qg(e,f,y)||!Qg(e,C,f)||!i&&es(a)&&pa(a.data)||cg(a)||cp(s)&&o.isBlock(a)?(m=null,fe(Oe(a.childNodes),p),h&&(u=b),m=null):(m||(m=o.clone(g,!1),a.parentNode.insertBefore(m,a),l.push(m)),m.appendChild(a))}};fe(a,p)})),!0===s.links&&fe(l,(e=>{const t=e=>{"A"===e.nodeName&&d(e,s),fe(Oe(e.childNodes),t)};t(e)})),fe(l,(a=>{const i=e=>{let t=0;return fe(e.childNodes,(e=>{Zg(e)||Bg(e)||t++})),t},c=e=>{const t=Ce(e.childNodes,m_).filter((e=>Xk(o,e,s)));return t.map((t=>{const n=o.clone(t,!1);return d(n),o.replace(n,e,!0),o.remove(t,!0),n})).getOr(e)},m=i(a);!(l.length>1)&&o.isBlock(a)||0!==m?(cp(s)||lp(s)&&s.wrapper)&&(s.exact||1!==m||(a=c(a)),l_(e,r,n,a),d_(e,s,t,n,a),a_(o,s,n,a),s_(o,s,n,a),i_(o,s,n,a),PS(o,s,n,a)):o.remove(a,!0)}))};if("false"!==i.getContentEditable(l.getNode())){if(s){if(o)if(Wg(o)){if(!c(r,o)){const t=i.createRng();t.setStartBefore(o),t.setEndAfter(o),u(i,Rp(e,t,r),!0)}}else u(i,o,!0);else a&&cp(s)&&!Mp(e).length?yS(e,t,n):(l.setRng(tk(l.getRng())),Wp(l,!0,(()=>{qp(e,((t,n)=>{const o=n?t:Rp(e,t,r);u(i,o,!1)}))})),Gg(i,l,l.getRng()),e.nodeChanged());DS(t,e)}bh(e,t,o,n)}else{o=l.getNode();for(let e=0,t=r.length;e<t;e++){const t=r[e];if(t.ceFalseOverride&&dp(t)&&i.is(o,t.selector)){d(o,t);break}}bh(e,t,o,n)}},g_=e=>Ke(e,"vars"),p_=(e,t)=>{e.set({}),t.on("NodeChange",(n=>{v_(t,n.element,e.get())})),t.on("FormatApply FormatRemove",(n=>{const o=re.from(n.node).map((e=>Wg(e)?e:e.startContainer)).bind((e=>$r(e)?re.some(e):re.from(e.parentElement))).getOrThunk((()=>h_(t)));v_(t,o,e.get())}))},h_=e=>e.selection.getStart(),b_=(e,t,n,o,r)=>ve(t,(t=>{const s=e.formatter.matchNode(t,n,null!=r?r:{},o);return!z(s)}),(t=>!!Gk(e,t,n)||!o&&H(e.formatter.matchNode(t,n,r,!0)))),y_=(e,t)=>{const n=null!=t?t:h_(e);return he(sp(e.dom,n),(e=>$r(e)&&!Yr(e)))},v_=(e,t,n)=>{const o=y_(e,t);Ie(n,((n,r)=>{const s=n=>{const s=b_(e,o,r,n.similar,g_(n)?n.vars:void 0),a=s.isSome();if(n.state.get()!==a){n.state.set(a);const e=s.getOr(t);g_(n)?n.callback(a,{node:e,format:r,parents:o}):fe(n.callbacks,(t=>t(a,{node:e,format:r,parents:o})))}};fe([n.withSimilar,n.withoutSimilar],s),fe(n.withVars,s)}))},C_=(e,t,n,o,r,s)=>{const a=t.get();fe(n.split(","),(t=>{const n=We(a,t).getOrThunk((()=>{const e={withSimilar:{state:Sl(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Sl(!1),similar:!1,callbacks:[]},withVars:[]};return a[t]=e,e})),i=()=>{const n=y_(e);return b_(e,n,t,r,s).isSome()};if(z(s)){const e=r?n.withSimilar:n.withoutSimilar;e.callbacks.push(o),1===e.callbacks.length&&e.state.set(i())}else n.withVars.push({state:Sl(i()),similar:r,vars:s,callback:o})})),t.set(a)},w_=(e,t,n)=>{const o=e.get();fe(t.split(","),(e=>We(o,e).each((t=>{o[e]={withSimilar:{...t.withSimilar,callbacks:he(t.withSimilar.callbacks,(e=>e!==n))},withoutSimilar:{...t.withoutSimilar,callbacks:he(t.withoutSimilar.callbacks,(e=>e!==n))},withVars:he(t.withVars,(e=>e.callback!==n))}})))),e.set(o)},x_=(e,t,n,o,r,s)=>(null===t.get()&&p_(t,e),C_(e,t,n,o,r,s),{unbind:()=>w_(t,n,o)}),k_=(e,t,n,o)=>{const r=e.formatter.get(t);!Zk(e,t,n,o)||"toggle"in r[0]&&!r[0].toggle?f_(e,t,n,o):o_(e,t,n,o)};var S_=Object.hasOwnProperty,__=Object.setPrototypeOf,E_=Object.isFrozen,N_=Object.getPrototypeOf,R_=Object.getOwnPropertyDescriptor,D_=Object.freeze,A_=Object.seal,T_=Object.create,O_="undefined"!=typeof Reflect&&Reflect,B_=O_.apply,P_=O_.construct;B_||(B_=function(e,t,n){return e.apply(t,n)}),D_||(D_=function(e){return e}),A_||(A_=function(e){return e}),P_||(P_=function(e,t){return r(e,s(t))});var L_=m(Array.prototype.forEach),M_=m(Array.prototype.pop),I_=m(Array.prototype.push),F_=m(String.prototype.toLowerCase),U_=m(String.prototype.match),z_=m(String.prototype.replace),j_=m(String.prototype.indexOf),H_=m(String.prototype.trim),V_=m(RegExp.prototype.test),$_=u(TypeError),q_=D_(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),W_=D_(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),K_=D_(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),G_=D_(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Y_=D_(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),X_=D_(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Q_=D_(["#text"]),J_=D_(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Z_=D_(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eE=D_(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),tE=D_(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nE=A_(/\{\{[\w\W]*|[\w\W]*\}\}/gm),oE=A_(/<%[\w\W]*|[\w\W]*%>/gm),rE=A_(/^data-[\-\w.\u00B7-\uFFFF]/),sE=A_(/^aria-[\-\w]+$/),aE=A_(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),iE=A_(/^(?:\w+script|data):/i),lE=A_(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),dE=A_(/^html$/i),cE=function(){return"undefined"==typeof window?null:window},mE=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var o=null,r="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(r)&&(o=n.currentScript.getAttribute(r));var s="dompurify"+(o?"#"+o:"");try{return e.createPolicy(s,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+s+" could not be created."),null}},uE=h();const fE=kn.explode,gE=()=>{const e={},t=(t,n)=>{fe(fE(t),(t=>{Ke(e,t)||(e[t]={name:t,callbacks:[]}),e[t].callbacks.push(n)}))},n=(t,n)=>{fe(fE(t),(t=>{if(Ke(e,t))if(H(n)){const o=e[t],r=he(o.callbacks,(e=>e!==n));r.length>0?o.callbacks=r:delete e[t]}else delete e[t]}))};return{addFilter:t,getFilters:()=>qe(e),removeFilter:n}},pE=(e,t)=>{fe(t,(t=>{e.attr(t,null)}))},hE=(e,t,n)=>{e.addNodeFilter("font",(e=>{fe(e,(e=>{const o=t.parse(e.attr("style")),r=e.attr("color"),s=e.attr("face"),a=e.attr("size");r&&(o.color=r),s&&(o["font-family"]=s),a&&(o["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(o)),pE(e,["color","face","size"])}))}))},bE=(e,t,n)=>{e.addNodeFilter("strike",(e=>{const o="html4"!==t.type;fe(e,(e=>{if(o)e.name="s";else{const t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))}}))}))},yE=(e,t,n)=>{const o=Ki();t.convert_fonts_to_spans&&hE(e,o,kn.explode(t.font_size_legacy_values)),bE(e,n,o)},vE=(e,t,n)=>{t.inline_styles&&yE(e,t,n)},CE=e=>fetch(e).then((e=>e.ok?e.blob():Promise.reject())).catch((()=>Promise.reject(`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`))),wE=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},xE=e=>{const[t,...n]=e.split(","),o=n.join(","),r=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(r){const e=";base64"===r[2],t=e?wE(o):decodeURIComponent(o);return re.some({type:r[1],data:t,base64Encoded:e})}return re.none()},kE=(e,t,n=!0)=>{let o=t;if(n)try{o=atob(t)}catch(e){return re.none()}const r=new Uint8Array(o.length);for(let e=0;e<r.length;e++)r[e]=o.charCodeAt(e);return re.some(new Blob([r],{type:e}))},SE=e=>new Promise(((t,n)=>{xE(e).bind((({type:e,data:t,base64Encoded:n})=>kE(e,t,n))).fold((()=>n("Invalid data URI")),t)})),_E=e=>xt(e,"blob:")?CE(e):xt(e,"data:")?SE(e):Promise.reject("Unknown URI format"),EE=e=>new Promise(((t,n)=>{const o=new FileReader;o.onloadend=()=>{t(o.result)},o.onerror=()=>{n(o.error.message)},o.readAsDataURL(e)}));let NE=0;const RE=e=>(e||"blobid")+NE++,DE=(e,t,n)=>xE(e).bind((({data:e,type:o,base64Encoded:r})=>{if(t&&!r)return re.none();{const t=r?e:btoa(e);return n(t,o)}})),AE=(e,t,n)=>{const o=e.create(RE(),t,n);return e.add(o),o},TE=(e,t,n=!1)=>DE(t,n,((t,n)=>re.from(e.getByData(t,n)).orThunk((()=>kE(n,t).map((n=>AE(e,n,t))))))),OE=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(xt(t,"blob:")){const o=e.getByUri(t);return H(o)?Promise.resolve(o):_E(t).then((t=>EE(t).then((o=>DE(o,!1,(n=>re.some(AE(e,t,n)))).getOrThunk(n)))))}return xt(t,"data:")?TE(e,t).fold(n,(e=>Promise.resolve(e))):Promise.reject("Unknown image data format")},BE=e=>H(e.attr("data-mce-bogus")),PE=e=>e.attr("src")===pn.transparentSrc||H(e.attr("data-mce-placeholder")),LE=(e,t)=>{const{blob_cache:n}=t,o=e=>{const t=e.attr("src");PE(e)||BE(e)||TE(n,t,!0).each((t=>{e.attr("src",t.blobUri())}))};n&&e.addAttributeFilter("src",(e=>fe(e,o)))},ME=(e,t)=>{const n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",((e,o,r)=>{const s=kn.extend({},n.getBlockElements()),a=n.getNonEmptyElements(),i=n.getWhitespaceElements();s.body=1;for(let o=0,l=e.length;o<l;o++){let l=e[o],d=l.parent;if(s[l.parent.name]&&l===d.lastChild){let e=l.prev;for(;e;){const t=e.name;if("span"!==t||"bookmark"!==e.attr("data-mce-type")){"br"===t&&(l=null);break}e=e.prev}if(l&&(l.remove(),Yx(n,a,i,d))){const e=n.getElementRule(d.name);e&&(e.removeEmpty?d.remove():e.paddEmpty&&qx(t,r,s,d))}}else{let e=l;for(;d&&d.firstChild===e&&d.lastChild===e&&(e=d,!s[d.name]);)d=d.parent;if(e===d){const e=new Rv("#text",3);e.value=ea,l.replace(e)}}}})),e.addAttributeFilter("href",(e=>{let n=e.length;const o=e=>e.split(" ").filter((e=>e.length>0)).concat(["noopener"]).sort().join(" "),r=e=>{const t=e?kn.trim(e):"";return/\b(noopener)\b/g.test(t)?t:o(t)};if(!t.allow_unsafe_link_target)for(;n--;){const t=e[n];"a"===t.name&&"_blank"===t.attr("target")&&t.attr("rel",r(t.attr("rel")))}})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(e=>{let t,n,o,r,s=e.length;for(;s--;)if(r=e[s],"a"===r.name&&r.firstChild&&!r.attr("href")){o=r.parent,t=r.lastChild;do{n=t.prev,o.insert(t,r),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(e=>{let t,n,o=e.length;for(;o--;)if(t=e[o],n=t.parent,"ul"===n.name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{const e=new Rv("li",1);e.attr("style","list-style-type: none"),t.wrap(e)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(e=>{const t=n.getValidClasses();let o=e.length;for(;o--;){const n=e[o],r=n.attr("class").split(" ");let s="";for(let e=0;e<r.length;e++){const o=r[e];let a=!1,i=t["*"];i&&i[o]&&(a=!0),i=t[n.name],!a&&i&&i[o]&&(a=!0),a&&(s&&(s+=" "),s+=o)}s.length||(s=null),n.attr("class",s)}})),LE(e,t)},IE=kn.each,FE=kn.trim,UE="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),zE={ftp:21,http:80,https:443,mailto:25},jE=["img","video"],HE=(e,t)=>H(e)?!e:!H(t)||!ce(jE,t),VE=e=>{try{return decodeURIComponent(e)}catch(t){return unescape(e)}},$E=(e,t,n)=>{const o=VE(t);return!e.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(o)||!e.allow_html_data_urls&&(/^data:image\//i.test(o)?HE(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(o):/^data:/i.test(o)))};class qE{constructor(e,t){e=FE(e),this.settings=t||{};const n=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))return void(o.source=e);const r=0===e.indexOf("//");if(0!==e.indexOf("/")||r||(e=(n&&n.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){const t=this.settings.base_uri?this.settings.base_uri.path:new qE(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)e="//mce_host"+o.toAbsPath(t,e);else{const r=/([^#?]*)([#?]?.*)/.exec(e);e=(n&&n.protocol||"http")+"://mce_host"+o.toAbsPath(t,r[1])+r[2]}}e=e.replace(/@@/g,"(mce_at)");const s=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);IE(UE,((e,t)=>{let n=s[t];n&&(n=n.replace(/\(mce_at\)/g,"@@")),o[e]=n})),n&&(o.protocol||(o.protocol=n.protocol),o.userInfo||(o.userInfo=n.userInfo),o.port||"mce_host"!==o.host||(o.port=n.port),o.host&&"mce_host"!==o.host||(o.host=n.host),o.source=""),r&&(o.protocol="")}static parseDataUri(e){let t;const n=decodeURIComponent(e).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(t=o[1]),{type:t,data:n[1]}}static isDomSafe(e,t,n={}){if(n.allow_script_urls)return!0;{const o=Bi.decode(e).replace(/[\s\u0000-\u001F]+/g,"");return!$E(n,o,t)}}static getDocumentBaseUrl(e){let t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t}setPath(e){const t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()}toRelative(e){let t;if("./"===e)return e;const n=new qE(e,{base_uri:this});if("mce_host"!==n.host&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&""!==n.protocol)return n.getURI();const o=this.getURI(),r=n.getURI();return o===r||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===r?o:(t=this.toRelPath(this.path,n.path),n.query&&(t+="?"+n.query),n.anchor&&(t+="#"+n.anchor),t)}toAbsolute(e,t){const n=new qE(e,{base_uri:this});return n.getURI(t&&this.isSameOrigin(n))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;const t=zE[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1}toRelPath(e,t){let n,o,r=0,s="";const a=e.substring(0,e.lastIndexOf("/")).split("/"),i=t.split("/");if(a.length>=i.length)for(n=0,o=a.length;n<o;n++)if(n>=i.length||a[n]!==i[n]){r=n+1;break}if(a.length<i.length)for(n=0,o=i.length;n<o;n++)if(n>=a.length||a[n]!==i[n]){r=n+1;break}if(1===r)return t;for(n=0,o=a.length-(r-1);n<o;n++)s+="../";for(n=r-1,o=i.length;n<o;n++)s+=n!==r-1?"/"+i[n]:i[n];return s}toAbsPath(e,t){let n,o,r=0,s=[];const a=/\/$/.test(t)?"/":"";let i=e.split("/");const l=t.split("/");for(IE(i,(e=>{e&&s.push(e)})),i=s,n=l.length-1,s=[];n>=0;n--)0!==l[n].length&&"."!==l[n]&&(".."!==l[n]?r>0?r--:s.push(l[n]):r++);return n=i.length-r,o=n<=0?_e(s).join("/"):i.slice(0,n).join("/")+"/"+_e(s).join("/"),0!==o.indexOf("/")&&(o="/"+o),a&&o.lastIndexOf("/")!==o.length-1&&(o+=a),o}getURI(e=!1){let t;return this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source}}const WE=kn.makeMap,KE=kn.extend,GE={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]},YE=kn.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),XE="data-mce-type",QE=(e,t)=>{const n={...GE};return n.PARSER_MEDIA_TYPE=t,e.allow_script_urls?n.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(n.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),n},JE=(e,t)=>{const n=uE(),o=t.getSpecialElements(),r=e.validate;let s=0;return n.addHook("uponSanitizeElement",((n,a)=>{var i,l;n.nodeType===Dn&&!e.allow_conditional_comments&&/^\[if/i.test(n.nodeValue)&&(n.nodeValue=" "+n.nodeValue);const d=a.tagName;if(n.nodeType!==On||"body"===d)return;const c=bo.fromDom(n),m=d.toLowerCase(),u=Gn(c,XE),f=Wn(c,"data-mce-bogus");if(!u&&P(f))return void("all"===f?br(c):yr(c));const g=t.getElementRule(m);if(!r||g){if(a.allowedTags[d]=!0,r&&!u){if(fe(null!==(i=g.attributesForced)&&void 0!==i?i:[],(e=>{$n(c,e.name,"{$uid}"===e.value?"mce_"+s++:e.value)})),fe(null!==(l=g.attributesDefault)&&void 0!==l?l:[],(e=>{Gn(c,e.name)||$n(c,e.name,"{$uid}"===e.value?"mce_"+s++:e.value)})),g.attributesRequired&&!me(g.attributesRequired,(e=>Gn(c,e))))return void yr(c);if(g.removeEmptyAttrs&&Xn(c))return void yr(c);g.outputName&&g.outputName!==m&&ld(c,g.outputName)}}else Ke(o,m)?br(c):yr(c)})),n.addHook("uponSanitizeAttribute",((n,o)=>{const s=n.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=!r||t.isValid(s,a)||xt(a,"data-")||xt(a,"aria-"),a in YE&&$E(e,i,s)&&(o.keepAttr=!1),o.keepAttr?(o.allowedAttributes[a]=!0,a in t.getBoolAttrs()&&(o.attrValue=a),e.allow_svg_data_urls&&xt(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):!n.hasAttribute(XE)||"id"!==a&&"class"!==a&&"style"!==a||(o.forceKeepAttr=!0)})),n},ZE=(e,t,n)=>{const o=e.name,r=o in n&&"title"!==o&&"textarea"!==o,s=t.childNodes;for(let t=0,o=s.length;t<o;t++){const o=s[t],a=new Rv(o.nodeName.toLowerCase(),o.nodeType);if($r(o)){const e=o.attributes;for(let t=0,n=e.length;t<n;t++){const n=e[t];a.attr(n.name,n.value)}}else es(o)?(a.value=o.data,r&&(a.raw=!0)):(os(o)||ts(o)||ns(o))&&(a.value=o.data);ZE(a,o,n),e.append(a)}},eN=(e,t,n)=>{const o=[];for(let n=e,r=n;H(n);r=n,n=n.walk())fe(t,(e=>e(n))),j(n.parent)&&n!==e?n=r:o.push(n);for(let e=o.length-1;e>=0;e--){const t=o[e];fe(n,(e=>e(t)))}},tN=(e,t,n,o)=>{const r=n.validate,s=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=KE(WE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=Vi(t),d=/[ \t\r\n]+/g,c=/^[ \t\r\n]+/,m=/[ \t\r\n]+$/,u=e=>{for(e=e.parent;H(e);){if(e.name in a)return!0;e=e.parent}return!1},f=e=>{let n=e;for(;H(n);){if(n.name in l)return Yx(t,s,a,n);n=n.parent}return!1},g=(t,n)=>{const r=n?t.prev:t.next;return!H(r)&&(t.parent.name in i&&(t.parent!==e||o.isRootContent))},p=e=>{if(3===e.type&&!u(e)){let t=e.value;t=t.replace(d," "),(Xx(e.prev,i)||g(e,!0))&&(t=t.replace(c,"")),0===t.length?e.remove():e.value=t}},h=e=>{var l;if(1===e.type){const l=t.getElementRule(e.name);if(r&&l){const r=Yx(t,s,a,e);l.paddInEmptyBlock&&r&&f(e)?qx(n,o,i,e):l.removeEmpty&&r?i[e.name]?e.remove():e.unwrap():l.paddEmpty&&(r||Wx(e))&&qx(n,o,i,e)}}else if(3===e.type&&!u(e)){let t=e.value;(i[null===(l=e.next)||void 0===l?void 0:l.name]||g(e,!1))&&(t=t.replace(m,"")),0===t.length?e.remove():e.value=t}};return[p,h]},nN=(e,t)=>{var n;const o=null!==(n=t.forced_root_block)&&void 0!==n?n:e.forced_root_block;return!1===o?"":!0===o?"p":o},oN=(e={},t=Wi())=>{const n=gE(),o=gE(),r={validate:!0,root_name:"body",...e},s=new DOMParser,a=JE(r,t),i=(e,n,o="html")=>{const i="xhtml"===o?"application/xhtml+xml":"text/html",l=Ke(t.getSpecialElements(),n.toLowerCase()),d=l?`<${n}>${e}</${n}>`:e,c="xhtml"===o?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${d}</body></html>`:`<body>${d}</body>`,m=s.parseFromString(c,i).body;return a.sanitize(m,QE(r,i)),a.removed=[],l?m.firstChild:m},l=n.addFilter,d=n.getFilters,c=n.removeFilter,m=o.addFilter,u=o.getFilters,f=o.removeFilter,g=(e,n)=>{const o=e.parent;o&&t.children[e.name]&&!t.isValidChild(o.name,e.name)&&n.push(e)},p=(e,n)=>{const o=KE(WE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),s=/^[ \t\r\n]+/,a=/[ \t\r\n]+$/;let i=e.firstChild,l=null;const d=e=>{e&&(i=e.firstChild,i&&3===i.type&&(i.value=i.value.replace(s,"")),i=e.lastChild,i&&3===i.type&&(i.value=i.value.replace(a,"")))};if(t.isValidChild(e.name,n.toLowerCase())){for(;i;){const t=i.next;3===i.type||1===i.type&&"p"!==i.name&&!o[i.name]&&!i.attr(XE)?(l||(l=new Rv(n,1),l.attr(r.forced_root_block_attrs),e.insert(l,i)),l.append(i)):(d(l),l=null),i=t}d(l)}},h=(e,n={})=>{var o;const s=r.validate,a=null!==(o=n.context)&&void 0!==o?o:r.root_name,l=i(e,a,n.format),c=new Rv(a,11);ZE(c,l,t.getSpecialElements());const[m,f]=tN(c,t,r,n),h=[],b={nodes:{},attributes:{}},y=e=>jx(d(),u(),e,b);if(eN(c,[m,y],[f,s?e=>g(e,h):W]),h.reverse(),s&&h.length>0)if(n.context){const{pass:e,fail:o}=pe(h,(e=>e.parent===c));Jx(o,t,y),n.invalid=e.length>0}else Jx(h,t,y);const v=nN(r,n);return v&&("body"===c.name||n.isRootContent)&&p(c,v),n.invalid||Vx(b,n),c},b={schema:t,addAttributeFilter:m,getAttributeFilters:u,removeAttributeFilter:f,addNodeFilter:l,getNodeFilters:d,removeNodeFilter:c,parse:h};return ME(b,r),vE(b,r,t),b},rN=e=>Ik(e)?Hv({validate:!1}).serialize(e):e,sN=(e,t)=>{const n=rN(e),o=t(n);if(o.isDefaultPrevented())return o;if(Ik(e)){if(o.content!==n){const t=oN({validate:!1,forced_root_block:!1}).parse(o.content,{context:e.name});return{...o,content:t}}return{...o,content:e}}return o},aN=(e,t)=>{if(t.no_events)return Pc.value(t);{const n=wh(e,t);return n.isDefaultPrevented()?Pc.error(xh(e,{content:"",...n}).content):Pc.value(n)}},iN=(e,t,n)=>{if(n.no_events)return t;return sN(t,(t=>xh(e,{...n,content:t}))).content},lN=(e,t)=>{if(t.no_events)return Pc.value(t);{const n=sN(t.content,(n=>vh(e,{...t,content:n})));return n.isDefaultPrevented()?(Ch(e,n),Pc.error(void 0)):Pc.value(n)}},dN=(e,t,n)=>{n.no_events||Ch(e,{...n,content:t})},cN=(e,t,n)=>({element:e,width:t,rows:n}),mN=(e,t)=>({element:e,cells:t}),uN=(e,t)=>({x:e,y:t}),fN=(e,t)=>{const n=parseInt(Wn(e,t),10);return isNaN(n)?1:n},gN=(e,t,n,o,r)=>{const s=fN(r,"rowspan"),a=fN(r,"colspan"),i=e.rows;for(let e=n;e<n+s;e++){i[e]||(i[e]=mN(ad(o),[]));for(let o=t;o<t+a;o++){i[e].cells[o]=e===n&&o===t?r:sd(r)}}},pN=(e,t,n)=>{const o=e.rows;return!!(o[n]?o[n].cells:[])[t]},hN=(e,t,n)=>{for(;pN(e,t,n);)t++;return t},bN=e=>ye(e,((e,t)=>t.cells.length>e?t.cells.length:e),0),yN=(e,t)=>{const n=e.rows;for(let e=0;e<n.length;e++){const o=n[e].cells;for(let n=0;n<o.length;n++)if(ko(o[n],t))return re.some(uN(n,e))}return re.none()},vN=(e,t,n,o,r)=>{const s=[],a=e.rows;for(let e=n;e<=r;e++){const n=a[e].cells,r=t<o?n.slice(t,o+1):n.slice(o,t+1);s.push(mN(a[e].element,r))}return s},CN=(e,t,n)=>{const o=t.x,r=t.y,s=n.x,a=n.y,i=r<a?vN(e,o,r,s,a):vN(e,o,a,s,r);return cN(e.element,bN(i),i)},wN=(e,t)=>{const n=sd(e.element),o=bo.fromTag("tbody");return pr(o,t),ur(n,o),n},xN=e=>ue(e.rows,(e=>{const t=ue(e.cells,(e=>{const t=ad(e);return Yn(t,"colspan"),Yn(t,"rowspan"),t})),n=sd(e.element);return pr(n,t),n})),kN=e=>{const t=cN(sd(e),0,[]);return fe(ra(e,"tr"),((e,n)=>{fe(ra(e,"td,th"),((o,r)=>{gN(t,hN(t,r,n),n,e,o)}))})),cN(t.element,bN(t.rows),t.rows)},SN=e=>wN(e,xN(e)),_N=(e,t,n)=>yN(e,t).bind((t=>yN(e,n).map((n=>CN(e,t,n))))),EN=e=>Ce(e,(e=>"ul"===Pn(e)||"ol"===Pn(e))),NN=(e,t)=>Ce(e,(e=>"li"===Pn(e)&&Hp(e,t))).fold(Y([]),(()=>EN(e).map((e=>{const t=bo.fromTag(Pn(e)),n=Ve(ar(e),((e,t)=>xt(t,"list-style")));return nr(t,n),[bo.fromTag("li"),t]})).getOr([]))),RN=(e,t)=>{const n=ye(t,((e,t)=>(ur(t,e),t)),e);return t.length>0?mb([n]):n},DN=e=>Ws(e)?Do(e).filter(qs).fold(Y([]),(t=>[e,t])):qs(e)?[e]:[],AN=(e,t)=>{const n=bo.fromDom(t.commonAncestorContainer),o=gC(n,e),r=he(o,Qs),s=NN(o,t),a=r.concat(s.length?s:DN(n));return ue(a,sd)},TN=()=>mb([]),ON=(e,t)=>RN(bo.fromDom(t.cloneContents()),AN(e,t)),BN=(t,n)=>ks(n,"table",e(ko,t)),PN=(e,t)=>BN(e,t[0]).bind((e=>{const n=t[0],o=t[t.length-1],r=kN(e);return _N(r,n,o).map((e=>mb([SN(e)])))})).getOrThunk(TN),LN=(e,t)=>t.length>0&&t[0].collapsed?TN():ON(e,t[0]),MN=(e,t)=>{const n=Lp(t,e);return n.length>0?PN(e,n):LN(e,t)},IN=(e,t)=>t>=0&&t<e.length&&Lg(e.charAt(t)),FN=e=>ha(e.innerText),UN=e=>e.map((e=>e.nodeName)).getOr("div").toLowerCase(),zN=e=>re.from(e.selection.getRng()).map((t=>{const n=re.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=UN(n),s=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},t.cloneContents()),a=FN(s),i=ha(s.textContent);if(e.dom.remove(s),IN(i,0)||IN(i,i.length-1)){const e=n.getOr(o),t=FN(e),r=t.indexOf(a);if(-1===r)return a;return(IN(t,r-1)?" ":"")+a+(IN(t,r+a.length)?" ":"")}return a})).getOr(""),jN=(e,t)=>{
const n=e.selection.getRng(),o=e.dom.create("body"),r=e.selection.getSel(),s=mv(e,Ap(r)),a=t.contextual?MN(bo.fromDom(e.getBody()),s).dom:n.cloneContents();return a&&o.appendChild(a),e.selection.serializer.serialize(o,t)},HN=(e,t)=>{if("text"===t.format)return zN(e);{const n=jN(e,t);return"tree"===t.format?n:e.selection.isCollapsed()?"":n}},VN=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),$N=(e,t,n={})=>{const o=VN(n,t);return aN(e,o).fold(X,(t=>{const n=HN(e,t);return iN(e,n,t)}))},qN=0,WN=1,KN=2,GN=(e,t)=>{const n=e.length+t.length+2,o=new Array(n),r=new Array(n),s=(e,t,n)=>({start:e,end:t,diag:n}),a=(n,o,r,s,i)=>{const d=l(n,o,r,s);if(null===d||d.start===o&&d.diag===o-s||d.end===n&&d.diag===n-r){let a=n,l=r;for(;a<o||l<s;)a<o&&l<s&&e[a]===t[l]?(i.push([qN,e[a]]),++a,++l):o-n>s-r?(i.push([KN,e[a]]),++a):(i.push([WN,t[l]]),++l)}else{a(n,d.start,r,d.start-d.diag,i);for(let t=d.start;t<d.end;++t)i.push([qN,e[t]]);a(d.end,o,d.end-d.diag,s,i)}},i=(n,o,r,a)=>{let i=n;for(;i-o<a&&i<r&&e[i]===t[i-o];)++i;return s(n,i,o)},l=(n,s,a,l)=>{const d=s-n,c=l-a;if(0===d||0===c)return null;const m=d-c,u=c+d,f=(u%2==0?u:u+1)/2;let g,p,h,b,y;for(o[1+f]=n,r[1+f]=s+1,g=0;g<=f;++g){for(p=-g;p<=g;p+=2){for(h=p+f,p===-g||p!==g&&o[h-1]<o[h+1]?o[h]=o[h+1]:o[h]=o[h-1]+1,b=o[h],y=b-n+a-p;b<s&&y<l&&e[b]===t[y];)o[h]=++b,++y;if(m%2!=0&&m-g<=p&&p<=m+g&&r[h-m]<=o[h])return i(r[h-m],p+n-a,s,l)}for(p=m-g;p<=m+g;p+=2){for(h=p+f-m,p===m-g||p!==m+g&&r[h+1]<=r[h-1]?r[h]=r[h+1]-1:r[h]=r[h-1],b=r[h]-1,y=b-n+a-p;b>=n&&y>=a&&e[b]===t[y];)r[h]=b--,y--;if(m%2==0&&-g<=p&&p<=g&&r[h]<=o[h+m])return i(r[h],p+n-a,s,l)}}},d=[];return a(0,e.length,0,t.length,d),d},YN=e=>$r(e)?e.outerHTML:es(e)?Bi.encodeRaw(e.data,!1):os(e)?"<!--"+e.data+"-->":"",XN=e=>{let t;const n=document.createElement("div"),o=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)o.appendChild(t);return o},QN=(e,t,n)=>{const o=XN(t);if(e.hasChildNodes()&&n<e.childNodes.length){const t=e.childNodes[n];t.parentNode.insertBefore(o,t)}else e.appendChild(o)},JN=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];n.parentNode.removeChild(n)}},ZN=(e,t)=>{let n=0;fe(e,(e=>{e[0]===qN?n++:e[0]===WN?(QN(t,e[1],n),n++):e[0]===KN&&JN(t,n)}))},eR=e=>he(ue(Oe(e.childNodes),YN),(e=>e.length>0)),tR=(e,t)=>{const n=ue(Oe(t.childNodes),YN);return ZN(GN(n,e),t),t},nR=at((()=>document.implementation.createHTMLDocument("undo"))),oR=e=>-1!==e.indexOf("</iframe>"),rR=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),sR=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),aR=e=>{const t=eR(e.getBody()),n=ke(t,(t=>{const n=Bv(e.serializer,t);return n.length>0?[n]:[]})),o=n.join("");return oR(o)?rR(n):sR(o)},iR=(e,t,n)=>{const o=n?t.beforeBookmark:t.bookmark;"fragmented"===t.type?tR(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:!H(o)||!hg(o)||!o.isFakeCaret}),e.selection.moveToBookmark(o)},lR=e=>"fragmented"===e.type?e.fragments.join(""):e.content,dR=e=>{const t=bo.fromTag("body",nR());return xr(t,lR(e)),fe(ra(t,"*[data-mce-bogus]"),yr),wr(t)},cR=(e,t)=>lR(e)===lR(t),mR=(e,t)=>dR(e)===dR(t),uR=(e,t)=>!(!e||!t)&&(!!cR(e,t)||mR(e,t)),fR=e=>0===e.get(),gR=(e,t,n)=>{fR(n)&&(e.typing=t)},pR=(e,t)=>{e.typing&&(gR(e,!1,t),e.add())},hR=e=>{e.typing&&(e.typing=!1,e.add())},bR=(e,t,n)=>{fR(t)&&n.set(Ac(e.selection))},yR=(e,t,n,o,r,s,a)=>{const i=aR(e);if(s=s||{},s=kn.extend(s,i),!1===fR(o)||e.removed)return null;const l=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:s,lastLevel:l,originalEvent:a}).isDefaultPrevented())return null;if(l&&uR(l,s))return null;t.data[n.get()]&&r.get().each((e=>{t.data[n.get()].beforeBookmark=e}));const d=eu(e);if(d&&t.data.length>d){for(let e=0;e<t.data.length-1;e++)t.data[e]=t.data[e+1];t.data.length--,n.set(t.data.length)}s.bookmark=Ac(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(s),n.set(t.data.length-1);const c={level:s,lastLevel:l,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",c),e.dispatch("change",c)):e.dispatch("AddUndo",c),s},vR=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},CR=(e,t,n,o,r)=>{if(t.transact(o)){const o=t.data[n.get()].bookmark,s=t.data[n.get()-1];iR(e,s,!0),t.transact(r)&&(t.data[n.get()-1].beforeBookmark=o)}},wR=(e,t,n)=>{let o;return t.get()<n.length-1&&(t.set(t.get()+1),o=n[t.get()],iR(e,o,!1),e.setDirty(!0),e.dispatch("Redo",{level:o})),o},xR=(e,t,n,o)=>{let r;return t.typing&&(t.add(),t.typing=!1,gR(t,!1,n)),o.get()>0&&(o.set(o.get()-1),r=t.data[o.get()],iR(e,r,!0),e.setDirty(!0),e.dispatch("Undo",{level:r})),r},kR=e=>{e.clear(),e.add()},SR=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!uR(aR(e),t.data[0]),_R=(e,t)=>t.get()<e.data.length-1&&!e.typing,ER=(e,t,n)=>(pR(e,t),e.beforeChange(),e.ignore(n),e.add()),NR=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},RR=(e,t)=>{const n=e.dom,o=H(t)?t:e.getBody();z(e.hasVisual)&&(e.hasVisual=iu(e)),fe(n.select("table,a",o),(t=>{switch(t.nodeName){case"TABLE":const o=lu(e),r=n.getAttrib(t,"border");r&&"0"!==r||!e.hasVisual?n.removeClass(t,o):n.addClass(t,o);break;case"A":if(!n.getAttrib(t,"href")){const o=n.getAttrib(t,"name")||t.id,r=du(e);o&&e.hasVisual?n.addClass(t,r):n.removeClass(t,r)}}})),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},DR=e=>({init:{bindEvents:W},undoManager:{beforeChange:(t,n)=>bR(e,t,n),add:(t,n,o,r,s,a)=>yR(e,t,n,o,r,s,a),undo:(t,n,o)=>xR(e,t,n,o),redo:(t,n)=>wR(e,t,n),clear:(t,n)=>vR(e,t,n),reset:e=>kR(e),hasUndo:(t,n)=>SR(e,t,n),hasRedo:(e,t)=>_R(e,t),transact:(e,t,n)=>ER(e,t,n),ignore:(e,t)=>NR(e,t),extra:(t,n,o,r)=>CR(e,t,n,o,r)},formatter:{match:(t,n,o,r)=>Zk(e,t,n,o,r),matchAll:(t,n)=>eS(e,t,n),matchNode:(t,n,o,r)=>Jk(e,t,n,o,r),canApply:t=>nS(e,t),closest:t=>tS(e,t),apply:(t,n,o)=>f_(e,t,n,o),remove:(t,n,o,r)=>o_(e,t,n,o,r),toggle:(t,n,o)=>k_(e,t,n,o),formatChanged:(t,n,o,r,s)=>x_(e,t,n,o,r,s)},editor:{getContent:t=>Iv(e,t),setContent:(t,n)=>Hk(e,t,n),insertContent:(t,n)=>Mk(e,t,n),addVisual:t=>RR(e,t)},selection:{getContent:(t,n)=>$N(e,t,n)},autocompleter:{addDecoration:t=>Cv(e,t),removeDecoration:()=>kv(e,bo.fromDom(e.getBody()))},raw:{getModel:()=>re.none()}}),AR=e=>{const t=e=>L(e)?e:{},{init:n,undoManager:o,formatter:r,editor:s,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:o.beforeChange,add:o.add,undo:o.undo,redo:o.redo,clear:o.clear,reset:o.reset,hasUndo:o.hasUndo,hasRedo:o.hasRedo,transact:(e,t,n)=>o.transact(n),ignore:(e,t)=>o.ignore(t),extra:(e,t,n,r)=>o.extra(n,r)},formatter:{match:(e,n,o,s)=>r.match(e,t(n),s),matchAll:r.matchAll,matchNode:r.matchNode,canApply:e=>r.canApply(e),closest:e=>r.closest(e),apply:(e,n)=>r.apply(e,t(n)),remove:(e,n)=>r.remove(e,t(n)),toggle:(e,n)=>r.toggle(e,t(n)),formatChanged:(e,t,n,o,s)=>r.formatChanged(t,n,o,s)},editor:{getContent:e=>s.getContent(e),setContent:(e,t)=>({content:s.setContent(e,t),html:""}),insertContent:e=>(s.insertContent(e),""),addVisual:s.addVisual},selection:{getContent:(e,t)=>a.getContent(t)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>re.some(l.getRawModel())}}},TR=()=>{const e=Y(null),t=Y("");return{init:{bindEvents:W},undoManager:{beforeChange:W,add:e,undo:e,redo:e,clear:W,reset:W,hasUndo:ne,hasRedo:ne,transact:e,ignore:W,extra:W},formatter:{match:ne,matchAll:Y([]),matchNode:Y(void 0),canApply:ne,closest:t,apply:W,remove:W,toggle:W,formatChanged:Y({unbind:W})},editor:{getContent:t,setContent:Y({content:"",html:""}),insertContent:Y(""),addVisual:W},selection:{getContent:t},autocompleter:{addDecoration:W,removeDecoration:W},raw:{getModel:Y(re.none())}}},OR=e=>Ke(e.plugins,"rtc"),BR=e=>We(e.plugins,"rtc").bind((e=>re.from(e.setup))),PR=e=>{const t=e;return BR(e).fold((()=>(t.rtcInstance=DR(e),re.none())),(e=>(t.rtcInstance=TR(),re.some((()=>e().then((e=>(t.rtcInstance=AR(e),e.rtc.isRemote))))))))},LR=e=>e.rtcInstance?e.rtcInstance:DR(e),MR=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},IR=(e,t,n)=>{MR(e).undoManager.beforeChange(t,n)},FR=(e,t,n,o,r,s,a)=>MR(e).undoManager.add(t,n,o,r,s,a),UR=(e,t,n,o)=>MR(e).undoManager.undo(t,n,o),zR=(e,t,n)=>MR(e).undoManager.redo(t,n),jR=(e,t,n)=>{MR(e).undoManager.clear(t,n)},HR=(e,t)=>{MR(e).undoManager.reset(t)},VR=(e,t,n)=>MR(e).undoManager.hasUndo(t,n),$R=(e,t,n)=>MR(e).undoManager.hasRedo(t,n),qR=(e,t,n,o)=>MR(e).undoManager.transact(t,n,o),WR=(e,t,n)=>{MR(e).undoManager.ignore(t,n)},KR=(e,t,n,o,r)=>{MR(e).undoManager.extra(t,n,o,r)},GR=(e,t,n,o,r)=>MR(e).formatter.match(t,n,o,r),YR=(e,t,n)=>MR(e).formatter.matchAll(t,n),XR=(e,t,n,o,r)=>MR(e).formatter.matchNode(t,n,o,r),QR=(e,t)=>MR(e).formatter.canApply(t),JR=(e,t)=>MR(e).formatter.closest(t),ZR=(e,t,n,o)=>{MR(e).formatter.apply(t,n,o)},eD=(e,t,n,o,r)=>{MR(e).formatter.remove(t,n,o,r)},tD=(e,t,n,o)=>{MR(e).formatter.toggle(t,n,o)},nD=(e,t,n,o,r,s)=>MR(e).formatter.formatChanged(t,n,o,r,s),oD=(e,t)=>LR(e).editor.getContent(t),rD=(e,t,n)=>LR(e).editor.setContent(t,n),sD=(e,t,n)=>LR(e).editor.insertContent(t,n),aD=(e,t,n)=>MR(e).selection.getContent(t,n),iD=(e,t)=>MR(e).editor.addVisual(t),lD=e=>MR(e).init.bindEvents(),dD=(e,t)=>MR(e).autocompleter.addDecoration(t),cD=e=>MR(e).autocompleter.removeDecoration(),mD=(e,t={})=>{const n=t.format?t.format:"html";return aD(e,n,t)},uD=e=>0===e.dom.length?(br(e),re.none()):re.some(e),fD=(e,t)=>e.filter((e=>oh.isBookmarkNode(e.dom))).bind(t?Po:Bo),gD=(e,t,n,o)=>{const r=e.dom,s=t.dom,a=o?r.length:s.length;o?(ow(r,s,!1,!o),n.setStart(s,a)):(ow(s,r,!1,!o),n.setEnd(s,a))},pD=(e,t)=>{Do(e).each((n=>{const o=e.dom;t&&HC(n,Xd(o,0))?tw(o,0):!t&&$C(n,Xd(o,o.length))&&nw(o,o.length)}))},hD=(e,t,n,o)=>{e.bind((e=>((o?nw:tw)(e.dom,o?e.dom.length:0),t.filter(Un).map((t=>gD(e,t,n,o)))))).orThunk((()=>fD(t,o).or(t).filter(Un).map((e=>pD(e,o)))))},bD=(e,t)=>{const n=re.from(t.firstChild).map(bo.fromDom),o=re.from(t.lastChild).map(bo.fromDom);e.deleteContents(),e.insertNode(t);const r=n.bind(Bo).filter(Un).bind(uD),s=o.bind(Po).filter(Un).bind(uD);hD(r,n,e,!0),hD(s,o,e,!1),e.collapse(!1)},yD=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),vD=(e,t)=>{if("raw"!==t.format){const n=e.selection.getRng(),o=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),r=o?{context:o.nodeName.toLowerCase()}:{},s=e.parser.parse(t.content,{forced_root_block:!1,...r,...t});return Hv({validate:!1},e.schema).serialize(s)}return t.content},CD=(e,t,n={})=>{const o=yD(n,t);lN(e,o).each((t=>{const n=vD(e,t),o=e.selection.getRng();bD(o,o.createContextualFragment(n)),e.selection.setRng(o),ly(e,o),dN(e,n,t)}))},wD=(e,t,n)=>{if(e&&Ke(e,t)){const o=he(e[t],(e=>e!==n));0===o.length?delete e[t]:e[t]=o}};var xD=(e,t)=>{let n,o;const r=(t,n)=>Ce(n,(n=>e.is(n,t))),s=t=>e.getParents(t,null,e.getRoot());return{selectorChangedWithUnbind:(e,a)=>(n||(n={},o={},t.on("NodeChange",(e=>{const t=e.element,a=s(t),i={};kn.each(n,((e,t)=>{r(t,a).each((n=>{o[t]||(fe(e,(e=>{e(!0,{node:n,selector:t,parents:a})})),o[t]=e),i[t]=e}))})),kn.each(o,((e,n)=>{i[n]||(delete o[n],kn.each(e,(e=>{e(!1,{node:t,selector:n,parents:a})})))}))}))),n[e]||(n[e]=[]),n[e].push(a),r(e,s(t.selection.getStart())).each((()=>{o[e]=n[e]})),{unbind:()=>{wD(n,e,a),wD(o,e,a)}})}};const kD=e=>!(!e||!e.ownerDocument)&&So(bo.fromDom(e.ownerDocument),bo.fromDom(e)),SD=e=>!!e&&(kD(e.startContainer)&&kD(e.endContainer)),_D=(e,t,n,o)=>{let r,s;const{selectorChangedWithUnbind:a}=xD(e,o),i=(t,n)=>{const r=e.createRng();H(t)&&H(n)?(r.setStart(t,n),r.setEnd(t,n),b(r),g(!1)):(Vp(e,r,o.getBody(),!0),b(r))},l=(e,t)=>CD(o,e,t),d=e=>sv(o.getBody(),h(),e),c=e=>av(o.getBody(),h(),e),m=(e,t)=>D.getBookmark(e,t),u=(t,n)=>(cv(e,t,n).each(b),t),f=()=>{const e=h(),t=p();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},g=e=>{const t=h();t.collapse(!!e),b(t)},p=()=>t.getSelection?t.getSelection():t.document.selection,h=()=>{let n,a,i;const l=(e,t,n)=>{try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}},d=t.document;if(void 0!==o.bookmark&&!1===Zy(o)){const e=Sy(o);if(e.isSome())return e.map((e=>mv(o,[e])[0])).getOr(d.createRange())}try{(n=p())&&!Vr(n.anchorNode)&&(a=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():d.createRange(),a=mv(o,[a])[0])}catch(e){}return a||(a=d.createRange()),a.setStart&&9===a.startContainer.nodeType&&a.collapsed&&(i=e.getRoot(),a.setStart(i,0),a.setEnd(i,0)),r&&s&&(0===l(a.START_TO_START,a,r)&&0===l(a.END_TO_END,a,r)?a=s:(r=null,s=null)),a},b=(e,t)=>{let n;if(!SD(e))return;const a=p();if(e=o.dispatch("SetSelectionRange",{range:e,forward:t}).range,a){s=e;try{a.removeAllRanges(),a.addRange(e)}catch(e){}!1===t&&a.extend&&(a.collapse(e.endContainer,e.endOffset),a.extend(e.startContainer,e.startOffset)),r=a.rangeCount>0?a.getRangeAt(0):null}!e.collapsed&&e.startContainer===e.endContainer&&a.setBaseAndExtent&&e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset],n&&"IMG"===n.tagName&&(a.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),a.anchorNode===e.startContainer&&a.focusNode===e.endContainer||a.setBaseAndExtent(n,0,n,1))),o.dispatch("AfterSetSelectionRange",{range:e,forward:t})},y=t=>(l(e.getOuterHTML(t)),t),v=()=>lv(o.getBody(),h()),C=(t,n)=>dv(e,h(),t,n),w=()=>{const t=p(),n=null==t?void 0:t.anchorNode,o=null==t?void 0:t.focusNode;if(!t||!n||!o||Vr(n)||Vr(o))return!0;const r=e.createRng(),s=e.createRng();try{r.setStart(n,t.anchorOffset),r.collapse(!0),s.setStart(o,t.focusOffset),s.collapse(!0)}catch(e){return!0}return r.compareBoundaryPoints(r.START_TO_START,s)<=0},x=()=>{const t=h(),n=p();if(!Op(n)&&$p(o)){const n=Nb(e,t);return n.each((e=>{b(e,w())})),n.getOr(t)}return t},k=()=>{let t,n=e.getRoot();for(;n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},S=(e,t)=>{H(e)?iy(o,e,t):ly(o,h(),t)},_=(e,t)=>b(gb(e,t,o.getDoc())),E=()=>{const e=h();return e.collapsed?Xd.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},N=()=>{t=r=s=null,A.destroy()},R={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:o,collapse:g,setCursorLocation:i,getContent:e=>mD(o,e),setContent:l,getBookmark:m,moveToBookmark:e=>D.moveToBookmark(e),select:u,isCollapsed:f,isForward:w,setNode:y,getNode:v,getSel:p,setRng:b,getRng:h,getStart:d,getEnd:c,getSelectedBlocks:C,normalize:x,selectorChanged:(e,t)=>(a(e,t),R),selectorChangedWithUnbind:a,getScrollContainer:k,scrollIntoView:S,placeCaretAt:_,getBoundingClientRect:E,destroy:N},D=oh(R),A=Mh(R,o);return R.bookmarkManager=D,R.controlSelection=A,R},ED=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",((e,t)=>{let n=e.length;for(;n--;){const o=e[n];o.attr("tabindex",o.attr("data-mce-tabindex")),o.attr(t,null)}})),e.addAttributeFilter("src,href,style",((e,o)=>{const r="data-mce-"+o,s=t.url_converter,a=t.url_converter_scope;let i=e.length;for(;i--;){const t=e[i];let l=t.attr(r);void 0!==l?(t.attr(o,l.length>0?l:null),t.attr(r,null)):(l=t.attr(o),"style"===o?l=n.serializeStyle(n.parseStyle(l),t.name):s&&(l=s.call(a,l,o,t.name)),t.attr(o,l.length>0?l:null))}})),e.addAttributeFilter("class",(e=>{let t=e.length;for(;t--;){const n=e[t];let o=n.attr("class");o&&(o=n.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),n.attr("class",o.length>0?o:null))}})),e.addAttributeFilter("data-mce-type",((e,t,n)=>{let o=e.length;for(;o--;){const t=e[o];if("bookmark"===t.attr("data-mce-type")&&!n.cleanup){const e=re.from(t.firstChild).exists((e=>!pa(e.value)));e?t.unwrap():t.remove()}}})),e.addNodeFilter("noscript",(e=>{let t=e.length;for(;t--;){const n=e[t].firstChild;n&&(n.value=Bi.decode(n.value))}})),e.addNodeFilter("script,style",((e,n)=>{const o=e=>e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let r=e.length;for(;r--;){const s=e[r],a=s.firstChild?s.firstChild.value:"";if("script"===n){const e=s.attr("type");e&&s.attr("type","mce-no/type"===e?null:e.replace(/^mce\-/,"")),"xhtml"===t.element_format&&a.length>0&&(s.firstChild.value="// <![CDATA[\n"+o(a)+"\n// ]]>")}else"xhtml"===t.element_format&&a.length>0&&(s.firstChild.value="<!--\n"+o(a)+"\n-->")}})),e.addNodeFilter("#comment",(e=>{let o=e.length;for(;o--;){const r=e[o];t.preserve_cdata&&0===r.value.indexOf("[CDATA[")?(r.name="#cdata",r.type=4,r.value=n.decode(r.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===r.value.indexOf("mce:protected ")&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(r.value).substr(14))}})),e.addNodeFilter("xml:namespace,input",((e,t)=>{let n=e.length;for(;n--;){const o=e[n];7===o.type?o.remove():1===o.type&&("input"!==t||o.attr("type")||o.attr("type","text"))}})),e.addAttributeFilter("data-mce-type",(t=>{fe(t,(t=>{"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",((e,t)=>{let n=e.length;for(;n--;)e[n].attr(t,null)}))},ND=e=>{const t=e=>e&&"br"===e.name,n=e.lastChild;if(t(n)){const e=n.prev;t(e)&&(n.remove(),e.remove())}},RD=(e,t,n)=>{let o;const r=e.dom;let s=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const e=a.createHTMLDocument("");kn.each("BODY"===s.nodeName?s.childNodes:[s],(t=>{e.body.appendChild(e.importNode(t,!0))})),s="BODY"!==s.nodeName?e.body.firstChild:e.body,o=r.doc,r.doc=e}return sh(e,{...n,node:s}),o&&(r.doc=o),s},DD=(e,t)=>e&&e.hasEventListeners("PreProcess")&&!t.no_events,AD=(e,t,n)=>DD(e,n)?RD(e,t,n):t,TD=(e,t,n)=>{-1===kn.inArray(t,n)&&(e.addAttributeFilter(n,((e,t)=>{let n=e.length;for(;n--;)e[n].attr(t,null)})),t.push(n))},OD=(e,t,n)=>{if(!t.no_events&&e){return ah(e,{...t,content:n}).content}return n},BD=(e,t,n)=>{const o=ha(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Ys(bo.fromDom(t))?o:kn.trim(o)},PD=(e,t,n)=>{const o=n.selection?{forced_root_block:!1,...n}:n,r=e.parse(t,o);return ND(r),r},LD=(e,t,n)=>Hv(e,t).serialize(n),MD=(e,t,n,o,r)=>{const s=LD(t,n,o);return OD(e,r,s)},ID=(t,n)=>{const o=["data-mce-selected"],r=n&&n.dom?n.dom:bl.DOM,s=n&&n.schema?n.schema:Wi(t);t.entity_encoding=t.entity_encoding||"named",t.remove_trailing_brs=!("remove_trailing_brs"in t)||t.remove_trailing_brs;const a=oN(t,s);ED(a,t,r);const i=(e,o={})=>{const i={format:"html",...o},l=AD(n,e,i),d=BD(r,l,i),c=PD(a,d,i);return"tree"===i.format?c:MD(n,t,s,c,i)};return{schema:s,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:s.addValidElements,setRules:s.setValidElements,addTempAttr:e(TD,a,o),getTempAttrs:Y(o),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},FD=(e,t)=>{const n=ID(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},UD="html",zD=(e,t)=>({...e,format:t,get:!0,getInner:!0}),jD=(e,t={})=>{const n=t.format?t.format:UD,o=zD(t,n);return aN(e,o).fold(X,(t=>{const n=oD(e,t);return iN(e,n,t)}))},HD="html",VD=(e,t)=>({format:HD,...e,set:!0,content:t}),$D=(e,t,n={})=>{const o=VD(n,t);return lN(e,o).map((t=>{const n=rD(e,t.content,t);return dN(e,n.html,t),n.content})).getOr(t)},qD="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),WD="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),KD=e=>{const t=he(qD,(t=>Ke(e,t))),n=e.forced_root_block;return!1!==n&&""!==n||t.push("forced_root_block (false only)"),Re(t)},GD=e=>{const t=kn.makeMap(e.plugins," "),n=he(WD,(e=>Ke(t,e)));return Re(n)},YD=(e,t)=>{const n=KD(e),o=GD(t),r=o.length>0,s=n.length>0,a="mobile"===t.theme;if(r||s||a){const e="\n- ",t=a?`\n\nThemes:${e}mobile`:"",i=r?`\n\nPlugins:${e}${o.join(e)}`:"",l=s?`\n\nOptions:${e}${n.join(e)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+t+i+l)}},XD=(e,t)=>{YD(e,t)},QD=bl.DOM,JD=e=>{QD.setStyle(e.id,"display",e.orgDisplay)},ZD=e=>re.from(e).each((e=>e.destroy())),eA=e=>{e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)},tA=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),QD.unbind(t,"submit reset",e.formEventDelegate))},nA=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,o=e.getBody(),r=e.getElement();o&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&r&&QD.remove(r.nextSibling),ih(e),e.editorManager.remove(e),!e.inline&&o&&JD(e),lh(e),QD.remove(e.getContainer()),ZD(t),ZD(n),e.destroy()}},oA=(e,t)=>{const{selection:n,dom:o}=e;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),ZD(n),ZD(o)),tA(e),eA(e),e.destroyed=!0):e.remove())},rA=()=>{const e={};return{add:(t,n)=>{e[t]=n},get:t=>e[t]?e[t]:{icons:{}},has:t=>Ke(e,t)}},sA=rA(),aA=Pl.ModelManager,iA=(e,t)=>t.dom[e],lA=(e,t)=>parseInt(or(t,e),10),dA=e(iA,"clientWidth"),cA=e(iA,"clientHeight"),mA=e(lA,"margin-top"),uA=e(lA,"margin-left"),fA=e=>e.dom.getBoundingClientRect(),gA=(e,t,n)=>{const o=dA(e),r=cA(e);return t>=0&&n>=0&&t<=o&&n<=r},pA=(e,t,n,o)=>{const r=fA(t);return{x:n-(e?r.left+t.dom.clientLeft+uA(t):0),y:o-(e?r.top+t.dom.clientTop+mA(t):0)}},hA=(e,t,n)=>{const o=bo.fromDom(e.getBody()),r=e.inline?o:No(o),s=pA(e.inline,r,t,n);return gA(r,s.x,s.y)},bA=e=>re.from(e).map(bo.fromDom),yA=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return bA(t).map(Jo).getOr(!1)},vA=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}},CA=e=>{const t=[],n=()=>{const t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():vA()},o=()=>re.from(t[0]),r=(e,t)=>!(e.type!==t.type||e.text!==t.text||e.progressBar||e.timeout||t.progressBar||t.timeout),s=()=>{fe(t,(e=>{e.reposition()}))},a=e=>{t.push(e)},i=e=>{we(t,(t=>t===e)).each((e=>{t.splice(e,1)}))},l=(l,d=!0)=>{if(!e.removed&&yA(e))return d&&e.dispatch("BeforeOpenNotification",{notification:l}),Ce(t,(e=>r(n().getArgs(e),l))).getOrThunk((()=>{e.editorManager.setActive(e);const t=n().open(l,(()=>{i(t),s(),o().fold((()=>e.focus()),(e=>dy(bo.fromDom(e.getEl()))))}));return a(t),s(),e.dispatch("OpenNotification",{notification:{...t}}),t}))},d=()=>{o().each((e=>{n().close(e),i(e),s()}))},c=Y(t),m=e=>{e.on("SkinLoaded",(()=>{const t=Um(e);t&&l({text:t,type:"warning",timeout:0},!1),s()})),e.on("show ResizeEditor ResizeWindow NodeChange",(()=>{requestAnimationFrame(s)})),e.on("remove",(()=>{fe(t.slice(),(e=>{n().close(e)}))}))};return m(e),{open:l,close:d,getNotifications:c}},wA=Pl.PluginManager,xA=Pl.ThemeManager;var kA=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}};const SA=e=>{let t=[];const n=()=>{const t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():kA()},o=(e,t)=>(...n)=>t?t.apply(e,n):void 0,r=t=>{e.dispatch("OpenWindow",{dialog:t})},s=t=>{e.dispatch("CloseWindow",{dialog:t})},a=e=>{t.push(e),r(e)},i=n=>{s(n),t=he(t,(e=>e!==n)),0===t.length&&e.focus()},l=()=>re.from(t[t.length-1]),d=t=>{e.editorManager.setActive(e),ky(e),e.ui.show();const n=t();return a(n),n},c=(e,t)=>d((()=>n().open(e,t,i))),m=e=>d((()=>n().openUrl(e,i))),u=(e,t,r)=>{const s=n();s.alert(e,o(r||s,t))},f=(e,t,r)=>{const s=n();s.confirm(e,o(r||s,t))},g=()=>{l().each((e=>{n().close(e),i(e)}))};return e.on("remove",(()=>{fe(t,(e=>{n().close(e)}))})),{open:c,openUrl:m,alert:u,confirm:f,close:g}},_A=(e,t)=>{e.notificationManager.open({type:"error",text:t})},EA=(e,t)=>{e._skinLoaded?_A(e,t):e.on("SkinLoaded",(()=>{_A(e,t)}))},NA=(e,t)=>{EA(e,Bl.translate(["Failed to upload image: {0}",t]))},RA=(e,t,n)=>{hh(e,t,{message:n}),console.error(n)},DA=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,AA=(e,t,n)=>{RA(e,"PluginLoadError",DA("plugin",t,n))},TA=(e,t,n)=>{RA(e,"IconsLoadError",DA("icons",t,n))},OA=(e,t,n)=>{RA(e,"LanguageLoadError",DA("language",t,n))},BA=(e,t,n)=>{RA(e,"ThemeLoadError",DA("theme",t,n))},PA=(e,t,n)=>{RA(e,"ModelLoadError",DA("model",t,n))},LA=(e,t,n)=>{const o=Bl.translate(["Failed to initialize plugin: {0}",t]);hh(e,"PluginLoadError",{message:o}),MA(o,n),EA(e,o)},MA=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},IA=e=>/^[a-z0-9\-]+$/i.test(e),FA=e=>zA(e,Am(e)),UA=e=>zA(e,Om(e)),zA=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`,r=!0===e.inline;return ue(t,(t=>IA(t)&&!r?`${n}/${t}/${o}`:e.documentBaseURI.toAbsolute(t)))},jA=e=>{e.contentCSS=e.contentCSS.concat(FA(e),UA(e))},HA=oe,VA=(e,t,n)=>Rr(e,t,HA,n),$A=e=>e?Oe(e.getElementsByTagName("img")):[],qA=(e,t)=>{const n={},o=(o,r=oe)=>{const s=he($A(o),(t=>{const n=t.src;return!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!n||n===pn.transparentSrc)&&(xt(n,"blob:")?!e.isUploaded(n)&&r(t):!!xt(n,"data:")&&r(t))))})),a=ue(s,(e=>{const o=e.src;if(Ke(n,o))return n[o].then((t=>P(t)?t:{image:e,blobInfo:t.blobInfo}));{const r=OE(t,o).then((t=>(delete n[o],{image:e,blobInfo:t}))).catch((e=>(delete n[o],e)));return n[o]=r,r}}));return Promise.all(a)};return{findAll:o}},WA=()=>{const e=1,t=2;let n={};const o=(e,t)=>({status:e,resultUri:t}),r=e=>e in n,s=t=>!!r(t)&&n[t].status===e,a=e=>!!r(e)&&n[e].status===t;return{hasBlobUri:r,getResultUri:e=>{const t=n[e];return t?t.resultUri:null},isPending:s,isUploaded:a,markPending:t=>{n[t]=o(e,null)},markUploaded:(e,r)=>{n[e]=o(t,r)},removeFailed:e=>{delete n[e]},destroy:()=>{n={}}}};let KA=0;const GA=()=>{const e=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+(new Date).getTime().toString(36)+e()+e()+e()},YA=e=>e+KA+++GA(),XA=()=>{let e=[];const t=e=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[e.toLowerCase()]||"dat"),n=(e,t,n,r,s)=>{if(P(e)){return o({id:e,name:r,filename:s,blob:t,base64:n})}if(L(e))return o(e);throw new Error("Unknown input type")},o=e=>{if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const n=e.id||YA("blobid"),o=e.name||n,r=e.blob;return{id:Y(n),name:Y(o),filename:Y(e.filename||o+"."+t(r.type)),blob:Y(r),base64:Y(e.base64),blobUri:Y(e.blobUri||URL.createObjectURL(r)),uri:Y(e.uri)}},r=t=>{a(t.id())||e.push(t)},s=t=>Ce(e,t).getOrUndefined(),a=e=>s((t=>t.id()===e)),i=(e,t)=>s((n=>n.base64()===e&&n.blob().type===t));return{create:n,add:r,get:a,getByUri:e=>s((t=>t.blobUri()===e)),getByData:i,findFirst:s,removeByUri:t=>{e=he(e,(e=>e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)))},destroy:()=>{fe(e,(e=>{URL.revokeObjectURL(e.blobUri())})),e=[]}}},QA=(e,t)=>{const n={},o=(e,t)=>e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t,r=(e,n)=>new Promise(((r,s)=>{const a=new XMLHttpRequest;a.open("POST",t.url),a.withCredentials=t.credentials,a.upload.onprogress=e=>{n(e.loaded/e.total*100)},a.onerror=()=>{s("Image upload failed due to a XHR Transport error. Code: "+a.status)},a.onload=()=>{if(a.status<200||a.status>=300)return void s("HTTP Error: "+a.status);const e=JSON.parse(a.responseText);e&&P(e.location)?r(o(t.basePath,e.location)):s("Invalid JSON: "+a.responseText)};const i=new FormData;i.append("file",e.blob(),e.filename()),a.send(i)})),s=()=>new Promise((e=>{e([])})),a=(e,t)=>({url:t,blobInfo:e,status:!0}),i=(e,t)=>({url:"",blobInfo:e,status:!1,error:t}),l=(e,t)=>{kn.each(n[e],(e=>{e(t)})),delete n[e]},d=(t,n,o)=>(e.markPending(t.blobUri()),new Promise((r=>{let s,d;try{const c=()=>{s&&(s.close(),d=W)},m=n=>{c(),e.markUploaded(t.blobUri(),n),l(t.blobUri(),a(t,n)),r(a(t,n))},u=n=>{c(),e.removeFailed(t.blobUri()),l(t.blobUri(),i(t,n)),r(i(t,n))};d=e=>{e<0||e>100||re.from(s).orThunk((()=>re.from(o).map(ee))).each((t=>{s=t,t.progressBar.value(e)}))},n(t,d).then(m,(e=>{u(P(e)?{message:e}:e)}))}catch(e){r(i(t,e))}}))),c=e=>e===r,m=e=>{const t=e.blobUri();return new Promise((e=>{n[t]=n[t]||[],n[t].push(e)}))},u=(n,o)=>(n=kn.grep(n,(t=>!e.isUploaded(t.blobUri()))),Promise.all(kn.map(n,(n=>e.isPending(n.blobUri())?m(n):d(n,t.handler,o))))),f=(e,n)=>!t.url&&c(t.handler)?s():u(e,n);return!1===V(t.handler)&&(t.handler=r),{upload:f}},JA=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),ZA=(e,t)=>QA(t,{url:Cm(e),basePath:wm(e),credentials:xm(e),handler:km(e)}),eT=e=>{const t=WA(),n=ZA(e,t);return{upload:(t,o=!0)=>n.upload(t,o?JA(e):void 0)}},tT=e=>{const t=XA();let n,o;const r=WA(),s=[],a=t=>n=>e.selection?t(n):[],i=e=>e+(-1===e.indexOf("?")?"?":"&")+(new Date).getTime(),l=(e,t,n)=>{let o=0;do{o=e.indexOf(t,o),-1!==o&&(e=e.substring(0,o)+n+e.substr(o+t.length),o+=n.length-t.length+1)}while(-1!==o);return e},d=(e,t,n)=>{const o=`src="${n}"${n===pn.transparentSrc?' data-mce-placeholder="1"':""}`;return e=l(e,`src="${t}"`,o),e=l(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},c=(t,n)=>{fe(e.undoManager.data,(e=>{"fragmented"===e.type?e.fragments=ue(e.fragments,(e=>d(e,t,n))):e.content=d(e.content,t,n)}))},m=(t,n)=>{const o=e.convertURL(n,"src");c(t.src,n),qn(bo.fromDom(t),{src:hm(e)?i(n):n,"data-mce-src":o})},u=()=>(n||(n=ZA(e,r)),h().then(a((o=>{const r=ue(o,(e=>e.blobInfo));return n.upload(r,JA(e)).then(a((n=>{const r=[];let s=!1;const a=ue(n,((n,a)=>{const i=o[a].blobInfo,l=o[a].image;let d=!1;return n.status&&bm(e)?(n.url&&!wt(l.src,n.url)&&(s=!0),t.removeByUri(l.src),OR(e)||m(l,n.url)):n.error&&(n.error.remove&&(c(l.getAttribute("src"),pn.transparentSrc),r.push(l),d=!0),NA(e,n.error.message)),{element:l,status:n.status,uploadUri:n.url,blobInfo:i,removed:d}}));return r.length>0&&!OR(e)?e.undoManager.transact((()=>{fe(r,(n=>{e.dom.remove(n),t.removeByUri(n.src)}))})):s&&e.undoManager.dispatchChange(),a})))})))),f=()=>pm(e)?u():Promise.resolve([]),g=e=>Se(s,(t=>t(e))),p=e=>{s.push(e)},h=()=>(o||(o=qA(r,t)),o.findAll(e.getBody(),g).then(a((t=>{const n=he(t,(t=>!P(t)||(EA(e,t),!1)));return OR(e)||fe(n,(e=>{c(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),n})))),b=()=>{t.destroy(),r.destroy(),o=n=null},y=n=>n.replace(/src="(blob:[^"]+)"/g,((n,o)=>{const s=r.getResultUri(o);if(s)return'src="'+s+'"';let a=t.getByUri(o);if(a||(a=ye(e.editorManager.get(),((e,t)=>e||t.editorUpload&&t.editorUpload.blobCache.getByUri(o)),null)),a){return'src="data:'+a.blob().type+";base64,"+a.base64()+'"'}return n}));return e.on("SetContent",(()=>{pm(e)?f():h()})),e.on("RawSaveContent",(e=>{e.content=y(e.content)})),e.on("GetContent",(e=>{e.source_view||"raw"===e.format||"tree"===e.format||(e.content=y(e.content))})),e.on("PostRender",(()=>{e.parser.addNodeFilter("img",(e=>{fe(e,(e=>{const n=e.attr("src");if(t.getByUri(n))return;const o=r.getResultUri(n);o&&e.attr("src",o)}))}))})),{blobCache:t,addFilter:p,
uploadImages:u,uploadImagesAuto:f,scanForImages:h,destroy:b}},nT=e=>{const t=e.dom,n=e.schema.type,o={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:e=>{t.setStyle(e,"float",null)},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const e={inline:"span",styles:{textDecoration:"line-through"},exact:!0},t={inline:"strike",remove:"all",preserve_attributes:["class","style"]},o={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==n?[o,e,t]:[e,o,t]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:e=>$r(e)&&e.hasAttribute("href"),onformat:(e,n,o)=>{kn.each(o,((n,o)=>{t.setAttrib(e,o,n)}))}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":e=>{var t;return null!==(t=null==e?void 0:e.customValue)&&void 0!==t?t:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return kn.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),(e=>{o[e]={block:e,remove:"all"}})),o},oT={remove_similar:!0,inherit:!1},rT={selector:"td,th",...oT},sT={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...rT},tablecellverticalalign:{styles:{"vertical-align":"%value"},...rT},tablecellbordercolor:{styles:{borderColor:"%value"},...rT},tablecellclass:{classes:["%value"],...rT},tableclass:{selector:"table",classes:["%value"],...oT},tablecellborderstyle:{styles:{borderStyle:"%value"},...rT},tablecellborderwidth:{styles:{borderWidth:"%value"},...rT}},aT=Y(sT),iT=e=>{const t={},n=e=>H(e)?t[e]:t,o=e=>Ke(t,e),r=(e,n)=>{e&&(P(e)?(I(n)||(n=[n]),fe(n,(e=>{z(e.deep)&&(e.deep=!dp(e)),z(e.split)&&(e.split=!dp(e)||cp(e)),z(e.remove)&&dp(e)&&!cp(e)&&(e.remove="none"),dp(e)&&cp(e)&&(e.mixed=!0,e.block_expand=!0),P(e.classes)&&(e.classes=e.classes.split(/\s+/))})),t[e]=n):Ie(e,((e,t)=>{r(t,e)})))},s=e=>(e&&t[e]&&delete t[e],t);return r(nT(e)),r(aT()),r(qm(e)),{get:n,has:o,register:r,unregister:s}},lT=kn.each,dT=bl.DOM,cT=(e,t)=>{let n,o,r;const s=t&&t.schema||Wi({}),a=(e,t)=>{t.classes.length&&dT.addClass(e,t.classes.join(" ")),dT.setAttribs(e,t.attrs)},i=e=>{o="string"==typeof e?{name:e,classes:[],attrs:{}}:e;const t=dT.create(o.name);return a(t,o),t},l=(e,t)=>{const n="string"!=typeof e?e.nodeName.toLowerCase():e,o=s.getElementRule(n),r=o&&o.parentsRequired;return!(!r||!r.length)&&(t&&-1!==kn.inArray(r,t)?t:r[0])},d=(e,t,n)=>{let o,r;const s=t.length>0&&t[0],a=s&&s.name,c=l(e,a);if(c)a===c?(r=t[0],t=t.slice(1)):r=c;else if(s)r=t[0],t=t.slice(1);else if(!n)return e;return r&&(o=i(r),o.appendChild(e)),n&&(o||(o=dT.create("div"),o.appendChild(e)),kn.each(n,(t=>{const n=i(t);o.insertBefore(n,e)}))),d(o,t,r&&r.siblings)};return e&&e.length?(o=e[0],n=i(o),r=dT.create("div"),r.appendChild(d(n,e.slice(1),o.siblings)),r):""},mT=e=>{let t;const n={classes:[],attrs:{}};return"*"!==(e=n.selector=kn.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,((e,t,o,r,s)=>{switch(t){case"#":n.attrs.id=o;break;case".":n.classes.push(o);break;case":":-1!==kn.inArray("checked disabled enabled read-only required".split(" "),o)&&(n.attrs[o]=o)}if("["===r){const e=s.match(/([\w\-]+)(?:\=\"([^\"]+))?/);e&&(n.attrs[e[1]]=e[2])}return""}))),n.name=t||"div",n},uT=e=>e&&"string"==typeof e?(e=(e=e.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),kn.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),(e=>{const t=kn.map(e.split(/(?:~\+|~|\+)/),mT),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[],fT=(e,t)=>{let n,o,r,s="",a=Wm(e);if(""===a)return"";const i=e=>e.replace(/%(\w+)/g,"");if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){const e=We(t,"preview");if(Sn(e,!1))return"";a=e.getOr(a)}n=t.block||t.inline||"span";const l=uT(t.selector);l.length?(l[0].name||(l[0].name=n),n=t.selector,o=cT(l,e)):o=cT([n],e);const d=dT.select(n,o)[0]||o.firstChild;return lT(t.styles,((e,t)=>{const n=i(e);n&&dT.setStyle(d,t,n)})),lT(t.attributes,((e,t)=>{const n=i(e);n&&dT.setAttrib(d,t,n)})),lT(t.classes,(e=>{const t=i(e);dT.hasClass(d,t)||dT.addClass(d,t)})),e.dispatch("PreviewFormats"),dT.setStyles(o,{position:"absolute",left:-65535}),e.getBody().appendChild(o),r=dT.getStyle(e.getBody(),"fontSize",!0),r=/px$/.test(r)?parseInt(r,10):0,lT(a.split(" "),(t=>{let n=dT.getStyle(d,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=dT.getStyle(e.getBody(),t,!0),"#ffffff"===qg(n).toLowerCase())||"color"===t&&"#000000"===qg(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===r)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*r+"px"}"border"===t&&n&&(s+="padding:0 2px;"),s+=t+":"+n+";"}})),e.dispatch("AfterPreviewFormats"),dT.remove(o),s},gT=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},pT=t=>{const n=iT(t),o=Sl(null);return gT(t),wS(t),{get:n.get,has:n.has,register:n.register,unregister:n.unregister,apply:(e,n,o)=>{ZR(t,e,n,o)},remove:(e,n,o,r)=>{eD(t,e,n,o,r)},toggle:(e,n,o)=>{tD(t,e,n,o)},match:(e,n,o,r)=>GR(t,e,n,o,r),closest:e=>JR(t,e),matchAll:(e,n)=>YR(t,e,n),matchNode:(e,n,o,r)=>XR(t,e,n,o,r),canApply:e=>QR(t,e),formatChanged:(e,n,r,s)=>nD(t,o,e,n,r,s),getCssText:e(fT,t)}},hT=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},bT=(e,t,n)=>{const o=Sl(!1),r=e=>{gR(t,!1,n),t.add({},e)};e.on("init",(()=>{t.add()})),e.on("BeforeExecCommand",(e=>{const o=e.command;hT(o)||(pR(t,n),t.beforeChange())})),e.on("ExecCommand",(e=>{const t=e.command;hT(t)||r(e)})),e.on("ObjectResizeStart cut",(()=>{t.beforeChange()})),e.on("SaveContent ObjectResized blur",r),e.on("dragend",r),e.on("keyup",(n=>{const s=n.keyCode;n.isDefaultPrevented()||((s>=33&&s<=36||s>=37&&s<=40||45===s||n.ctrlKey)&&(r(),e.nodeChanged()),46!==s&&8!==s||e.nodeChanged(),o.get()&&t.typing&&!1===uR(aR(e),t.data[0])&&(!1===e.isDirty()&&e.setDirty(!0),e.dispatch("TypingUndo"),o.set(!1),e.nodeChanged()))})),e.on("keydown",(e=>{const s=e.keyCode;if(e.isDefaultPrevented())return;if(s>=33&&s<=36||s>=37&&s<=40||45===s)return void(t.typing&&r(e));const a=e.ctrlKey&&!e.altKey||e.metaKey;!(s<16||s>20)||224===s||91===s||t.typing||a||(t.beforeChange(),gR(t,!0,n),t.add({},e),o.set(!0))})),e.on("mousedown",(e=>{t.typing&&r(e)}));const s=e=>"insertReplacementText"===e.inputType,a=e=>"insertText"===e.inputType&&null===e.data,i=e=>"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType;e.on("input",(e=>{e.inputType&&(s(e)||a(e)||i(e))&&r(e)})),e.on("AddUndo Undo Redo ClearUndos",(t=>{t.isDefaultPrevented()||e.nodeChanged()}))},yT=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},vT=e=>{const t=Ml(),n=Sl(0),o=Sl(0),r={data:[],typing:!1,beforeChange:()=>{IR(e,n,t)},add:(s,a)=>FR(e,r,o,n,t,s,a),dispatchChange:()=>{e.setDirty(!0),e.dispatch("change",{level:aR(e),lastLevel:De(r.data,o.get()).getOrUndefined()})},undo:()=>UR(e,r,n,o),redo:()=>zR(e,o,r.data),clear:()=>{jR(e,r,o)},reset:()=>{HR(e,r)},hasUndo:()=>VR(e,r,o),hasRedo:()=>$R(e,r,o),transact:t=>qR(e,r,n,t),ignore:t=>{WR(e,n,t)},extra:(t,n)=>{KR(e,r,o,t,n)}};return OR(e)||bT(e,r,n),yT(e),r},CT=[9,27,Dh.HOME,Dh.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Dh.DOWN,Dh.UP,Dh.LEFT,Dh.RIGHT].concat(pn.browser.isFirefox()?[224]:[]),wT="data-mce-placeholder",xT=e=>"keydown"===e.type||"keyup"===e.type,kT=e=>{const t=e.keyCode;return t===Dh.BACKSPACE||t===Dh.DELETE},ST=e=>{if(xT(e)){const t=e.keyCode;return!kT(e)&&(Dh.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||ce(CT,t))}return!1},_T=e=>xT(e)&&!(kT(e)||"keyup"===e.type&&229===e.keyCode),ET=(e,t,n)=>{if(ii(bo.fromDom(t),!1)){const o=t.firstElementChild;return!o||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&n===o.nodeName.toLowerCase()}return!1},NT=e=>{const t=e.dom,n=lm(e),o=Im(e),r=(s,a)=>{if(ST(s))return;const i=e.getBody(),l=!_T(s)&&ET(t,i,n);(""!==t.getAttrib(i,wT)!==l||a)&&(t.setAttrib(i,wT,l?o:null),t.setAttrib(i,"aria-placeholder",l?o:null),ph(e,l),e.on(l?"keydown":"keyup",r),e.off(l?"keyup":"keydown",r))};o&&e.on("init",(t=>{r(t,!0),e.on("change SetContent ExecCommand",r),e.on("paste",(t=>Dy.setEditorTimeout(e,(()=>r(t)))))}))},RT=(e,t)=>({block:e,position:t}),DT=(e,t)=>({from:e,to:t}),AT=(e,t)=>{const n=bo.fromDom(e),o=bo.fromDom(t.container());return Uw(n,o).map((e=>RT(e,t)))},TT=e=>!1===ko(e.from.block,e.to.block),OT=e=>Do(e.from.block).bind((t=>Do(e.to.block).filter((e=>ko(t,e))))).isSome(),BT=e=>!1===ds(e.from.block.dom)&&!1===ds(e.to.block.dom),PT=(e,t,n)=>as(n.position.getNode())&&!1===ii(n.block)?rg(!1,n.block.dom).bind((o=>o.isEqual(n.position)?tg(t,e,o).bind((t=>AT(e,t))):re.some(n))).getOr(n):n,LT=(e,t,n)=>{const o=AT(e,Xd.fromRangeStart(n)),r=o.bind((n=>tg(t,e,n.position).bind((n=>AT(e,n).map((n=>PT(e,t,n)))))));return En(o,r,DT).filter((e=>TT(e)&&OT(e)&&BT(e)))},MT=(e,t,n)=>n.collapsed?LT(e,t,n):re.none(),IT=e=>{const t=Io(e);return we(t,zs).fold(Y(t),(e=>t.slice(0,e)))},FT=e=>{const t=IT(e);return fe(t,br),t},UT=(e,t)=>{const n=gC(t,e);return Ce(n.reverse(),(e=>ii(e))).each(br)},zT=e=>0===he(Lo(e),(e=>!ii(e))).length,jT=(e,t,n,o)=>{if(ii(n))return ua(n),ig(n.dom);zT(o)&&ii(t)&&dr(o,bo.fromTag("br"));const r=ag(n.dom,Xd.before(o.dom));return fe(FT(t),(e=>{dr(o,e)})),UT(e,t),r},HT=(e,t,n)=>{if(ii(n))return br(n),ii(t)&&ua(t),ig(t.dom);const o=lg(n.dom);return fe(FT(t),(e=>{ur(n,e)})),UT(e,t),o},VT=(e,t)=>{const n=gC(t,e);return re.from(n[n.length-1])},$T=(e,t)=>So(t,e)?VT(t,e):re.none(),qT=(e,t)=>{rg(e,t.dom).map((e=>e.getNode())).map(bo.fromDom).filter(Vs).each(br)},WT=(t,n,o)=>(qT(!0,n),qT(!1,o),$T(n,o).fold(e(HT,t,n,o),e(jT,t,n,o))),KT=(e,t,n,o)=>t?WT(e,o,n):WT(e,n,o),GT=(e,t)=>{const n=bo.fromDom(e.getBody()),o=MT(n.dom,t,e.selection.getRng()).map((o=>()=>{KT(n,t,o.from.block,o.to.block).each((t=>{e.selection.setRng(t.toRange())}))}));return o},YT=(e,t)=>{const n=t.getRng();return En(Uw(e,bo.fromDom(n.startContainer)),Uw(e,bo.fromDom(n.endContainer)),((o,r)=>!1===ko(o,r)?re.some((()=>{n.deleteContents(),KT(e,!0,o,r).each((e=>{t.setRng(e.toRange())}))})):re.none())).getOr(re.none())},XT=(t,n)=>{const o=bo.fromDom(n),r=e(ko,t);return ys(o,Gs,r).isSome()},QT=(e,t)=>XT(e,t.startContainer)||XT(e,t.endContainer),JT=(e,t)=>{const n=ag(e.dom,Xd.fromRangeStart(t)).isNone(),o=sg(e.dom,Xd.fromRangeEnd(t)).isNone();return!QT(e,t)&&n&&o},ZT=e=>re.some((()=>{e.setContent(""),e.selection.setCursorLocation()})),eO=e=>{const t=bo.fromDom(e.getBody()),n=e.selection.getRng();return JT(t,n)?ZT(e):YT(t,e.selection)},tO=e=>e.selection.isCollapsed()?re.none():eO(e),nO=ls,oO=ds,rO=(e,t,n,o,r)=>re.from(t._selectionOverrides.showCaret(e,n,o,r)),sO=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},aO=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?re.none():re.some(sO(t)),iO=(e,t,n)=>{const o=Nf(1,e.getBody(),t),r=Xd.fromRangeStart(o),s=r.getNode();if(of(s))return rO(1,e,s,!r.isAtEnd(),!1);const a=r.getNode(!0);if(of(a))return rO(1,e,a,!1,!1);const i=e.dom.getParent(r.getNode(),(e=>oO(e)||nO(e)));return of(i)?rO(1,e,i,!1,n):re.none()},lO=(e,t,n)=>t.collapsed?iO(e,t,n).getOr(t):t,dO=e=>dC(e)||sC(e),cO=e=>cC(e)||aC(e),mO=(e,t)=>{es(t)&&0===t.data.length&&e.remove(t)},uO=(e,t,n,o,r,s)=>{rO(o,e,s.getNode(!r),r,!0).each((n=>{if(t.collapsed){const e=t.cloneRange();r?e.setEnd(n.startContainer,n.startOffset):e.setStart(n.endContainer,n.endOffset),e.deleteContents()}else t.deleteContents();e.selection.setRng(n)})),mO(e.dom,n)},fO=(t,n)=>{const o=t.selection.getRng();if(!es(o.commonAncestorContainer))return re.none();const r=n?Pf.Forwards:Pf.Backwards,s=Kf(t.getBody()),a=e(Of,n?s.next:s.prev),i=n?dO:cO,l=Df(r,t.getBody(),o),d=Tw(n,a(l));if(!d||!Bf(l,d))return re.none();if(i(d))return re.some((()=>uO(t,o,l.getNode(),r,n,d)));const c=a(d);return c&&i(c)&&Bf(d,c)?re.some((()=>uO(t,o,l.getNode(),r,n,c))):re.none()},gO=(e,t)=>fO(e,t),pO=(e,t)=>{const n=e.getBody();return t?ig(n).filter(dC):lg(n).filter(cC)},hO=e=>{const t=e.selection.getRng();return!t.collapsed&&(pO(e,!0).exists((e=>e.isEqual(Xd.fromRangeStart(t))))||pO(e,!1).exists((e=>e.isEqual(Xd.fromRangeEnd(t)))))},bO=e=>Gs(bo.fromDom(e))||Ws(bo.fromDom(e)),yO=Mc.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),vO=(e,t)=>{const n=t.getNode(!1===e),o=e?"after":"before";return $r(n)&&n.getAttribute("data-mce-caret")===o},CO=(e,t,n,o)=>{const r=t=>Hs(bo.fromDom(t))&&!Cf(n,o,e);return Rf(!t,n).fold((()=>Rf(t,o).fold(ne,r)),r)},wO=(e,t,n,o)=>{const r=o.getNode(!1===t);return Uw(bo.fromDom(e),bo.fromDom(n.getNode())).map((e=>ii(e)?yO.remove(e.dom):yO.moveToElement(r))).orThunk((()=>re.some(yO.moveToElement(r))))},xO=(e,t,n)=>tg(t,e,n).bind((o=>bO(o.getNode())||CO(e,t,n,o)?re.none():t&&ds(o.getNode())||!1===t&&ds(o.getNode(!0))?wO(e,t,n,o):t&&cC(n)||!1===t&&dC(n)?re.some(yO.moveToPosition(o)):re.none())),kO=(e,t)=>e&&ds(t.nextSibling)?re.some(yO.moveToElement(t.nextSibling)):!1===e&&ds(t.previousSibling)?re.some(yO.moveToElement(t.previousSibling)):re.none(),SO=(e,t,n)=>n.fold((e=>re.some(yO.remove(e))),(e=>re.some(yO.moveToElement(e))),(n=>Cf(t,n,e)?re.none():re.some(yO.moveToPosition(n)))),_O=(e,t,n)=>vO(t,n)?kO(t,n.getNode(!1===t)).fold((()=>xO(e,t,n)),re.some):xO(e,t,n).bind((t=>SO(e,n,t))),EO=(e,t,n)=>{const o=Nf(t?1:-1,e,n),r=Xd.fromRangeStart(o),s=bo.fromDom(e);return!1===t&&cC(r)?re.some(yO.remove(r.getNode(!0))):t&&dC(r)?re.some(yO.remove(r.getNode())):!1===t&&dC(r)&&EC(s,r)?NC(s,r).map((e=>yO.remove(e.getNode()))):t&&cC(r)&&_C(s,r)?RC(s,r).map((e=>yO.remove(e.getNode()))):_O(e,t,r)},NO=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),xw(e,t,bo.fromDom(n)),!0),RO=(e,t)=>n=>{const o=t?Xd.before(n):Xd.after(n);return e.selection.setRng(o.toRange()),!0},DO=e=>t=>(e.selection.setRng(t.toRange()),!0),AO=(e,t)=>re.from(Ux(e.getBody(),t)),TO=(e,t)=>{const n=e.selection.getNode();return AO(e,n).filter(ds).fold((()=>EO(e.getBody(),t,e.selection.getRng()).map((n=>()=>n.fold(NO(e,t),RO(e,t),DO(e))))),(()=>re.some(W)))},OO=e=>{fe(ra(e,".mce-offscreen-selection"),br)},BO=(e,t)=>{const n=e.selection.getNode();if(ds(n)&&!cs(n)){return AO(e,n.parentNode).filter(ds).fold((()=>re.some((()=>{OO(bo.fromDom(e.getBody())),xw(e,t,bo.fromDom(e.selection.getNode())),zw(e)}))),(()=>re.some(W)))}return hO(e)?re.some((()=>{Vw(e,e.selection.getRng(),bo.fromDom(e.getBody()))})):re.none()},PO=e=>{const t=e.dom,n=e.selection,o=Ux(e.getBody(),n.getNode());if(ls(o)&&t.isBlock(o)&&t.isEmpty(o)){const e=t.create("br",{"data-mce-bogus":"1"});t.setHTML(o,""),o.appendChild(e),n.setRng(Xd.before(e).toRange())}return!0},LO=(e,t)=>e.selection.isCollapsed()?TO(e,t):BO(e,t),MO=(e,t)=>{const n=Xd.fromRangeStart(e.selection.getRng());return tg(t,e.getBody(),n).filter((e=>t?oC(e):rC(e))).bind((e=>re.from(wf(t?0:-1,e)))).map((t=>()=>e.selection.select(t)))},IO=(e,t)=>e.selection.isCollapsed()?MO(e,t):re.none(),FO=es,UO=e=>FO(e)&&e.data[0]===ga,zO=e=>FO(e)&&e.data[e.data.length-1]===ga,jO=e=>e.ownerDocument.createTextNode(ga),HO=e=>{if(FO(e.previousSibling))return zO(e.previousSibling)||e.previousSibling.appendData(ga),e.previousSibling;if(FO(e))return UO(e)||e.insertData(0,ga),e;{const t=jO(e);return e.parentNode.insertBefore(t,e),t}},VO=e=>{if(FO(e.nextSibling))return UO(e.nextSibling)||e.nextSibling.insertData(0,ga),e.nextSibling;if(FO(e))return zO(e)||e.appendData(ga),e;{const t=jO(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}},$O=(e,t)=>e?HO(t):VO(t),qO=e($O,!0),WO=e($O,!1),KO=(e,t)=>es(e.container())?$O(t,e.container()):$O(t,e.getNode()),GO=(e,t)=>{const n=t.get();return n&&e.container()===n&&Ca(n)},YO=(e,t)=>t.fold((t=>{Gu(e.get());const n=qO(t);return e.set(n),re.some(Xd(n,n.length-1))}),(t=>ig(t).map((t=>{if(GO(t,e))return Xd(e.get(),1);{Gu(e.get());const n=KO(t,!0);return e.set(n),Xd(n,1)}}))),(t=>lg(t).map((t=>{if(GO(t,e))return Xd(e.get(),e.get().length-1);{Gu(e.get());const n=KO(t,!1);return e.set(n),Xd(n,n.length-1)}}))),(t=>{Gu(e.get());const n=WO(t);return e.set(n),re.some(Xd(n,1))})),XO=(e,t)=>{for(let n=0;n<e.length;n++){const o=e[n].apply(null,t);if(o.isSome())return o}return re.none()},QO=Mc.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),JO=(e,t)=>{const n=vf(t,e);return n||e},ZO=(t,n,o)=>{const r=Ow(o),s=JO(n,r.container());return Rw(t,s,r).fold((()=>sg(s,r).bind(e(Rw,t,s)).map((e=>QO.before(e)))),re.none)},eB=(e,t)=>null===mg(e,t),tB=(t,n,o)=>Rw(t,n,o).filter(e(eB,n)),nB=(e,t,n)=>{const o=Bw(n);return tB(e,t,o).bind((e=>ag(e,o).isNone()?re.some(QO.start(e)):re.none()))},oB=(e,t,n)=>{const o=Ow(n);return tB(e,t,o).bind((e=>sg(e,o).isNone()?re.some(QO.end(e)):re.none()))},rB=(t,n,o)=>{const r=Bw(o),s=JO(n,r.container());return Rw(t,s,r).fold((()=>ag(s,r).bind(e(Rw,t,s)).map((e=>QO.after(e)))),re.none)},sB=e=>!1===Ew(iB(e)),aB=(e,t,n)=>XO([ZO,nB,oB,rB],[e,t,n]).filter(sB),iB=e=>e.fold(X,X,X,X),lB=e=>e.fold(Y("before"),Y("start"),Y("end"),Y("after")),dB=e=>e.fold(QO.before,QO.before,QO.after,QO.after),cB=e=>e.fold(QO.start,QO.start,QO.end,QO.end),mB=(e,t)=>lB(e)===lB(t)&&iB(e)===iB(t),uB=(e,t,n,o,r,s)=>En(Rw(t,n,o),Rw(t,n,r),((t,o)=>t!==o&&Dw(n,t,o)?QO.after(e?t:o):s)).getOr(s),fB=(e,t)=>e.fold(oe,(e=>!mB(e,t))),gB=(t,n,o,r,s)=>{const a=Tw(t,s);return tg(t,o,a).map(e(Tw,t)).fold((()=>r.map(dB)),(s=>aB(n,o,s).map(e(uB,t,n,o,a,s)).filter(e(fB,r)))).filter(sB)},pB=(e,t)=>e?t.fold(K(re.some,QO.start),re.none,K(re.some,QO.after),re.none):t.fold(re.none,K(re.some,QO.before),re.none,K(re.some,QO.end)),hB=(t,n,o,r)=>{const s=Tw(t,r),a=aB(n,o,s);return aB(n,o,s).bind(e(pB,t)).orThunk((()=>gB(t,n,o,a,r)))},bB=e=>V(e.selection.getSel().modify),yB=(e,t,n)=>{const o=e?1:-1;return t.setRng(Xd(n.container(),n.offset()+o).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},vB=(e,t)=>{const n=t.selection.getRng(),o=e?Xd.fromRangeEnd(n):Xd.fromRangeStart(n);return!!bB(t)&&(e&&Sa(o)?yB(!0,t.selection,o):!(e||!_a(o))&&yB(!1,t.selection,o))};var CB;!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(CB||(CB={}));const wB=(e,t)=>e===Pf.Backwards?_e(t):t,xB=(e,t,n)=>e===Pf.Forwards?t.next(n):t.prev(n),kB=(e,t,n,o)=>as(o.getNode(t===Pf.Forwards))?CB.Br:!1===Cf(n,o)?CB.Block:CB.Wrap,SB=(e,t,n,o)=>{const r=Kf(n);let s=o;const a=[];for(;s;){const o=xB(t,r,s);if(!o)break;if(as(o.getNode(!1)))return t===Pf.Forwards?{positions:wB(t,a).concat([o]),breakType:CB.Br,breakAt:re.some(o)}:{positions:wB(t,a),breakType:CB.Br,breakAt:re.some(o)};if(o.isVisible()){if(e(s,o)){const e=kB(n,t,s,o);return{positions:wB(t,a),breakType:e,breakAt:re.some(o)}}a.push(o),s=o}else s=o}return{positions:wB(t,a),breakType:CB.Eol,breakAt:re.none()}},_B=(e,t,n,o)=>t(n,o).breakAt.map((o=>{const r=t(n,o).positions;return e===Pf.Backwards?r.concat(o):[o].concat(r)})).getOr([]),EB=(e,t)=>ye(e,((e,n)=>e.fold((()=>re.some(n)),(o=>En(Ae(o.getClientRects()),Ae(n.getClientRects()),((e,r)=>{const s=Math.abs(t-e.left);return Math.abs(t-r.left)<=s?n:o})).or(e)))),re.none()),NB=(e,t)=>Ae(t.getClientRects()).bind((t=>EB(e,t.left))),RB=e(SB,Xd.isAbove,-1),DB=e(SB,Xd.isBelow,1),AB=e(_B,-1,RB),TB=e(_B,1,DB),OB=(e,t)=>RB(e,t).breakAt.isNone(),BB=(e,t)=>DB(e,t).breakAt.isNone(),PB=e=>ig(e).map((t=>[t].concat(DB(e,t).positions))).getOr([]),LB=e=>lg(e).map((t=>RB(e,t).positions.concat(t))).getOr([]),MB=(e,t)=>NB(AB(e,t),t),IB=(e,t)=>NB(TB(e,t),t),FB=ds,UB=(e,t)=>Math.abs(e.left-t),zB=(e,t)=>Math.abs(e.right-t),jB=e=>Ge(e,"node"),HB=(e,t)=>ot(e,((e,n)=>{const o=Math.min(UB(e,t),zB(e,t)),r=Math.min(UB(n,t),zB(n,t));return r===o&&jB(n)&&FB(n.node)||r<o?n:e})),VB=e=>{const t=t=>ue(t,(t=>{const n=ud(t);return n.node=e,n}));if($r(e))return t(e.getClientRects());if(es(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}return[]},$B=e=>ke(e,VB);var qB;!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(qB||(qB={}));const WB=(e,t,n,o)=>{for(;o=bf(o,e,Wa,t);)if(n(o))return},KB=(e,t,n,o,r,s)=>{let a=0;const i=[],l=o=>{let s=$B([o]);-1===e&&(s=s.reverse());for(let e=0;e<s.length;e++){const o=s[e];if(!n(o,d)){if(i.length>0&&t(o,st(i))&&a++,o.line=a,r(o))return!0;i.push(o)}}},d=st(s.getClientRects());if(!d)return i;const c=s.getNode();return l(c),WB(e,o,l,c),i},GB=(e,t)=>t.line>e,YB=(e,t)=>t.line===e,XB=e(KB,qB.Up,hd,bd),QB=e(KB,qB.Down,bd,hd),JB=(e,t,n,o)=>{const r=Kf(t);let s,a,i,l;const d=[];let c=0;const m=e=>st(e.getClientRects());1===e?(s=r.next,a=bd,i=hd,l=Xd.after(o)):(s=r.prev,a=hd,i=bd,l=Xd.before(o));const u=m(l);do{if(!l.isVisible())continue;const e=m(l);if(i(e,u))continue;d.length>0&&a(e,st(d))&&c++;const t=ud(e);if(t.position=l,t.line=c,n(t))return d;d.push(t)}while(l=s(l));return d},ZB=e=>t=>GB(e,t),eP=e=>t=>YB(e,t),tP=(e,t)=>{e.selection.setRng(t),ly(e,e.selection.getRng())},nP=(e,t,n)=>re.some(lO(e,t,n)),oP=(t,n,o,r,s,a)=>{const i=n===Pf.Forwards,l=Kf(t.getBody()),d=e(Of,i?l.next:l.prev),c=i?r:s;if(!o.collapsed){const e=kd(o);if(a(e))return rO(n,t,e,n===Pf.Backwards,!1);if(hO(t)){const e=o.cloneRange();return e.collapse(n===Pf.Backwards),re.from(e)}}const m=Df(n,t.getBody(),o);if(c(m))return aO(t,m.getNode(!i));const u=Tw(i,d(m)),f=Ta(o);if(!u)return f?re.some(o):re.none();if(c(u))return rO(n,t,u.getNode(!i),i,!1);const g=d(u);return g&&c(g)&&Bf(u,g)?rO(n,t,g.getNode(!i),i,!1):f?nP(t,u.toRange(),!1):re.none()},rP=(e,t,n,o,r,s)=>{const a=Df(t,e.getBody(),n),i=st(a.getClientRects()),l=t===qB.Down,d=e.getBody();if(!i)return re.none();if(hO(e)){const e=l?Xd.fromRangeEnd(n):Xd.fromRangeStart(n);return(l?IB:MB)(d,e).orThunk((()=>re.from(e))).map((e=>e.toRange()))}const c=(l?QB:XB)(d,ZB(1),a),m=he(c,eP(1)),u=i.left,f=HB(m,u);if(f&&s(f.node)){const n=Math.abs(u-f.left),o=Math.abs(u-f.right);return rO(t,e,f.node,n<o,!1)}let g;if(g=o(a)?a.getNode():r(a)?a.getNode(!0):kd(n),g){const n=JB(t,d,ZB(1),g);let o=HB(he(n,eP(1)),u);if(o)return nP(e,o.position.toRange(),!1);if(o=st(he(n,eP(0))),o)return nP(e,o.position.toRange(),!1)}return 0===m.length?sP(e,l).filter(l?r:o).map((t=>lO(e,t.toRange(),!1))):re.none()},sP=(e,t)=>{const n=e.selection.getRng(),o=t?Xd.fromRangeEnd(n):Xd.fromRangeStart(n),r=yf(o.container(),e.getBody());if(t){const e=DB(r,o);return Te(e.positions)}{const e=RB(r,o);return Ae(e.positions)}},aP=(e,t,n)=>sP(e,t).filter(n).exists((t=>(e.selection.setRng(t.toRange()),!0))),iP=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},lP=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},dP=(e,t,n)=>YO(t,n).map((t=>(iP(e,t),n))),cP=(e,t,n)=>{const o=Xd.fromRangeStart(e);if(e.collapsed)return o;{const r=Xd.fromRangeEnd(e);return n?ag(t,r).getOr(r):sg(t,o).getOr(o)}},mP=(t,n,o)=>{const r=t.getBody(),s=cP(t.selection.getRng(),r,o),a=e(_w,t);return hB(o,a,r,s).bind((e=>dP(t,n,e)))},uP=(t,n,o)=>{const r=ue(ra(bo.fromDom(n.getRoot()),'*[data-mce-selected="inline-boundary"]'),(e=>e.dom)),s=he(r,t),a=he(o,t);fe(Ee(s,a),e(lP,!1)),fe(Ee(a,s),e(lP,!0))},fP=(e,t)=>{if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){const n=Xd.fromRangeStart(e.selection.getRng());Xd.isTextPosition(n)&&!1===Aw(n)&&(iP(e,Ku(t.get(),n)),t.set(null))}},gP=(e,t,n,o)=>{if(t.selection.isCollapsed()){const r=he(o,e);fe(r,(()=>{const o=Xd.fromRangeStart(t.selection.getRng());aB(e,t.getBody(),o).bind((e=>dP(t,n,e)))}))}},pP=(e,t,n)=>!!$m(e)&&mP(e,t,n).isSome(),hP=(e,t)=>!!$m(t)&&vB(e,t),bP=t=>{const n=Sl(null),o=e(_w,t);return t.on("NodeChange",(e=>{$m(t)&&(uP(o,t.dom,e.parents),fP(t,n),gP(o,t,n,e.parents))})),n},yP=e(hP,!0),vP=e(hP,!1),CP=(t,n,o)=>{if($m(t)){const r=sP(t,n).getOrThunk((()=>{const e=t.selection.getRng();return n?Xd.fromRangeEnd(e):Xd.fromRangeStart(e)}));return aB(e(_w,t),t.getBody(),r).exists((e=>{const n=dB(e);return YO(o,n).exists((e=>(iP(t,e),!0)))}))}return!1},wP=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},xP=e=>En(ig(e),lg(e),((t,n)=>{const o=Tw(!0,t),r=Tw(!1,n);return sg(e,o).forall((e=>e.isEqual(r)))})).getOr(!0),kP=(e,t)=>n=>YO(t,n).map((t=>()=>iP(e,t))),SP=(t,n,o,r)=>{const s=t.getBody(),a=e(_w,t);t.undoManager.ignore((()=>{t.selection.setRng(wP(o,r)),Lw(t),aB(a,s,Xd.fromRangeStart(t.selection.getRng())).map(cB).bind(kP(t,n)).each(te)})),t.nodeChanged()},_P=(e,t)=>{const n=vf(t,e);return n||e},EP=(t,n,o,r)=>{const s=_P(t.getBody(),r.container()),a=e(_w,t),i=aB(a,s,r);return i.bind((e=>o?e.fold(Y(re.some(cB(e))),re.none,Y(re.some(dB(e))),re.none):e.fold(re.none,Y(re.some(dB(e))),re.none,Y(re.some(cB(e)))))).map(kP(t,n)).getOrThunk((()=>{const e=ng(o,s,r),l=e.bind((e=>aB(a,s,e)));return En(i,l,(()=>Rw(a,s,r).bind((e=>xP(e)?re.some((()=>{xw(t,o,bo.fromDom(e))})):re.none())))).getOrThunk((()=>l.bind((()=>e.map((e=>()=>{o?SP(t,n,r,e):SP(t,n,e,r)}))))))}))},NP=(e,t,n)=>{if(e.selection.isCollapsed()&&$m(e)){const o=Xd.fromRangeStart(e.selection.getRng());return EP(e,t,n,o)}return re.none()},RP=(e,t)=>{const n=gC(t,e);return we(n,zs).fold(Y(n),(e=>n.slice(0,e)))},DP=e=>1===jo(e),AP=(t,n,o,r)=>{const s=e(kS,n),a=ue(he(r,s),(e=>e.dom));if(0===a.length)xw(n,t,o);else{const e=xS(o.dom,a);n.selection.setRng(e.toRange())}},TP=(e,t)=>{const n=bo.fromDom(e.getBody()),o=bo.fromDom(e.selection.getStart()),r=he(RP(n,o),DP);return Te(r).bind((n=>{const o=Xd.fromRangeStart(e.selection.getRng());return jw(t,o,n.dom)&&!SS(n)?re.some((()=>AP(t,e,n,r))):re.none()}))},OP=(e,t)=>e.selection.isCollapsed()?TP(e,t):re.none(),BP=(e,t,n)=>re.some((()=>{e._selectionOverrides.hideFakeCaret(),xw(e,t,bo.fromDom(n))})),PP=(e,t)=>{const n=t?sC:aC,o=t?Pf.Forwards:Pf.Backwards,r=Df(o,e.getBody(),e.selection.getRng());return n(r)?BP(e,t,r.getNode(!t)):re.from(Tw(t,r)).filter((e=>n(e)&&Bf(r,e))).map((n=>()=>BP(e,t,n.getNode(!t))))},LP=(e,t)=>{const n=e.selection.getNode();return ms(n)?BP(e,t,n):re.none()},MP=(e,t)=>e.selection.isCollapsed()?PP(e,t):LP(e,t),IP=e=>vs(e,(e=>ls(e.dom)||ds(e.dom))).exists((e=>ls(e.dom))),FP=e=>{const t=parseInt(e,10);return isNaN(t)?0:t},UP=(e,t)=>(e||js(t)?"margin":"padding")+("rtl"===or(t,"direction")?"-right":"-left"),zP=(e,t,n,o,r,s)=>{const a=UP(n,bo.fromDom(s));if("outdent"===t){const t=Math.max(0,FP(s.style[a])-o);e.setStyle(s,a,t?t+r:"")}else{const t=FP(s.style[a])+o+r;e.setStyle(s,a,t)}},jP=(e,t)=>Se(t,(t=>{const n=UP(Rm(e),t),o=sr(t,n).map(FP).getOr(0);return"false"!==e.dom.getContentEditable(t.dom)&&o>0})),HP=e=>{const t=qP(e);return!e.mode.isReadOnly()&&(t.length>1||jP(e,t))},VP=e=>qs(e)||Ws(e),$P=e=>Do(e).exists(VP),qP=e=>he(Cr(e.selection.getSelectedBlocks()),(e=>!VP(e)&&!$P(e)&&IP(e))),WP=(e,t)=>{const{dom:n}=e,o=Dm(e),r=/[a-z%]+$/i.exec(o)[0],s=parseInt(o,10),a=Rm(e);fe(qP(e),(e=>{zP(n,t,a,s,r,e.dom)}))},KP=e=>WP(e,"indent"),GP=e=>WP(e,"outdent"),YP=e=>{if(e.selection.isCollapsed()&&HP(e)){const t=e.dom,n=e.selection.getRng(),o=Xd.fromRangeStart(n),r=t.getParent(n.startContainer,t.isBlock);if(null!==r&&vC(bo.fromDom(r),o))return re.some((()=>GP(e)))}return re.none()},XP=(e,t,n)=>Be([YP,LO,gO,(e,n)=>NP(e,t,n),GT,Fx,IO,MP,tO,OP],(t=>t(e,n))),QP=(e,t)=>{XP(e,t,!1).fold((()=>{Lw(e),zw(e)}),te)},JP=(e,t)=>{XP(e,t,!0).fold((()=>Mw(e)),te)},ZP=(e,t)=>{e.addCommand("delete",(()=>{QP(e,t)})),e.addCommand("forwardDelete",(()=>{JP(e,t)}))},eL=5,tL=400,nL=e=>void 0===e.touches||1!==e.touches.length?re.none():re.some(e.touches[0]),oL=(e,t)=>{const n=Math.abs(e.clientX-t.x),o=Math.abs(e.clientY-t.y);return n>eL||o>eL},rL=e=>{const t=Ml(),n=Sl(!1),o=Fl((t=>{e.dispatch("longpress",{...t,type:"longpress"}),n.set(!0)}),tL);e.on("touchstart",(e=>{nL(e).each((r=>{o.cancel();const s={x:r.clientX,y:r.clientY,target:e.target};o.throttle(e),n.set(!1),t.set(s)}))}),!0),e.on("touchmove",(r=>{o.cancel(),nL(r).each((o=>{t.on((r=>{oL(o,r)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(r=>{o.cancel(),"touchcancel"!==r.type&&t.get().filter((e=>e.target.isEqualNode(r.target))).each((()=>{n.get()?r.preventDefault():e.dispatch("tap",{...r,type:"tap"})}))}),!0)},sL=(e,t)=>Ke(e,t.nodeName),aL=(e,t)=>!!es(t)||!!$r(t)&&(!sL(e,t)&&!Bg(t)),iL=(e,t,n)=>me(fC(bo.fromDom(n),bo.fromDom(t)),(t=>sL(e,t.dom))),lL=(e,t)=>{if(es(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||sL(e,t.nextSibling)))return!0}return!1},dL=e=>e.dom.create(lm(e),dm(e)),cL=e=>{const t=e.dom,n=e.selection,o=e.schema,r=o.getBlockElements();let s=n.getStart();const a=e.getBody();let i,l,d;const c=lm(e);if(!s||!$r(s))return;const m=a.nodeName.toLowerCase();if(!o.isValidChild(m,c.toLowerCase())||iL(r,a,s))return;const u=n.getRng(),f=u.startContainer,g=u.startOffset,p=u.endContainer,h=u.endOffset,b=Zy(e);for(s=a.firstChild;s;)if(aL(r,s)){if(lL(r,s)){l=s,s=s.nextSibling,t.remove(l);continue}i||(i=dL(e),s.parentNode.insertBefore(i,s),d=!0),l=s,s=s.nextSibling,i.appendChild(l)}else i=null,s=s.nextSibling;d&&b&&(u.setStart(f,g),u.setEnd(p,h),n.setRng(u),e.nodeChanged())},mL=(e,t,n)=>{const o=bo.fromDom(dL(e)),r=ma();ur(o,r),n(t,o);const s=document.createRange();return s.setStartBefore(r.dom),s.setEndBefore(r.dom),s},uL=t=>{t.on("NodeChange",e(cL,t))},fL=e=>t=>-1!==(" "+t.attr("class")+" ").indexOf(e),gL=(e,t,n)=>function(o){const r=arguments,s=r[r.length-2],a=s>0?t.charAt(s-1):"";if('"'===a)return o;if(">"===a){const e=t.lastIndexOf("<",s);if(-1!==e){if(-1!==t.substring(e,s).indexOf('contenteditable="false"'))return o}}
return'<span class="'+n+'" data-mce-content="'+e.dom.encode(r[0])+'">'+e.dom.encode("string"==typeof r[1]?r[1]:r[0])+"</span>"},pL=(e,t,n)=>{let o=t.length,r=n.content;if("raw"!==n.format){for(;o--;)r=r.replace(t[o],gL(e,r,Du(e)));n.content=r}},hL=e=>{const t="contenteditable",n=" "+kn.trim(Au(e))+" ",o=" "+kn.trim(Du(e))+" ",r=fL(n),s=fL(o),a=Tu(e);a.length>0&&e.on("BeforeSetContent",(t=>{pL(e,a,t)})),e.parser.addAttributeFilter("class",(e=>{let n=e.length;for(;n--;){const o=e[n];r(o)?o.attr(t,"true"):s(o)&&o.attr(t,"false")}})),e.serializer.addAttributeFilter(t,(e=>{let n=e.length;for(;n--;){const o=e[n];(r(o)||s(o))&&(a.length>0&&o.attr("data-mce-content")?(o.name="#text",o.type=3,o.raw=!0,o.value=o.attr("data-mce-content")):o.attr(t,null))}}))},bL=e=>Ss(bo.fromDom(e.getBody()),"*[data-mce-caret]").map((e=>e.dom)).getOrNull(),yL=(e,t)=>{t.hasAttribute("data-mce-caret")&&(Aa(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},vL=(e,t)=>{const n=bL(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void yL(e,n)):void(xa(n)&&(yL(e,n),e.undoManager.add()))},CL=t=>{t.on("keyup compositionstart",e(vL,t))},wL=ds,xL=(e,t,n)=>oP(t,e,n,dC,cC,wL),kL=(e,t,n)=>rP(t,e,n,(e=>dC(e)||iC(e)),(e=>cC(e)||lC(e)),wL),SL=e=>{const t=e.dom.create(lm(e));return t.innerHTML='<br data-mce-bogus="1">',t},_L=(t,n,o)=>{const r=Kf(t.getBody()),s=e(Of,1===n?r.next:r.prev);if(o.collapsed){const e=t.dom.getParent(o.startContainer,"PRE");if(!e)return;if(!s(Xd.fromRangeStart(o))){const o=bo.fromDom(SL(t));1===n?cr(bo.fromDom(e),o):dr(bo.fromDom(e),o),t.selection.select(o.dom,!0),t.selection.collapse()}}},EL=(e,t)=>{const n=t?Pf.Forwards:Pf.Backwards,o=e.selection.getRng();return xL(n,e,o).orThunk((()=>(_L(e,n,o),re.none())))},NL=(e,t)=>{const n=t?1:-1,o=e.selection.getRng();return kL(n,e,o).orThunk((()=>(_L(e,n,o),re.none())))},RL=(e,t)=>EL(e,t).exists((t=>(tP(e,t),!0))),DL=(e,t)=>NL(e,t).exists((t=>(tP(e,t),!0))),AL=(e,t)=>aP(e,t,t?cC:dC),TL=(e,t)=>pO(e,!t).map((n=>{const o=n.toRange(),r=e.selection.getRng();return t?o.setStart(r.startContainer,r.startOffset):o.setEnd(r.endContainer,r.endOffset),o})).exists((t=>(tP(e,t),!0))),OL=e=>ce(["figcaption"],Pn(e)),BL=(t,n)=>{const o=e(ko,n);return vs(bo.fromDom(t.container()),zs,o).filter(OL)},PL=(e,t,n)=>t?BB(e.dom,n):OB(e.dom,n),LL=(e,t)=>{const n=bo.fromDom(e.getBody()),o=Xd.fromRangeStart(e.selection.getRng());return BL(o,n).exists((()=>{if(PL(n,t,o)){const o=mL(e,n,t?ur:mr);return e.selection.setRng(o),!0}return!1}))},ML=(e,t)=>!!e.selection.isCollapsed()&&LL(e,t),IL={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},FL=e=>ue(e,(e=>({...IL,action:W,...e}))),UL=e=>ue(e,(e=>({...IL,action:()=>re.none(),...e}))),zL=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,jL=(e,t)=>ke(FL(e),(e=>zL(e,t)?[e]:[])),HL=(e,t)=>ke(UL(e),(e=>zL(e,t)?[e]:[])),VL=(e,...t)=>()=>e.apply(null,t),$L=(e,t)=>Ce(jL(e,t),(e=>e.action())),qL=(e,t)=>Be(HL(e,t),(e=>e.action())),WL=(e,t)=>{const n=t?Pf.Forwards:Pf.Backwards,o=e.selection.getRng();return oP(e,n,o,sC,aC,ms).exists((t=>(tP(e,t),!0)))},KL=(e,t)=>{const n=t?1:-1,o=e.selection.getRng();return rP(e,n,o,sC,aC,ms).exists((t=>(tP(e,t),!0)))},GL=(e,t)=>aP(e,t,t?aC:sC),YL=Mc.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),XL=e=>YL.none(e),QL={...YL,none:XL},JL=(e,t)=>ZL(e,t,oe),ZL=(e,t,n)=>ke(Io(e),(e=>vo(e,t)?n(e)?[e]:[]:ZL(e,t,n))),eM=(e,t,n=ne)=>{if(n(t))return re.none();if(ce(e,Pn(t)))return re.some(t);const o=e=>vo(e,"table")||n(e);return ks(t,e.join(","),o)},tM=(e,t)=>eM(["td","th"],e,t),nM=e=>JL(e,"th,td"),oM=(e,t)=>_s(e,"table",t),rM=(e,t,n,o,r=oe)=>{const s=1===o;if(!s&&n<=0)return QL.first(e[0]);if(s&&n>=e.length-1)return QL.last(e[e.length-1]);{const s=n+o,a=e[s];return r(a)?QL.middle(t,a):rM(e,t,s,o,r)}},sM=(e,t)=>oM(e,t).bind((t=>{const n=nM(t);return we(n,(t=>ko(e,t))).map((e=>({index:e,all:n})))})),aM=(e,t,n)=>sM(e,n).fold((()=>QL.none(e)),(n=>rM(n.all,e,n.index,1,t))),iM=(e,t,n)=>sM(e,n).fold((()=>QL.none()),(n=>rM(n.all,e,n.index,-1,t))),lM=e=>_s(e,"[contenteditable]"),dM=(e,t=!1)=>Jo(e)?e.dom.isContentEditable:lM(e).fold(Y(t),(e=>"true"===cM(e))),cM=e=>e.dom.contentEditable,mM=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}),uM=(e,t)=>ke(t,(t=>{const n=mM(ud(t.getBoundingClientRect()),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]})),fM=(e,t,n)=>ye(e,((e,o)=>e.fold((()=>re.some(o)),(e=>{const r=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),s=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return re.some(s<r?o:e)}))),re.none()),gM=(e,t,n,o,r)=>{const s=ra(bo.fromDom(n),"td,th,caption").map((e=>e.dom)),a=he(uM(e,s),(e=>t(e,r)));return fM(a,o,r).map((e=>e.cell))},pM=e=>e.top,hM=(e,t)=>e.y>t,bM=e(gM,(e=>e.bottom),((e,t)=>e.y<t)),yM=e(gM,pM,hM),vM=(e,t)=>Ae(t.getClientRects()).bind((t=>bM(e,t.left,t.top))).bind((e=>NB(LB(e),t))),CM=(e,t)=>Te(t.getClientRects()).bind((t=>yM(e,t.left,t.top))).bind((e=>NB(PB(e),t))),wM=(e,t,n)=>n.breakAt.exists((n=>e(t,n).breakAt.isSome())),xM=e=>e.breakType===CB.Wrap&&0===e.positions.length,kM=e=>e.breakType===CB.Br&&1===e.positions.length,SM=(e,t,n)=>{const o=e(t,n);return xM(o)||!as(n.getNode())&&kM(o)?!wM(e,t,o):o.breakAt.isNone()},_M=e(SM,RB),EM=e(SM,DB),NM=(e,t,n)=>{const o=Xd.fromRangeStart(t);return rg(!e,n).exists((e=>e.isEqual(o)))},RM=(e,t,n)=>{const o=e.selection.getRng(),r=t?1:-1;return!(!nf()||!NM(t,o,n))&&(rO(r,e,n,!t,!1).each((t=>{tP(e,t)})),!0)},DM=(e,t,n)=>vM(t,n).orThunk((()=>Ae(n.getClientRects()).bind((n=>EB(AB(e,Xd.before(t)),n.left))))).getOr(Xd.before(t)),AM=(e,t,n)=>CM(t,n).orThunk((()=>Ae(n.getClientRects()).bind((n=>EB(TB(e,Xd.after(t)),n.left))))).getOr(Xd.after(t)),TM=(e,t)=>{const n=t.getNode(e);return Qr(n)?re.some(n):re.none()},OM=(e,t,n)=>{t.undoManager.transact((()=>{const o=e?cr:dr,r=mL(t,bo.fromDom(n),o);tP(t,r)}))},BM=(e,t,n)=>{const o=TM(!!t,n),r=!1===t;o.fold((()=>tP(e,n.toRange())),(o=>rg(r,e.getBody()).filter((e=>e.isEqual(n))).fold((()=>tP(e,n.toRange())),(()=>OM(t,e,o)))))},PM=(e,t,n,o)=>{const r=e.selection.getRng(),s=Xd.fromRangeStart(r),a=e.getBody();if(!t&&_M(o,s)){const o=DM(a,n,s);return BM(e,t,o),!0}if(t&&EM(o,s)){const o=AM(a,n,s);return BM(e,t,o),!0}return!1},LM=(e,t,n)=>re.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((o=>re.from(e.dom.getParent(o,"table")).map((r=>n(e,t,r,o))))).getOr(!1),MM=(e,t)=>LM(e,t,RM),IM=(e,t)=>LM(e,t,PM),FM=e=>{const t=ab.exact(e,0,e,0);return ub(t)},UM=(e,t,n)=>n.fold(re.none,re.none,((e,t)=>hv(t).map((e=>FM(e)))),(n=>(e.execCommand("mceTableInsertRowAfter"),zM(e,t,n)))),zM=(e,t,n)=>UM(e,t,aM(n,dM)),jM=(e,t,n)=>UM(e,t,iM(n,dM)),HM=(e,t)=>{const n=["table","li","dl"],o=bo.fromDom(e.getBody()),r=e=>{const t=Pn(e);return ko(e,o)||ce(n,t)},s=e.selection.getRng(),a=bo.fromDom(t?s.endContainer:s.startContainer);return tM(a,r).map((n=>{oM(n,r).each((t=>{e.model.table.clearSelectedCells(t.dom)})),e.selection.collapse(!t);return(t?zM:jM)(e,r,n).each((t=>{e.selection.setRng(t)})),!0})).getOr(!1)},VM=(e,t,n)=>{const o=pn.os.isMacOS()||pn.os.isiOS();$L([{keyCode:Dh.RIGHT,action:VL(RL,e,!0)},{keyCode:Dh.LEFT,action:VL(RL,e,!1)},{keyCode:Dh.UP,action:VL(DL,e,!1)},{keyCode:Dh.DOWN,action:VL(DL,e,!0)},...o?[{keyCode:Dh.UP,action:VL(TL,e,!1),metaKey:!0,shiftKey:!0},{keyCode:Dh.DOWN,action:VL(TL,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:Dh.RIGHT,action:VL(MM,e,!0)},{keyCode:Dh.LEFT,action:VL(MM,e,!1)},{keyCode:Dh.UP,action:VL(IM,e,!1)},{keyCode:Dh.DOWN,action:VL(IM,e,!0)},{keyCode:Dh.RIGHT,action:VL(WL,e,!0)},{keyCode:Dh.LEFT,action:VL(WL,e,!1)},{keyCode:Dh.UP,action:VL(KL,e,!1)},{keyCode:Dh.DOWN,action:VL(KL,e,!0)},{keyCode:Dh.RIGHT,action:VL(pP,e,t,!0)},{keyCode:Dh.LEFT,action:VL(pP,e,t,!1)},{keyCode:Dh.RIGHT,ctrlKey:!o,altKey:o,action:VL(yP,e,t)},{keyCode:Dh.LEFT,ctrlKey:!o,altKey:o,action:VL(vP,e,t)},{keyCode:Dh.UP,action:VL(ML,e,!1)},{keyCode:Dh.DOWN,action:VL(ML,e,!0)}],n).each((()=>{n.preventDefault()}))},$M=(e,t)=>{e.on("keydown",(n=>{!1===n.isDefaultPrevented()&&VM(e,t,n)}))},qM=(e,t)=>({container:e,offset:t}),WM=bl.DOM,KM=e=>t=>e===t?-1:0,GM=e=>t=>e.isBlock(t)||ce(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===e.getContentEditable(t),YM=(e,t,n)=>{if(es(e)&&t>=0)return re.some(qM(e,t));{const o=cd(WM);return re.from(o.backwards(e,t,KM(e),n)).map((e=>qM(e.container,e.container.data.length)))}},XM=(e,t,n)=>{if(es(e)&&t>=e.length)return re.some(qM(e,t));{const o=cd(WM);return re.from(o.forwards(e,t,KM(e),n)).map((e=>qM(e.container,0)))}},QM=(e,t,n)=>{if(!es(e))return re.none();const o=e.textContent;if(t>=0&&t<=o.length)return re.some(qM(e,t));{const o=cd(WM);return re.from(o.backwards(e,t,KM(e),n)).bind((e=>{const o=e.container.data;return QM(e.container,t+o.length,n)}))}},JM=(e,t,n)=>{if(!es(e))return re.none();const o=e.textContent;if(t<=o.length)return re.some(qM(e,t));{const r=cd(WM);return re.from(r.forwards(e,t,KM(e),n)).bind((e=>JM(e.container,t-o.length,n)))}},ZM=(e,t,n,o,r)=>{const s=cd(e,GM(e));return re.from(s.backwards(t,n,o,r))},eI=e=>e.collapsed&&3===e.startContainer.nodeType,tI=e=>e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,""),nI=e=>""!==e&&-1!==" \xa0\f\n\r\t\v".indexOf(e),oI=(e,t)=>e.substring(t.length),rI=(e,t,n)=>{let o;for(o=t-1;o>=0;o--){const t=e.charAt(o);if(nI(t))return re.none();if(t===n)break}return re.some(o)},sI=(e,t,n,o=0)=>{if(!eI(t))return re.none();const r=(e,t,o)=>rI(o,t,n).getOr(t),s=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return ZM(e,t.startContainer,t.startOffset,r,s).bind((e=>{const r=t.cloneRange();if(r.setStart(e.container,e.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return re.none();const s=tI(r);return 0!==s.lastIndexOf(n)||oI(s,n).length<o?re.none():re.some({text:oI(s,n),range:r,triggerChar:n})}))},aI=(e,t,n,o=0)=>wv(bo.fromDom(t.startContainer)).fold((()=>sI(e,t,n,o)),(t=>{const o=e.createRng();o.selectNode(t.dom);const r=tI(o);return re.some({range:o,text:oI(r,n),triggerChar:n})})),iI=e=>e.nodeType===Bn,lI=e=>e.nodeType===On,dI=e=>{if(iI(e))return qM(e,e.data.length);{const t=e.childNodes;return t.length>0?dI(t[t.length-1]):qM(e,t.length)}},cI=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?cI(n[t],0):n.length>0&&lI(e)&&n.length===t?dI(n[n.length-1]):qM(e,t)},mI=(e,t)=>{const n=e.getParent(t.container,e.isBlock);return ZM(e,t.container,t.offset,((e,t)=>0===t?-1:t),n).filter((e=>{const t=e.container.data.charAt(e.offset-1);return!nI(t)})).isSome()},uI=e=>t=>{const n=cI(t.startContainer,t.startOffset);return!mI(e,n)},fI=(e,t,n)=>Be(n.triggerChars,(n=>aI(e,t,n))),gI=(e,t)=>{const n=t(),o=e.selection.getRng();return fI(e.dom,o,n).bind((n=>pI(e,t,n)))},pI=(e,t,n,o={})=>{const r=t(),s=e.selection.getRng().startContainer.nodeValue,a=he(r.lookupByChar(n.triggerChar),(t=>n.text.length>=t.minChars&&t.matches.getOrThunk((()=>uI(e.dom)))(n.range,s,n.text)));if(0===a.length)return re.none();const i=Promise.all(ue(a,(e=>e.fetch(n.text,e.maxResults,o).then((t=>({matchText:n.text,items:t,columns:e.columns,onAction:e.onAction,highlightOn:e.highlightOn}))))));return re.some({lookupData:i,context:n})};var hI;!function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"}(hI||(hI={}));const bI=(e,t,n)=>e.stype===hI.Error?t(e.serror):n(e.svalue),yI=e=>{const t=[],n=[];return fe(e,(e=>{bI(e,(e=>n.push(e)),(e=>t.push(e)))})),{values:t,errors:n}},vI=e=>({stype:hI.Value,svalue:e}),CI=e=>({stype:hI.Error,serror:e}),wI={fromResult:e=>e.fold(CI,vI),toResult:e=>bI(e,Pc.error,Pc.value),svalue:vI,partition:yI,serror:CI,bind:(e,t)=>e.stype===hI.Value?t(e.svalue):e,bindError:(e,t)=>e.stype===hI.Error?t(e.serror):e,map:(e,t)=>e.stype===hI.Value?{stype:hI.Value,svalue:t(e.svalue)}:e,mapError:(e,t)=>e.stype===hI.Error?{stype:hI.Error,serror:t(e.serror)}:e,fold:bI},xI=e=>L(e)&&Le(e).length>100?" removed due to size":JSON.stringify(e,null,2),kI=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:Y("... (only showing first ten failures)")}]):e;return ue(t,(e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()))},SI=(e,t)=>wI.serror([{path:e,getErrorInfo:t}]),_I=(e,t,n)=>SI(e,(()=>'Could not find valid *required* value for "'+t+'" in '+xI(n))),EI=(e,t)=>SI(e,(()=>'Choice schema did not contain choice key: "'+t+'"')),NI=(e,t,n)=>SI(e,(()=>'The chosen schema: "'+n+'" did not exist in branches: '+xI(t))),RI=(e,t)=>SI(e,Y(t)),DI=(e,t,n,o)=>We(n,o).fold((()=>NI(e,n,o)),(n=>n.extract(e.concat(["branch: "+o]),t))),AI=(e,t)=>({extract:(n,o)=>We(o,e).fold((()=>EI(n,e)),(e=>DI(n,o,t,e))),toString:()=>"chooseOn("+e+"). Possible values: "+Le(t)}),TI=(e,t)=>t,OI=(e,t)=>M(e)&&M(t)?PI(e,t):t,BI=e=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");const n={};for(let o=0;o<t.length;o++){const r=t[o];for(const t in r)Ke(r,t)&&(n[t]=e(n[t],r[t]))}return n},PI=BI(OI),LI=BI(TI),MI=()=>({tag:"required",process:{}}),II=e=>({tag:"defaultedThunk",process:e}),FI=e=>II(Y(e)),UI=()=>({tag:"option",process:{}}),zI=(e,t)=>e.length>0?wI.svalue(PI(t,LI.apply(void 0,e))):wI.svalue(t),jI=e=>K(wI.serror,xe)(e),HI=(e,t)=>{const n=wI.partition(e);return n.errors.length>0?jI(n.errors):zI(n.values,t)},VI={consolidateObj:HI,consolidateArr:e=>{const t=wI.partition(e);return t.errors.length>0?jI(t.errors):wI.svalue(t.values)}},$I=(e,t,n,o)=>({tag:"field",key:e,newKey:t,presence:n,prop:o}),qI=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),WI=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},KI=e=>({extract:(t,n)=>wI.bindError(e(n),(e=>RI(t,e))),toString:Y("val")}),GI=KI(wI.svalue),YI=(e,t,n,o)=>We(t,n).fold((()=>_I(e,n,t)),o),XI=(e,t,n,o)=>o(We(e,t).getOrThunk((()=>n(e)))),QI=(e,t,n)=>n(We(e,t)),JI=(e,t,n,o)=>o(We(e,t).map((t=>!0===t?n(e):t))),ZI=(e,t,n,o,r)=>{const s=e=>r.extract(t.concat([o]),e),a=e=>e.fold((()=>wI.svalue(re.none())),(e=>{const n=r.extract(t.concat([o]),e);return wI.map(n,re.some)}));switch(e.tag){case"required":return YI(t,n,o,s);case"defaultedThunk":return XI(n,o,e.process,s);case"option":return QI(n,o,a);case"defaultedOptionThunk":return JI(n,o,e.process,a);case"mergeWithThunk":return XI(n,o,Y({}),(t=>{const o=PI(e.process(n),t);return s(o)}))}},eF=(e,t,n)=>{const o={},r=[];for(const s of n)WI(s,((n,s,a,i)=>{const l=ZI(a,e,t,n,i);wI.fold(l,(e=>{r.push(...e)}),(e=>{o[s]=e}))}),((e,n)=>{o[e]=n(t)}));return r.length>0?wI.serror(r):wI.svalue(o)},tF=e=>{const t=()=>{const t=ue(e,(e=>WI(e,((e,t,n,o)=>e+" -> "+o.toString()),(e=>"state("+e+")"))));return"obj{\n"+t.join("\n")+"}"};return{extract:(t,n)=>eF(t,n,e),toString:t}},nF=e=>({extract:(t,n)=>{const o=ue(n,((n,o)=>e.extract(t.concat(["["+o+"]"]),n)));return VI.consolidateArr(o)},toString:()=>"array("+e.toString()+")"}),oF=e=>KI((t=>e(t).fold(wI.serror,wI.svalue))),rF=(e,t,n)=>{const o=t.extract([e],n);return wI.mapError(o,(e=>({input:n,errors:e})))},sF=(e,t,n)=>wI.toResult(rF(e,t,n)),aF=e=>"Errors: \n"+kI(e.errors).join("\n")+"\n\nInput object: "+xI(e.input),iF=(e,t)=>AI(e,Fe(t,tF)),lF=Y(GI),dF=(e,t)=>KI((n=>{const o=typeof n;return e(n)?wI.svalue(n):wI.serror(`Expected type: ${t} but got: ${o}`)})),cF=dF($,"number"),mF=dF(P,"string"),uF=dF(U,"boolean"),fF=dF(V,"function"),gF=$I,pF=qI,hF=e=>oF((t=>ce(e,t)?Pc.value(t):Pc.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`))),bF=(e,t)=>gF(e,e,MI(),t),yF=e=>bF(e,mF),vF=e=>bF(e,fF),CF=(e,t)=>gF(e,e,MI(),nF(t)),wF=(e,t)=>gF(e,e,UI(),t),xF=e=>wF(e,mF),kF=e=>wF(e,fF),SF=(e,t)=>gF(e,e,FI(t),lF()),_F=(e,t,n)=>gF(e,e,FI(t),n),EF=(e,t)=>_F(e,t,cF),NF=(e,t)=>_F(e,t,mF),RF=(e,t,n)=>_F(e,t,hF(n)),DF=(e,t)=>_F(e,t,uF),AF=(e,t)=>_F(e,t,fF),TF=(e,t,n)=>_F(e,t,nF(n)),OF=yF("type"),BF=vF("fetch"),PF=vF("onAction"),LF=AF("onSetup",(()=>W)),MF=xF("text"),IF=xF("icon"),FF=xF("tooltip"),UF=xF("label"),zF=DF("active",!1),jF=DF("enabled",!0),HF=DF("primary",!1),VF=e=>SF("columns",e),$F=e=>NF("type",e),qF=tF([OF,yF("ch"),EF("minChars",1),VF(1),EF("maxResults",10),kF("matches"),BF,PF,TF("highlightOn",[],mF)]),WF=e=>sF("Autocompleter",qF,e),KF=[jF,FF,IF,MF,LF],GF=[zF].concat(KF),YF=[AF("predicate",ne),RF("scope","node",["node","editor"]),RF("position","selection",["node","selection","line"])],XF=KF.concat([$F("contextformbutton"),HF,PF,pF("original",X)]),QF=GF.concat([$F("contextformbutton"),HF,PF,pF("original",X)]),JF=KF.concat([$F("contextformbutton")]),ZF=GF.concat([$F("contextformtogglebutton")]),eU=iF("type",{contextformbutton:XF,contextformtogglebutton:QF});tF([$F("contextform"),AF("initValue",Y("")),UF,CF("commands",eU),wF("launch",iF("type",{contextformbutton:JF,contextformtogglebutton:ZF}))].concat(YF));const tU=e=>{const t=e.ui.registry.getAll().popups,n=Fe(t,(e=>WF(e).fold((e=>{throw new Error(aF(e))}),X))),o=Xe($e(n,(e=>e.ch))),r=qe(n);return{dataset:n,triggerChars:o,lookupByChar:e=>he(r,(t=>t.ch===e))}},nU=(e,t)=>{const n=Fl(t.load,50);e.on("keypress compositionend",(e=>{27!==e.which&&n.throttle()})),e.on("keydown",(e=>{const o=e.which;8===o?n.throttle():27===o&&t.cancelIfNecessary()})),e.on("remove",n.cancel)},oU=e=>{const t=Ml(),n=Sl(!1),o=t.isSet,r=()=>{o()&&(cD(e),_h(e),n.set(!1),t.clear())},s=n=>{o()||(dD(e,n.range),t.set({triggerChar:n.triggerChar,matchLength:n.text.length}))},a=at((()=>tU(e))),i=n=>t.get().map((t=>aI(e.dom,e.selection.getRng(),t.triggerChar).bind((t=>pI(e,a,t,n))))).getOrThunk((()=>gI(e,a))),l=o=>{i(o).fold(r,(o=>{s(o.context),o.lookupData.then((s=>{t.get().map((a=>{const i=o.context;a.triggerChar===i.triggerChar&&(i.text.length-a.matchLength>=10?r():(t.set({...a,matchLength:i.text.length}),n.get()?Sh(e,{lookupData:s}):(n.set(!0),kh(e,{lookupData:s}))))}))}))}))};e.addCommand("mceAutocompleterReload",((e,t)=>{const n=L(t)?t.fetchOptions:{};l(n)})),e.addCommand("mceAutocompleterClose",r),nU(e,{cancelIfNecessary:r,load:l})},rU=e=>(t,n,o={})=>{const r=t.getBody(),s={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:r,currentTarget:r,eventPhase:Event.AT_TARGET,originalTarget:r,explicitOriginalTarget:r,isTrusted:!1,srcElement:r,cancelable:!1,preventDefault:W,inputType:n},a=Ji(new InputEvent(e));return t.dispatch(e,{...a,...s,...o})},sU=rU("input"),aU=rU("beforeinput"),iU=(e,t,n)=>{const o=n.keyCode===Dh.BACKSPACE?"deleteContentBackward":"deleteContentForward";qL([{keyCode:Dh.BACKSPACE,action:VL(YP,e)},{keyCode:Dh.BACKSPACE,action:VL(LO,e,!1)},{keyCode:Dh.DELETE,action:VL(LO,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(gO,e,!1)},{keyCode:Dh.DELETE,action:VL(gO,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(NP,e,t,!1)},{keyCode:Dh.DELETE,action:VL(NP,e,t,!0)},{keyCode:Dh.BACKSPACE,action:VL(Fx,e,!1)},{keyCode:Dh.DELETE,action:VL(Fx,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(IO,e,!1)},{keyCode:Dh.DELETE,action:VL(IO,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(MP,e,!1)},{keyCode:Dh.DELETE,action:VL(MP,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(tO,e,!1)},{keyCode:Dh.DELETE,action:VL(tO,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(GT,e,!1)},{keyCode:Dh.DELETE,action:VL(GT,e,!0)},{keyCode:Dh.BACKSPACE,action:VL(OP,e,!1)},{keyCode:Dh.DELETE,action:VL(OP,e,!0)}],n).each((t=>{n.preventDefault();aU(e,o).isDefaultPrevented()||(t(),sU(e,o))}))},lU=(e,t)=>{$L([{keyCode:Dh.BACKSPACE,action:VL(PO,e)},{keyCode:Dh.DELETE,action:VL(PO,e)}],t)},dU=(e,t)=>{e.on("keydown",(n=>{!1===n.isDefaultPrevented()&&iU(e,t,n)})),e.on("keyup",(t=>{!1===t.isDefaultPrevented()&&lU(e,t)}))},cU=e=>{for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}},mU=(e,t)=>{let n,o=t;const r=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const e=cU(t.firstChild);e&&/^(UL|OL|DL)$/.test(e.nodeName)&&t.insertBefore(r.doc.createTextNode(ea),t.firstChild)}const a=r.createRng();if(t.normalize(),t.hasChildNodes()){const e=new Ds(t,t);for(;n=e.current();){if(es(n)){a.setStart(n,0),a.setEnd(n,0);break}if(s[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}o=n,n=e.next()}n||(a.setStart(o,0),a.setEnd(o,0))}else as(t)?t.nextSibling&&r.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),ly(e,a)},uU=(e,t)=>{const n=e.getRoot();let o,r;for(o=t;o!==n&&"false"!==e.getContentEditable(o);)"true"===e.getContentEditable(o)&&(r=o),o=o.parentNode;return o!==n?r:n},fU=e=>re.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),gU=e=>fU(e).fold(Y(""),(e=>e.nodeName.toUpperCase())),pU=e=>fU(e).filter((e=>Ws(bo.fromDom(e)))).isSome(),hU=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,bU=e=>{var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.firstChild)===e},yU=(e,t)=>e&&e.parentNode&&e.parentNode.nodeName===t,vU=e=>e&&/^(OL|UL|LI)$/.test(e.nodeName),CU=e=>vU(e)&&vU(e.parentNode),wU=e=>{const t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},xU=(e,t,n)=>{let o=e[n?"firstChild":"lastChild"];for(;o&&!$r(o);)o=o[n?"nextSibling":"previousSibling"];return o===t},kU=(e,t,n,o,r)=>{const s=e.dom,a=e.selection.getRng();if(n===e.getBody())return;CU(n)&&(r="LI");let i=t(r);if(xU(n,o,!0)&&xU(n,o,!1))if(yU(n,"LI")){const e=wU(n);s.insertAfter(i,e),bU(n)?s.remove(e):s.remove(n)}else s.replace(i,n);else if(xU(n,o,!0))yU(n,"LI")?(s.insertAfter(i,wU(n)),i.appendChild(s.doc.createTextNode(" ")),i.appendChild(n)):n.parentNode.insertBefore(i,n),s.remove(o);else if(xU(n,o,!1))s.insertAfter(i,wU(n)),s.remove(o);else{n=wU(n);const e=a.cloneRange();e.setStartAfter(o),e.setEndAfter(n);const t=e.extractContents();"LI"===r&&hU(t,"LI")?(i=t.firstChild,s.insertAfter(t,n)):(s.insertAfter(t,n),s.insertAfter(i,n)),s.remove(o)}mU(e,i)},SU=e=>{fe(oa(bo.fromDom(e),Un),(e=>{const t=e.dom;t.nodeValue=ha(t.nodeValue)}))},_U=(e,t)=>t&&"A"===t.nodeName&&e.isEmpty(t),EU=e=>e&&/^(TD|TH|CAPTION)$/.test(e.nodeName),NU=e=>{e.innerHTML='<br data-mce-bogus="1">'},RU=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,DU=(e,t)=>t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t),AU=(e,t,n)=>{let o=n;const r=[];let s;if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;$r(o)&&!t[o.nodeName.toLowerCase()]&&r.push(o)}for(s=r.length;s--;)o=r[s],(!o.hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue||_U(e,o))&&e.remove(o)}},TU=(e,t,n)=>!1===es(t)?n:e?1===n&&t.data.charAt(n-1)===ga?0:n:n===t.data.length-1&&t.data.charAt(n)===ga?t.data.length:n,OU=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,TU(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,TU(!1,e.endContainer,e.endOffset)),t},BU=e=>{do{es(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)},PU=(e,t)=>{const n=e.getRoot();let o,r;for(o=t;o!==n&&"false"!==e.getContentEditable(o);)"true"===e.getContentEditable(o)&&(r=o),o=o.parentNode;return o!==n?r:n},LU=(e,t,n)=>{const o=e.dom;re.from(n.style).map(o.parseStyle).each((e=>{const n={...ar(bo.fromDom(t)),...e};o.setStyles(t,n)}));const r=re.from(n.class).map((e=>e.split(/\s+/))),s=re.from(t.className).map((e=>he(e.split(/\s+/),(e=>""!==e))));En(r,s,((e,n)=>{const r=he(n,(t=>!ce(e,t))),s=[...e,...r];o.setAttrib(t,"class",s.join(" "))}));const a=["style","class"],i=Ve(n,((e,t)=>!ce(a,t)));o.setAttribs(t,i)},MU=(e,t)=>{if(lm(e).toLowerCase()===t.tagName.toLowerCase()){const n=dm(e);LU(e,t,n)}},IU=(e,t,n,o,r)=>{let s,a,i,l,d,c;const m=e.dom,u=PU(m,o);if(a=m.getParent(o,m.isBlock),!a||!DU(m,a)){if(a=a||u,c=a===e.getBody()||EU(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return s=m.create(t),MU(e,s),a.appendChild(s),n.setStart(s,0),n.setEnd(s,0),s;for(l=o;l.parentNode!==a;)l=l.parentNode;for(;l&&!m.isBlock(l);)i=l,l=l.previousSibling;if(i&&e.schema.isValidChild(c,t.toLowerCase())){for(s=m.create(t),MU(e,s),i.parentNode.insertBefore(s,i),l=i;l&&!m.isBlock(l);)d=l.nextSibling,s.appendChild(l),l=d;n.setStart(o,r),n.setEnd(o,r)}}return o},FU=(e,t)=>{t.normalize();const n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")},UU=(e,t)=>{const n=gm(e);return!j(t)&&(P(n)?ce(kn.explode(n),t.nodeName.toLowerCase()):n)},zU=(e,t)=>{let n,o,r,s,a,i,l,d,c;const m=e.dom,u=e.schema,f=u.getNonEmptyElements(),g=e.selection.getRng(),p=lm(e),h=t=>{let n,r,a,i=o;const l=u.getTextInlineElements();if(n=t||"TABLE"===d||"HR"===d?m.create(t||p):s.cloneNode(!1),a=n,!1===fm(e))m.setAttrib(n,"style",null),m.setAttrib(n,"class",null);else do{if(l[i.nodeName]){if(cg(i)||Bg(i))continue;r=i.cloneNode(!1),m.setAttrib(r,"id",""),n.hasChildNodes()?(r.appendChild(n.firstChild),n.appendChild(r)):(a=r,n.appendChild(r))}}while((i=i.parentNode)&&i!==w);return MU(e,n),NU(a),n},b=e=>{let t,n;const a=TU(e,o,r);if(es(o)&&(e?a>0:a<o.nodeValue.length))return!1;if(o.parentNode===s&&c&&!e)return!0;if(e&&$r(o)&&o===s.firstChild)return!0;if(RU(o,"TABLE")||RU(o,"HR"))return c&&!e||!c&&e;const i=new Ds(o,s);for(es(o)&&(e&&0===a?i.prev():e||a!==o.nodeValue.length||i.next());t=i.current();){if($r(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),f[n]&&"br"!==n))return!1}else if(es(t)&&!Ga(t.nodeValue))return!1;e?i.prev():i.next()}return!0},y=()=>{a=/^(H[1-6]|PRE|FIGURE)$/.test(d)&&"HGROUP"!==x?h(p):h(),UU(e,l)&&DU(m,l)&&m.isEmpty(s)?a=m.split(l,s):m.insertAfter(a,s),mU(e,a)};Nb(m,g).each((e=>{g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)})),o=g.startContainer,r=g.startOffset;const v=!(!t||!t.shiftKey),C=!(!t||!t.ctrlKey);$r(o)&&o.hasChildNodes()&&(c=r>o.childNodes.length-1,o=o.childNodes[Math.min(r,o.childNodes.length-1)]||o,r=c&&es(o)?o.nodeValue.length:0);const w=PU(m,o);if(!w)return;v||(o=IU(e,p,g,o,r)),s=m.getParent(o,m.isBlock),l=s?m.getParent(s.parentNode,m.isBlock):null,d=s?s.nodeName.toUpperCase():"";const x=l?l.nodeName.toUpperCase():"";"LI"!==x||C||(s=l,l=l.parentNode,d=x),/^(LI|DT|DD)$/.test(d)&&m.isEmpty(s)?kU(e,h,l,s,p):s!==e.getBody()&&(va(s)?(a=Aa(s),m.isEmpty(s)&&NU(s),MU(e,a),mU(e,a)):b()?y():b(!0)?(a=s.parentNode.insertBefore(h(),s),mU(e,RU(s,"HR")?a:s)):(n=OU(g).cloneRange(),n.setEndAfter(s),i=n.extractContents(),SU(i),BU(i),a=i.firstChild,m.insertAfter(i,s),AU(m,f,a),FU(m,s),m.isEmpty(s)&&NU(s),a.normalize(),m.isEmpty(a)?(m.remove(a),y()):(MU(e,a),mU(e,a))),m.setAttrib(a,"id",""),e.dispatch("NewBlock",{newBlock:a}))},jU={insert:zU,fakeEventName:"insertParagraph"},HU=(e,t,n)=>{const o=new Ds(t,n);let r;const s=e.getNonEmptyElements();for(;r=o.next();)if(s[r.nodeName.toLowerCase()]||r.length>0)return!0},VU=(e,t,n)=>{const o=e.dom.createRng();n?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),e.selection.setRng(o),ly(e,o)},$U=(e,t)=>{const n=e.selection,o=e.dom,r=n.getRng();let s,a;Nb(o,r).each((e=>{r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset)}));let i=r.startOffset,l=r.startContainer;if(1===l.nodeType&&l.hasChildNodes()){const e=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,i=e&&3===l.nodeType?l.nodeValue.length:0}let d=o.getParent(l,o.isBlock);const c=d?o.getParent(d.parentNode,o.isBlock):null,m=c?c.nodeName.toUpperCase():"",u=!(!t||!t.ctrlKey);"LI"!==m||u||(d=c),l&&3===l.nodeType&&i>=l.nodeValue.length&&(HU(e.schema,l,d)||(s=o.create("br"),r.insertNode(s),r.setStartAfter(s),r.setEndAfter(s),a=!0)),s=o.create("br"),ec(o,r,s),VU(e,s,a),e.undoManager.add()},qU=(e,t)=>{const n=bo.fromTag("br");dr(bo.fromDom(t),n),e.undoManager.add()},WU=(e,t)=>{GU(e.getBody(),t)||cr(bo.fromDom(t),bo.fromTag("br"));const n=bo.fromTag("br");cr(bo.fromDom(t),n),VU(e,n.dom,!1),e.undoManager.add()},KU=e=>as(e.getNode()),GU=(e,t)=>!!KU(Xd.after(t))||sg(e,Xd.after(t)).map((e=>as(e.getNode()))).getOr(!1),YU=e=>e&&"A"===e.nodeName&&"href"in e,XU=e=>e.fold(ne,YU,YU,ne),QU=t=>{const n=e(_w,t),o=Xd.fromRangeStart(t.selection.getRng());return aB(n,t.getBody(),o).filter(XU)},JU=(t,n)=>{n.fold(W,e(qU,t),e(WU,t),W)},ZU={insert:(t,n)=>{const o=QU(t);o.isSome()?o.each(e(JU,t)):$U(t,n)},fakeEventName:"insertLineBreak"},ez=(e,t)=>fU(e).filter((e=>t.length>0&&vo(bo.fromDom(e),t))).isSome(),tz=e=>ez(e,mm(e)),nz=e=>ez(e,um(e)),oz=Mc.generate([{br:[]},{block:[]},{none:[]}]),rz=e=>nz(e),sz=e=>t=>pU(t)===e,az=(e,t)=>n=>gU(n)===e.toUpperCase()===t,iz=e=>az("pre",e),lz=()=>az("summary",!0),dz=e=>t=>im(t)===e,cz=e=>tz(e),mz=(e,t)=>t,uz=e=>{const t=lm(e),n=uU(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t)},fz=(e,t)=>(n,o)=>ye(e,((e,t)=>e&&t(n,o)),!0)?re.some(t):re.none(),gz=(e,t)=>XO([fz([rz],oz.none()),fz([lz()],oz.br()),fz([iz(!0),dz(!1),mz],oz.br()),fz([iz(!0),dz(!1)],oz.block()),fz([iz(!0),dz(!0),mz],oz.block()),fz([iz(!0),dz(!0)],oz.br()),fz([sz(!0),mz],oz.br()),fz([sz(!0)],oz.block()),fz([cz],oz.br()),fz([mz],oz.br()),fz([uz],oz.block())],[e,!(!t||!t.shiftKey)]).getOr(oz.none()),pz=(e,t,n)=>{if(t.selection.isCollapsed()||Lw(t),H(n)){if(aU(t,e.fakeEventName).isDefaultPrevented())return}e.insert(t,n),H(n)&&sU(t,e.fakeEventName)},hz=(e,t)=>{const n=()=>pz(ZU,e,t),o=()=>pz(jU,e,t),r=gz(e,t);switch(cm(e)){case"linebreak":r.fold(n,n,W);break;case"block":r.fold(o,o,W);break;case"invert":r.fold(o,n,W);break;default:r.fold(n,o,W)}},bz=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),hR(e.undoManager),e.undoManager.transact((()=>{hz(e,t)})))},yz=e=>{e.on("keydown",(t=>{t.keyCode===Dh.ENTER&&bz(e,t)}))},vz=(e,t,n)=>{const o=pn.os.isMacOS()||pn.os.isiOS();$L([{keyCode:Dh.END,action:VL(AL,e,!0)},{keyCode:Dh.HOME,action:VL(AL,e,!1)},...o?[]:[{keyCode:Dh.HOME,action:VL(TL,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:Dh.END,action:VL(TL,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:Dh.END,action:VL(GL,e,!0)},{keyCode:Dh.HOME,action:VL(GL,e,!1)},{keyCode:Dh.END,action:VL(CP,e,!0,t)},{keyCode:Dh.HOME,action:VL(CP,e,!1,t)}],n).each((()=>{n.preventDefault()}))},Cz=(e,t)=>{e.on("keydown",(n=>{!1===n.isDefaultPrevented()&&vz(e,t,n)}))},wz=e=>{e.on("input",(t=>{!1===t.isComposing&&ZC(e)}))},xz=ln(),kz=(e,t,n)=>{$L([{keyCode:Dh.PAGE_UP,action:VL(CP,e,!1,t)},{keyCode:Dh.PAGE_DOWN,action:VL(CP,e,!0,t)}],n)},Sz=e=>e.stopImmediatePropagation(),_z=e=>e.keyCode===Dh.PAGE_UP||e.keyCode===Dh.PAGE_DOWN,Ez=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",Sz,!0):!n&&e.get()&&t.off("NodeChange",Sz),e.set(n)},Nz=(e,t)=>{if(xz.os.isMacOS())return;const n=Sl(!1);e.on("keydown",(t=>{_z(t)&&Ez(n,e,!0)})),e.on("keyup",(o=>{!1===o.isDefaultPrevented()&&kz(e,t,o),_z(o)&&n.get()&&(Ez(n,e,!1),e.nodeChanged())}))},Rz=(e,t)=>{const n=t.container(),o=t.offset();return es(n)?(n.insertData(o,e),re.some(Xd(n,o+e.length))):Af(t).map((n=>{const o=bo.fromText(e);return t.isAtEnd()?cr(n,o):dr(n,o),Xd(o.dom,e.length)}))},Dz=e(Rz,ea),Az=e(Rz," "),Tz=e=>t=>t.fold((t=>ag(e.dom,Xd.before(t))),(e=>ig(e)),(e=>lg(e)),(t=>sg(e.dom,Xd.after(t)))),Oz=(e,t)=>n=>jC(e,n)?Dz(t):Az(t),Bz=e=>t=>(e.selection.setRng(t.toRange()),e.nodeChanged(),!0),Pz=t=>{const n=Xd.fromRangeStart(t.selection.getRng()),o=bo.fromDom(t.getBody());if(t.selection.isCollapsed()){const r=e(_w,t),s=Xd.fromRangeStart(t.selection.getRng());return aB(r,t.getBody(),s).bind(Tz(o)).map((e=>()=>Oz(o,n)(e).each(Bz(t))))}return re.none()},Lz=(e,t)=>{qL([{keyCode:Dh.SPACEBAR,action:VL(Pz,e)}],t).each((n=>{t.preventDefault();aU(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),sU(e,"insertText",{data:" "}))}))},Mz=e=>{e.on("keydown",(t=>{!1===t.isDefaultPrevented()&&Lz(e,t)}))},Iz=e=>Mu(e)?[{keyCode:Dh.TAB,action:VL(HM,e,!0)},{keyCode:Dh.TAB,shiftKey:!0,action:VL(HM,e,!1)}]:[],Fz=(e,t)=>{$L([...Iz(e)],t).each((()=>{t.preventDefault()}))},Uz=e=>{e.on("keydown",(t=>{!1===t.isDefaultPrevented()&&Fz(e,t)}))},zz=e=>{if(e.addShortcut("Meta+P","","mcePrint"),oU(e),OR(e))return Sl(null);{const t=bP(e);return CL(e),$M(e,t),dU(e,t),yz(e),Mz(e),wz(e),Uz(e),Cz(e,t),Nz(e,t),t}};class jz{constructor(e){let t;this.lastPath=[],this.editor=e;const n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(n=>{const o=e.selection.getRng(),r={startContainer:o.startContainer,startOffset:o.startOffset,endContainer:o.endContainer,endOffset:o.endOffset};"nodechange"!==n.type&&pb(r,t)||e.dispatch("SelectionChange"),t=r})),e.on("contextmenu",(()=>{e.dispatch("SelectionChange")})),e.on("SelectionChange",(()=>{const t=e.selection.getStart(!0);t&&$p(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(t=>{!t.isDefaultPrevented()&&$p(e)&&("IMG"===e.selection.getNode().nodeName?Dy.setEditorTimeout(e,(()=>{e.nodeChanged()})):e.nodeChanged())}))}nodeChanged(e){const t=this.editor.selection;let n,o,r;this.editor.initialized&&t&&!tu(this.editor)&&!this.editor.mode.isReadOnly()&&(r=this.editor.getBody(),n=t.getStart(!0)||r,
n.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(n,r)||(n=r),o=[],this.editor.dom.getParent(n,(e=>{if(e===r)return!0;o.push(e)})),(e=e||{}).element=n,e.parents=o,this.editor.dispatch("NodeChange",e))}isSameElementPath(e){let t;const n=this.editor,o=_e(n.dom.getParents(e,oe,n.getBody()));if(o.length===this.lastPath.length){for(t=o.length;t>=0&&o[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=o,!0}return this.lastPath=o,!1}}const Hz="x-tinymce/html",Vz=Y(Hz),$z="<!-- "+Hz+" -->",qz=e=>$z+e,Wz=e=>e.replace($z,""),Kz=e=>-1!==e.indexOf($z),Gz=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),Yz=(e,t)=>{let n="<"+e;const o=$e(t,((e,t)=>t+'="'+Bi.encodeAllRaw(e)+'"'));return o.length&&(n+=" "+o.join(" ")),n+">"},Xz=(e,t,n)=>{const o=e.split(/\n\n/),r=Yz(t,n),s="</"+t+">",a=ue(o,(e=>e.split(/\n/).join("<br />"))),i=e=>r+e+s;return 1===a.length?a[0]:ue(a,i).join("")},Qz="%MCEPASTEBIN%",Jz=(e,t)=>{const{dom:n,selection:o}=e,r=e.getBody();t.set(o.getRng());const s=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},Qz);pn.browser.isFirefox()&&n.setStyle(s,"left","rtl"===n.getStyle(r,"direction",!0)?65535:-65535),n.bind(s,"beforedeactivate focusin focusout",(e=>{e.stopPropagation()})),s.focus(),o.select(s,!0)},Zz=(e,t)=>{const n=e.dom;if(ej(e)){let o;const r=t.get();for(;o=ej(e);)n.remove(o),n.unbind(o);r&&e.selection.setRng(r)}t.set(null)},ej=e=>e.dom.get("mcepastebin"),tj=e=>e&&"mcepastebin"===e.id,nj=e=>{const t=e.dom,n=(e,n)=>{e.appendChild(n),t.remove(n,!0)},[o,...r]=he(e.getBody().childNodes,tj);fe(r,(e=>{n(o,e)}));const s=t.select("div[id=mcepastebin]",o);for(let e=s.length-1;e>=0;e--){const r=t.create("div");o.insertBefore(r,s[e]),n(r,s[e])}return o?o.innerHTML:""},oj=e=>e===Qz,rj=e=>{const t=Sl(null);return{create:()=>Jz(e,t),remove:()=>Zz(e,t),getEl:()=>ej(e),getHtml:()=>nj(e),getLastRng:t.get}},sj=(e,t)=>(kn.each(t,(t=>{e=B(t,RegExp)?e.replace(t,""):e.replace(t[0],t[1])})),e),aj=e=>{const t=Wi(),n=oN({},t);let o="";const r=t.getVoidElements(),s=kn.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=e=>{const n=e.name,l=e;if("br"!==n){if("wbr"!==n)if(r[n]&&(o+=" "),s[n])o+=" ";else{if(3===e.type&&(o+=e.value),!(e.name in t.getVoidElements())&&(e=e.firstChild))do{i(e)}while(e=e.next);a[n]&&l.next&&(o+="\n","p"===n&&(o+="\n"))}}else o+="\n"};return e=sj(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),o},ij=e=>e=sj(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,t,n)=>t||n?ea:" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),lj=e=>{let t=0;return()=>e+t++},dj=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return kn.hasOwn(n,t)?"image/"+n[t]:"image/"+t},cj=(e,t)=>{const n=oN({},e.schema);n.addNodeFilter("meta",(e=>{kn.each(e,(e=>{e.remove()}))}));const o=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Hv({validate:!0},e.schema).serialize(o)},mj=(e,t)=>({content:e,cancelled:t}),uj=(e,t,n)=>{const o=e.dom.create("div",{style:"display:none"},t),r=Nh(e,o,n);return mj(r.node.innerHTML,r.isDefaultPrevented())},fj=(e,t,n)=>{const o=Eh(e,t,n),r=cj(e,o.content);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?uj(e,r,n):mj(r,o.isDefaultPrevented())},gj=(e,t,n)=>fj(e,t,n),pj=(e,t)=>(e.insertContent(t,{merge:ku(e),paste:!0}),!0),hj=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),bj=(e,t)=>hj(t)&&me(Lu(e),(e=>kt(t.toLowerCase(),`.${e.toLowerCase()}`))),yj=(e,t,n)=>(e.undoManager.extra((()=>{n(e,t)}),(()=>{e.insertContent('<img src="'+t+'">')})),!0),vj=(e,t,n)=>(e.undoManager.extra((()=>{n(e,t)}),(()=>{e.execCommand("mceInsertLink",!1,t)})),!0),Cj=(e,t,n)=>!(e.selection.isCollapsed()||!hj(t))&&vj(e,t,n),wj=(e,t,n)=>!!bj(e,t)&&yj(e,t,n),xj=(e,t)=>{kn.each([Cj,wj,pj],(n=>!0!==n(e,t,pj)))},kj=(e,t,n)=>{n||!Su(e)?pj(e,t):xj(e,t)},Sj=lj("mceclip"),_j=(e,t,n,o)=>{const r=gj(e,t,n);!1===r.cancelled&&kj(e,r.content,o)},Ej=(e,t,n)=>{const o=n||Kz(t);_j(e,Wz(t),o,!1)},Nj=(e,t)=>{const n=e.dom.encode(t).replace(/\r\n/g,"\n"),o=Ja(n,Eu(e)),r=Xz(o,lm(e),dm(e));_j(e,r,!1,!0)},Rj=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const o=e.types[n];try{t[o]=e.getData(o)}catch(e){t[o]=""}}return t},Dj=(e,t)=>t in e&&e[t].length>0,Aj=e=>Dj(e,"text/html")||Dj(e,"text/plain"),Tj=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return H(n)?e.dom.encode(n[1]):null},Oj=(e,t,n,o)=>{const r=Sj(),s=hm(e)&&H(n.name),a=s?Tj(e,n.name):r,i=s?n.name:void 0,l=t.create(r,n,o,a,i);return t.add(l),l},Bj=(e,t)=>{xE(t.uri).each((({data:n,type:o,base64Encoded:r})=>{const s=r?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(s,o),d=null!=l?l:Oj(e,i,a,s);Ej(e,`<img src="${d.blobUri()}">`,!1)}))},Pj=e=>"paste"===e.type,Lj=e=>Promise.all(ue(e,(e=>EE(e).then((t=>({file:e,uri:t})))))),Mj=e=>{const t=Lu(e);return e=>xt(e.type,"image/")&&me(t,(t=>dj(t)===e.type))},Ij=(e,t)=>{const n=t.items?ke(Oe(t.items),(e=>"file"===e.kind?[e.getAsFile()]:[])):[],o=t.files?Oe(t.files):[];return he(n.length>0?n:o,Mj(e))},Fj=(e,t,n)=>{const o=Pj(t)?t.clipboardData:t.dataTransfer;if(yu(e)&&o){const r=Ij(e,o);if(r.length>0)return t.preventDefault(),Lj(r).then((t=>{n&&e.selection.setRng(n),fe(t,(t=>{Bj(e,t)}))})),!0}return!1},Uj=e=>{var t,n;return pn.os.isAndroid()&&0===(null===(n=null===(t=e.clipboardData)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length)},zj=e=>Dh.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode,jj=(e,t,n,o)=>{let r=ij(n);const s=Dj(t,Vz())||Kz(n),a=!s&&Gz(r),i=hj(r);(oj(r)||!r.length||a&&!i)&&(o=!0),(o||i)&&(r=Dj(t,"text/plain")&&a?t["text/plain"]:aj(r)),oj(r)||(o?Nj(e,r):Ej(e,r,s))},Hj=(e,t,n)=>{let o;const r=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",(e=>{zj(e)&&!e.isDefaultPrevented()&&(o=e.shiftKey&&86===e.keyCode)})),e.on("paste",(s=>{if(s.isDefaultPrevented()||Uj(s))return;const a="text"===n.get()||o;o=!1;const i=Rj(s.clipboardData);!Aj(i)&&Fj(e,s,r())||(Dj(i,"text/html")?(s.preventDefault(),jj(e,i,i["text/html"],a)):(t.create(),Dy.setEditorTimeout(e,(()=>{const n=t.getHtml();t.remove(),jj(e,i,n,a)}),0)))}))},Vj=e=>{const t=e=>xt(e,"webkit-fake-url"),n=e=>xt(e,"data:"),o=e=>{var t;return!0===(null===(t=e.data)||void 0===t?void 0:t.paste)};e.parser.addNodeFilter("img",((r,s,a)=>{if(!yu(e)&&o(a))for(const o of r){const r=o.attr("src");P(r)&&!o.attr("data-mce-object")&&r!==pn.transparentSrc&&(t(r)||!Nu(e)&&n(r))&&o.remove()}}))},$j=(e,t,n)=>{Hj(e,t,n),Vj(e)},qj=(e,t)=>{"text"===t.get()?(t.set("html"),Rh(e,!1)):(t.set("text"),Rh(e,!0)),e.focus()},Wj=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",(()=>{qj(e,t)})),e.addCommand("mceInsertClipboardContent",((t,n)=>{n.html&&Ej(e,n.html,n.internal),n.text&&Nj(e,n.text)}))},Kj=(e,t,n)=>{try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Vz(),t),!0}catch(e){return!1}},Gj=(e,t,n,o)=>{Kj(e.clipboardData,t.html,t.text)?(e.preventDefault(),o()):n(t.html,o)},Yj=e=>(t,n)=>{const{dom:o,selection:r}=e,s=o.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=o.create("div",{contenteditable:"true"},t);o.setStyles(s,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),s.appendChild(a),o.add(e.getBody(),s);const i=r.getRng();a.focus();const l=o.createRng();l.selectNodeContents(a),r.setRng(l),Dy.setEditorTimeout(e,(()=>{r.setRng(i),o.remove(s),n()}),0)},Xj=e=>({html:qz(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),Qj=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),Jj=e=>!e.selection.isCollapsed()||Qj(e),Zj=e=>t=>{!t.isDefaultPrevented()&&Jj(e)&&Gj(t,Xj(e),Yj(e),(()=>{if(pn.browser.isChromium()||pn.browser.isFirefox()){const t=e.selection.getRng();Dy.setEditorTimeout(e,(()=>{e.selection.setRng(t),e.execCommand("Delete")}),0)}else e.execCommand("Delete")}))},eH=e=>t=>{!t.isDefaultPrevented()&&Jj(e)&&Gj(t,Xj(e),Yj(e),W)},tH=e=>{e.on("cut",Zj(e)),e.on("copy",eH(e))},nH=(e,t)=>{var n,o;return Ab.getCaretRangeFromPoint(null!==(n=t.clientX)&&void 0!==n?n:0,null!==(o=t.clientY)&&void 0!==o?o:0,e.getDoc())},oH=e=>{const t=e["text/plain"];return!!t&&0===t.indexOf("file://")},rH=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},sH=e=>me(e.files,(e=>/^image\//.test(e.type))),aH=(e,t)=>{bu(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(e=>{e.preventDefault(),e.stopPropagation()})),yu(e)||e.on("drop",(e=>{const t=e.dataTransfer;t&&sH(t)&&e.preventDefault()})),e.on("drop",(n=>{if(n.isDefaultPrevented()||t.get())return;const o=nH(e,n);if(j(o))return;const r=Rj(n.dataTransfer),s=Dj(r,Vz());if((!Aj(r)||oH(r))&&Fj(e,n,o))return;const a=r[Vz()],i=a||r["text/html"]||r["text/plain"];i&&(n.preventDefault(),Dy.setEditorTimeout(e,(()=>{e.undoManager.transact((()=>{a&&e.execCommand("Delete"),rH(e,o);const t=ij(i);r["text/html"]?Ej(e,t,s):Nj(e,t)}))})))})),e.on("dragstart",(()=>{t.set(!0)})),e.on("dragover dragend",(n=>{yu(e)&&!1===t.get()&&(n.preventDefault(),rH(e,nH(e,n))),"dragend"===n.type&&t.set(!1)}))},iH=e=>{const t=t=>n=>{t(e,n)},n=vu(e);V(n)&&e.on("PastePreProcess",t(n));const o=Cu(e);V(o)&&e.on("PastePostProcess",t(o))},lH=(e,t)=>{e.on("PastePreProcess",(n=>{n.content=t(e,n.content,n.internal)}))},dH=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,cH=e=>kn.trim(e).replace(dH,qg).toLowerCase(),mH=(e,t,n)=>{const o=wu(e);if(n||"all"===o||!xu(e))return t;const r=o?o.split(/[, ]/):[];if(r&&"none"!==o){const n=e.dom,o=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,((e,t,s,a)=>{const i=n.parseStyle(n.decode(s)),l={};for(let e=0;e<r.length;e++){const t=i[r[e]];let s=t,a=n.getStyle(o,r[e],!0);/color/.test(r[e])&&(s=cH(s),a=cH(a)),a!==s&&(l[r[e]]=t)}const d=n.serializeStyle(l,"span");return d?t+' style="'+d+'"'+a:t+a}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,((e,t,n,o)=>t+' style="'+n+'"'+o)),t},uH=e=>{(pn.browser.isChromium()||pn.browser.isSafari())&&lH(e,mH)},fH=e=>{const t=Sl(!1),n=Sl(_u(e)?"text":"html"),o=rj(e);uH(e),Wj(e,n),iH(e),e.on("PreInit",(()=>{tH(e),aH(e,t),$j(e,o,n)}))},gH=e=>{e.on("click",(t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()}))},pH=e=>{e.parser.addNodeFilter("details",(e=>{fe(e,(e=>{e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(e=>{fe(e,(e=>{const t=e.attr("data-mce-open");e.attr("open",P(t)?t:null),e.attr("data-mce-open",null)}))}))},hH=e=>{gH(e),pH(e)},bH=as,yH=es,vH=e=>ds(e.dom),CH=e=>ls(e.dom),wH=e=>t=>ko(bo.fromDom(e),t),xH=(e,t)=>vs(bo.fromDom(e),(e=>CH(e)||zs(e)),wH(t)).getOr(bo.fromDom(t)).dom,kH=(e,t)=>vs(bo.fromDom(e),vH,wH(t)),SH=(e,t,n)=>{const o=new Ds(e,t),r=n?o.next.bind(o):o.prev.bind(o);let s=e;for(let t=n?e:r();t&&!bH(t);t=r())za(t)&&(s=t);return s},_H=(e,t)=>{const n=Xd.fromRangeStart(e).getNode(),o=xH(n,t),r=SH(n,o,!1),s=SH(n,o,!0),a=document.createRange();return kH(r,o).fold((()=>{yH(r)?a.setStart(r,0):a.setStartBefore(r)}),(e=>a.setStartBefore(e.dom))),kH(s,o).fold((()=>{yH(s)?a.setEnd(s,s.data.length):a.setEndAfter(s)}),(e=>a.setEndAfter(e.dom))),a},EH=e=>{const t=_H(e.selection.getRng(),e.getBody());e.selection.setRng(tk(t))},NH=e=>{e.on("mousedown",(t=>{t.detail>=3&&(t.preventDefault(),EH(e))}))};var RH;!function(e){e.Before="before",e.After="after"}(RH||(RH={}));const DH=(e,t)=>Math.abs(e.left-t),AH=(e,t)=>Math.abs(e.right-t),TH=(e,t)=>e>=t.top&&e<=t.bottom,OH=(e,t)=>e.top<t.bottom&&e.bottom>t.top,BH=(e,t)=>{const n=wd(e,t)/Math.min(e.height,t.height);return OH(e,t)&&n>.5},PH=(e,t)=>{const n=he(e,(e=>TH(t,e)));return vd(n).fold((()=>[[],e]),(t=>{const{pass:n,fail:o}=pe(e,(e=>BH(e,t)));return[n,o]}))},LH=(e,t)=>({node:e.node,position:DH(e,t)<AH(e,t)?RH.Before:RH.After}),MH=(e,t)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),IH=(e,t,n)=>{const o=e=>za(e.node)?re.some(e):$r(e.node)?IH(Oe(e.node.childNodes),t,n):re.none(),r=(e,r)=>{if(e.length>=2){const s=o(e[0]).getOr(e[0]),a=o(e[1]).getOr(e[1]);if(Math.abs(r(s,t,n)-r(a,t,n))<2){if(es(s.node))return re.some(s);if(es(a.node))return re.some(a)}}return re.none()},s=(e,s)=>{const a=Re(e,((e,o)=>s(e,t,n)-s(o,t,n)));return r(a,s).orThunk((()=>Be(a,o)))},[a,i]=PH($B(e),n),{pass:l,fail:d}=pe(i,(e=>e.top<n));return s(a,MH).orThunk((()=>s(d,Cd))).orThunk((()=>s(l,Cd)))},FH=(e,t,n,o)=>{const r=(t,s)=>s.fold((()=>IH(Oe(t.dom.childNodes),n,o)),(e=>{const r=he(Oe(t.dom.childNodes),(t=>t!==e.dom));return IH(r,n,o)})).orThunk((()=>(ko(t,e)?re.none():Ao(t)).bind((e=>r(e,re.some(t))))));return r(t,re.none())},UH=(e,t,n)=>{const o=bo.fromDom(e),r=Eo(o),s=bo.fromPoint(r,t,n).filter((e=>So(o,e))).getOr(o);return FH(o,s,t,n)},zH=(e,t,n)=>UH(e,t,n).filter((e=>rf(e.node))).map((e=>LH(e,t))),jH=e=>{const t=e.getBoundingClientRect(),n=e.ownerDocument,o=n.documentElement,r=n.defaultView;return{top:t.top+r.pageYOffset-o.clientTop,left:t.left+r.pageXOffset-o.clientLeft}},HH=e=>e.inline?jH(e.getBody()):{left:0,top:0},VH=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},$H=e=>{const t=e.getBody(),n=e.getDoc().documentElement,o={left:t.scrollLeft,top:t.scrollTop},r={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?o:r},qH=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=jH(e.getContentAreaContainer()),o=$H(e);return{left:t.pageX-n.left+o.left,top:t.pageY-n.top+o.top}}return{left:t.pageX,top:t.pageY}},WH=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),KH=(e,t)=>WH(HH(e),VH(e),qH(e,t)),GH=ds,YH=ls,XH=(e,t)=>GH(t)&&t!==e,QH=(e,t,n)=>t!==n&&!e.dom.isChildOf(t,n)&&!GH(t),JH=e=>{const t=e.cloneNode(!0);return t.removeAttribute("data-mce-selected"),t},ZH=(e,t,n,o)=>{const r=e.dom,s=t.cloneNode(!0);r.setStyles(s,{width:n,height:o}),r.setAttrib(s,"data-mce-selected",null);const a=r.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return r.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),r.setStyles(s,{margin:0,boxSizing:"border-box"}),a.appendChild(s),a},eV=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},tV=(e,t,n,o,r,s)=>{let a=0,i=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>r&&(a=t.pageX+n-r),t.pageY+o>s&&(i=t.pageY+o-s),e.style.width=n-a+"px",e.style.height=o-i+"px"},nV=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},oV=e=>0===e.button,rV=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),sV=(e,t)=>n=>{if(oV(n)){const o=Ce(t.dom.getParents(n.target),Rd(GH,YH)).getOr(null);if(XH(t.getBody(),o)){const r=t.dom.getPos(o),s=t.getBody(),a=t.getDoc().documentElement;e.set({element:o,dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?s.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?s.scrollHeight:a.offsetHeight)-2,relX:n.pageX-r.x,relY:n.pageY-r.y,width:o.offsetWidth,height:o.offsetHeight,ghost:ZH(t,o,o.offsetWidth,o.offsetHeight)})}}},aV=(e,t)=>{const n=Il(((e,n)=>{t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return t.on("remove",n.cancel),o=>e.on((e=>{const r=Math.max(Math.abs(o.screenX-e.screenX),Math.abs(o.screenY-e.screenY));if(!e.dragging&&r>10){if(t.dispatch("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){const r=rV(e,KH(t,o));eV(e.ghost,t.getBody()),tV(e.ghost,r,e.width,e.height,e.maxX,e.maxY),n.throttle(o.clientX,o.clientY)}}))},iV=e=>{const t=e.getSel().getRangeAt(0).startContainer;return 3===t.nodeType?t.parentNode:t},lV=(e,t)=>n=>{e.on((e=>{if(e.dragging){if(QH(t,iV(t.selection),e.element)){const o=JH(e.element);t.dispatch("drop",{clientX:n.clientX,clientY:n.clientY}).isDefaultPrevented()||t.undoManager.transact((()=>{nV(e.element),t.insertContent(t.dom.getOuterHTML(o)),t._selectionOverrides.hideFakeCaret()}))}t.dispatch("dragend")}})),cV(e)},dV=(e,t)=>()=>{e.on((e=>{e.dragging&&t.dispatch("dragend")})),cV(e)},cV=e=>{e.on((e=>{nV(e.ghost)})),e.clear()},mV=e=>{const t=Ml(),n=bl.DOM,o=document,r=sV(t,e),s=aV(t,e),a=lV(t,e),i=dV(t,e);e.on("mousedown",r),e.on("mousemove",s),e.on("mouseup",a),n.bind(o,"mousemove",s),n.bind(o,"mouseup",i),e.on("remove",(()=>{n.unbind(o,"mousemove",s),n.unbind(o,"mouseup",i)})),e.on("keydown",(e=>{e.keyCode===Dh.ESC&&i()}))},uV=e=>{const t=t=>{if(!t.isDefaultPrevented()){const n=t.dataTransfer;n&&(ce(n.types,"Files")||n.files.length>0)&&(t.preventDefault(),"drop"===t.type&&EA(e,"Dropped file type is not supported"))}},n=n=>{Uy(e,n.target)&&t(n)},o=()=>{const o=bl.DOM,r=e.dom,s=document,a=e.inline?e.getBody():e.getDoc(),i=["drop","dragover"];fe(i,(e=>{o.bind(s,e,n),r.bind(a,e,t)})),e.on("remove",(()=>{fe(i,(e=>{o.unbind(s,e,n),r.unbind(a,e,t)}))}))};e.on("init",(()=>{Dy.setEditorTimeout(e,o,0)}))},fV=e=>{mV(e),au(e)&&uV(e)},gV=e=>{const t=Il((()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const t=e.selection.getRng();if(t.collapsed){const n=lO(e,t,!1);e.selection.setRng(n)}}}),0);e.on("focus",(()=>{t.throttle()})),e.on("blur",(()=>{t.cancel()}))},pV=e=>{e.on("init",(()=>{e.on("focusin",(t=>{const n=t.target;if(ms(n)){const t=Ux(e.getBody(),n),o=ds(t)?t:n;e.selection.getNode()!==o&&aO(e,o).each((t=>e.selection.setRng(t)))}}))}))},hV=ds,bV=(e,t)=>Ux(e.getBody(),t),yV=e=>{const t=e.selection,n=e.dom,o=n.isBlock,r=e.getBody(),s=tf(e,r,o,(()=>Zy(e))),a="sel-"+n.uniqueId(),i="data-mce-selected";let l;const d=e=>n.hasClass(e,"mce-offscreen-selection"),c=e=>e!==r&&(hV(e)||ms(e))&&n.isChildOf(e,r),m=e=>{e&&t.setRng(e)},u=(n,o,r,a=!0)=>e.dispatch("ShowCaret",{target:o,direction:n,before:r}).isDefaultPrevented()?null:(a&&t.scrollIntoView(o,-1===n),s.show(r,o)),f=e=>{e.hasAttribute("data-mce-caret")&&(Aa(e),t.scrollIntoView(e))},g=()=>{e.on("click",(t=>{const n=bV(e,t.target);n&&hV(n)&&(t.preventDefault(),e.focus())})),e.on("blur NewBlock",w),e.on("ResizeWindow FullscreenStateChanged",s.reposition),e.on("tap",(t=>{const n=t.target,o=bV(e,n);hV(o)?(t.preventDefault(),aO(e,o).each(C)):c(n)&&aO(e,n).each(C)}),!0),e.on("mousedown",(t=>{const o=t.target;if(o!==r&&"HTML"!==o.nodeName&&!n.isChildOf(o,r))return;if(!1===hA(e,t.clientX,t.clientY))return;w(),k();const s=bV(e,o);hV(s)?(t.preventDefault(),aO(e,s).each(C)):zH(r,t.clientX,t.clientY).each((n=>{t.preventDefault();const o=u(1,n.node,n.position===RH.Before,!1);m(o),$r(s)?s.focus():e.getBody().focus()}))})),e.on("keypress",(e=>{Dh.modifierPressed(e)||hV(t.getNode())&&e.preventDefault()})),e.on("GetSelectionRange",(e=>{let t=e.range;if(l){if(!l.parentNode)return void(l=null);t=t.cloneRange(),t.selectNode(l),e.range=t}})),e.on("SetSelectionRange",(e=>{e.range=b(e.range);const t=C(e.range,e.forward);t&&(e.range=t)}));const o=e=>"mcepastebin"===e.id;e.on("AfterSetSelectionRange",(e=>{const t=e.range,n=t.startContainer.parentNode;h(t)||o(n)||k(),d(n)||w()})),fV(e),gV(e),pV(e)},p=e=>wa(e)||Na(e)||Ra(e),h=e=>p(e.startContainer)||p(e.endContainer),b=t=>{const o=e.schema.getVoidElements(),r=n.createRng(),s=t.startContainer,a=t.startOffset,i=t.endContainer,l=t.endOffset;return Ke(o,s.nodeName.toLowerCase())?0===a?r.setStartBefore(s):r.setStartAfter(s):r.setStart(s,a),Ke(o,i.nodeName.toLowerCase())?0===l?r.setEndBefore(i):r.setEndAfter(i):r.setEnd(i,l),r},y=(o,r)=>{const s=bo.fromDom(e.getBody()),i=e.getDoc(),l=Ss(s,"#"+a).getOrThunk((()=>{const e=bo.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',i);return $n(e,"id",a),ur(s,e),e})),d=n.createRng();hr(l),pr(l,[bo.fromText(ea,i),bo.fromDom(r),bo.fromText(ea,i)]),d.setStart(l.dom.firstChild,1),d.setEnd(l.dom.lastChild,0),nr(l,{top:n.getPos(o,e.getBody()).y+"px"}),dy(l);const c=t.getSel();return c.removeAllRanges(),c.addRange(d),d},v=t=>{const o=t.cloneNode(!0),r=e.dispatch("ObjectSelected",{target:t,targetClone:o});if(r.isDefaultPrevented())return null;const s=y(t,r.targetClone),a=bo.fromDom(t);return fe(ra(bo.fromDom(e.getBody()),`*[${i}]`),(e=>{ko(a,e)||Yn(e,i)})),n.getAttrib(t,i)||t.setAttribute(i,"1"),l=t,k(),s},C=(e,t)=>{if(!e)return null;if(e.collapsed){if(!h(e)){const n=t?1:-1,o=Df(n,r,e),s=o.getNode(!t);if(rf(s))return u(n,s,!!t&&!o.isAtEnd(),!1);const a=o.getNode(t);if(rf(a))return u(n,a,!t&&!o.isAtEnd(),!1)}return null}let o=e.startContainer,s=e.startOffset;const a=e.endOffset;if(3===o.nodeType&&0===s&&hV(o.parentNode)&&(o=o.parentNode,s=n.nodeIndex(o),o=o.parentNode),1!==o.nodeType)return null;if(a===s+1&&o===e.endContainer){const e=o.childNodes[s];if(c(e))return v(e)}return null},w=()=>{l&&l.removeAttribute(i),Ss(bo.fromDom(e.getBody()),"#"+a).each(br),l=null},x=()=>{s.destroy(),l=null},k=()=>{s.hide()};return OR(e)||g(),{showCaret:u,showBlockCaretContainer:f,hideFakeCaret:k,destroy:x}},vV=(e,t,n)=>{if(es(t)&&(n<0||n>t.data.length))return[];const o=[n];let r=t;for(;r!==e&&r.parentNode;){const e=r.parentNode;for(let t=0;t<e.childNodes.length;t++)if(e.childNodes[t]===r){o.push(t);break}r=e}return r===e?o.reverse():[]},CV=(e,t,n,o,r)=>({start:vV(e,t,n),end:vV(e,o,r)}),wV=(e,t)=>{const n=t.slice(),o=n.pop();return ye(n,((e,t)=>e.bind((e=>re.from(e.childNodes[t])))),re.some(e)).bind((e=>es(e)&&(o<0||o>e.data.length)?re.none():re.some({node:e,offset:o})))},xV=(e,t)=>wV(e,t.start).bind((({node:n,offset:o})=>wV(e,t.end).map((({node:e,offset:t})=>{const r=document.createRange();return r.setStart(n,o),r.setEnd(e,t),r})))),kV=(e,t)=>CV(e,t.startContainer,t.startOffset,t.endContainer,t.endOffset),SV=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const o=t.parentNode;e.remove(t),SV(e,o,n)}},_V=(e,t,n,o=!0)=>{const r=t.startContainer.parentNode,s=t.endContainer.parentNode;t.deleteContents(),o&&!n(t.startContainer)&&(es(t.startContainer)&&0===t.startContainer.data.length&&e.remove(t.startContainer),es(t.endContainer)&&0===t.endContainer.data.length&&e.remove(t.endContainer),SV(e,r,n),r!==s&&SV(e,s,n))},EV=(e,t)=>re.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),NV=(e,t,n)=>{XM(t,0,t).each((o=>{const r=o.container;JM(r,n.start.length,t).each((n=>{const o=e.createRng();o.setStart(r,0),o.setEnd(n.container,n.offset),_V(e,o,(e=>e===t))}))}))},RV=(e,t)=>{const n=e.dom,o=t.pattern,r=xV(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),s=(e,t)=>{const n=t.get(e);return I(n)&&Ae(n).exists((e=>Ke(e,"block")))};return EV(e,r).each((t=>{"block-format"===o.type?s(o.format,e.formatter)&&e.undoManager.transact((()=>{NV(e.dom,t,o),e.formatter.apply(o.format)})):"block-command"===o.type&&e.undoManager.transact((()=>{NV(e.dom,t,o),e.execCommand(o.cmd,!1,o.value)}))})),!0},DV=(e,t)=>{const n=t.replace(ea," ");return Ce(e,(e=>0===t.indexOf(e.start)||0===n.indexOf(e.start)))},AV=(e,t)=>{const n=e.dom,o=e.selection.getRng();return EV(e,o).filter((t=>{const o=lm(e),r=n.is(t,o);return null!==t&&r})).bind((e=>{const o=e.textContent;return DV(t,o).map((t=>kn.trim(o).length===t.start.length?[]:[{pattern:t,range:CV(n.getRoot(),e,0,e,0)}]))})).getOr([])},TV=(e,t)=>{if(0===t.length)return;const n=e.selection.getBookmark();fe(t,(t=>RV(e,t))),e.selection.moveToBookmark(n)},OV=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),BV=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},PV=(e,t,n)=>{const o=xV(e.getRoot(),n).getOrDie("Unable to resolve path range"),r=o.startContainer,s=o.endContainer,a=0===o.endOffset?s:s.splitText(o.endOffset),i=0===o.startOffset?r:r.splitText(o.startOffset);return{prefix:t,end:a.parentNode.insertBefore(OV(e,t+"-end"),a),start:i.parentNode.insertBefore(OV(e,t+"-start"),i)}},LV=(e,t,n)=>{SV(e,e.get(t.prefix+"-end"),n),SV(e,e.get(t.prefix+"-start"),n)},MV=e=>0===e.start.length,IV=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),s=o.lastIndexOf(e);return-1!==s?s+e.length:-1!==r?r+1:-1},FV=(e,t,n,o)=>{const r=t.start;return ZM(e,o.container,o.offset,IV(r),n).bind((o=>{if(o.offset>=r.length){const t=e.createRng();return t.setStart(o.container,o.offset-r.length),t.setEnd(o.container,o.offset),re.some(t)}{const s=o.offset-r.length;return QM(o.container,s,n).map((t=>{const n=e.createRng();return n.setStart(t.container,t.offset),n.setEnd(o.container,o.offset),n})).filter((e=>e.toString()===r)).orThunk((()=>FV(e,t,n,qM(o.container,0))))}}))},UV=(e,t,n,o,r,s=!1)=>{if(0===t.start.length&&!s){const t=e.createRng();return t.setStart(n,o),t.setEnd(n,o),re.some(t)}return YM(n,o,r).bind((n=>FV(e,t,r,n).bind((e=>{if(s){if(e.endContainer===n.container&&e.endOffset===n.offset)return re.none();if(0===n.offset&&e.endContainer.textContent.length===e.endOffset)return re.none()}return re.some(e)}))))},zV=(e,t,n)=>{const o=e.dom,r=o.getRoot(),s=n.pattern,a=n.position.container,i=n.position.offset;return QM(a,i-n.pattern.end.length,t).bind((l=>{const d=CV(r,l.container,l.offset,a,i);if(MV(s))return re.some({matches:[{pattern:s,startRng:d,endRng:d}],position:l});{const a=jV(e,n.remainingPatterns,l.container,l.offset,t),i=a.getOr({matches:[],position:l}),c=i.position;return UV(o,s,c.container,c.offset,t,a.isNone()).map((e=>{const t=kV(r,e);return{matches:i.matches.concat([{pattern:s,startRng:t,endRng:d}]),position:qM(e.startContainer,e.startOffset)}}))}}))},jV=(e,t,n,o,r)=>{const s=e.dom;return YM(n,o,s.getRoot()).bind((a=>{const i=s.createRng();i.setStart(r,0),i.setEnd(n,o);const l=i.toString();for(let n=0;n<t.length;n++){const o=t[n];if(!kt(l,o.end))continue;const s=t.slice();s.splice(n,1);const i=zV(e,r,{pattern:o,remainingPatterns:s,position:a});if(i.isSome())return i}return re.none()}))},HV=(e,t,n)=>{e.selection.setRng(n),"inline-format"===t.type?fe(t.format,(t=>{e.formatter.apply(t)})):e.execCommand(t.cmd,!1,t.value)},VV=(e,t,n,o)=>{const r=BV(e.dom,n);_V(e.dom,r,o),HV(e,t,r)},$V=(e,t,n,o,r)=>{const s=e.dom,a=BV(s,o),i=BV(s,n);_V(s,i,r),_V(s,a,r);const l={prefix:n.prefix,start:n.end,end:o.start},d=BV(s,l);HV(e,t,d)},qV=(e,t)=>{const n=td("mce_textpattern"),o=be(t,((t,o)=>{const r=PV(e,n+`_end${t.length}`,o.endRng);return t.concat([{...o,endMarker:r}])}),[]);return be(o,((t,r)=>{const s=o.length-t.length-1,a=MV(r.pattern)?r.endMarker:PV(e,n+`_start${s}`,r.startRng);return t.concat([{...r,startMarker:a}])}),[])},WV=(e,t,n)=>{const o=e.selection.getRng();return!1===o.collapsed?[]:EV(e,o).bind((r=>{const s=Math.max(0,o.startOffset-(n?1:0));return jV(e,t,o.startContainer,s,r)})).fold((()=>[]),(e=>e.matches))},KV=(e,t)=>{if(0===t.length)return;const n=e.dom,o=e.selection.getBookmark(),r=qV(n,t);fe(r,(t=>{const o=n.getParent(t.startMarker.start,n.isBlock),r=e=>e===o;MV(t.pattern)?VV(e,t.pattern,t.endMarker,r):$V(e,t.pattern,t.startMarker,t.endMarker,r),LV(n,t.endMarker,r),LV(n,t.startMarker,r)})),e.selection.moveToBookmark(o)},GV=e=>e.inlinePatterns.length>0||e.blockPatterns.length>0,YV=(e,t)=>{if(!e.selection.isCollapsed()||!GV(t))return!1;const n=WV(e,t.inlinePatterns,!1),o=AV(e,t.blockPatterns);return(o.length>0||n.length>0)&&(e.undoManager.add(),e.undoManager.extra((()=>{e.execCommand("mceInsertNewLine")}),(()=>{e.insertContent(Zs),KV(e,n),TV(e,o);const t=e.selection.getRng(),r=YM(t.startContainer,t.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each((t=>{const n=t.container;n.data.charAt(t.offset-1)===Zs&&(n.deleteData(t.offset-1,1),SV(e.dom,n.parentNode,(t=>t===e.dom.getRoot())))}))})),!0)},XV=(e,t)=>{if(t.length>0){const n=WV(e,t,!0);n.length>0&&e.undoManager.transact((()=>{KV(e,n)}))}},QV=(e,t,n)=>{for(let o=0;o<e.length;o++)if(n(e[o],t))return!0;return!1},JV=(e,t)=>QV(e,t,((e,t)=>e===t.keyCode&&!1===Dh.modifierPressed(t))),ZV=(e,t)=>QV(e,t,((e,t)=>e.charCodeAt(0)===t.charCode)),e$=e=>{const t=[",",".",";",":","!","?"],n=[32],o=()=>$c(Ru(e)),r=()=>Vc(Ru(e));e.on("keydown",(t=>{13!==t.keyCode||Dh.modifierPressed(t)||YV(e,o())&&t.preventDefault()}),!0),e.on("keyup",(t=>{JV(n,t)&&XV(e,r())})),e.on("keypress",(n=>{ZV(t,n)&&Dy.setEditorTimeout(e,(()=>{XV(e,r())}))}))},t$=e=>{e$(e)},n$=e=>{const t=kn.each,n=Dh.BACKSPACE,o=Dh.DELETE,r=e.dom,s=e.selection,a=e.parser,i=pn.browser,l=i.isFirefox(),d=i.isChromium()||i.isSafari(),c=pn.deviceType.isiPhone()||pn.deviceType.isiPad(),m=pn.os.isMacOS()||pn.os.isiOS(),u=(t,n)=>{try{e.getDoc().execCommand(t,!1,n)}catch(e){}},f=e=>e.isDefaultPrevented(),g=()=>{const t=e=>{const t=r.create("body"),n=e.cloneContents();return t.appendChild(n),s.serializer.serialize(t,{format:"html"})},a=n=>{const o=t(n),s=r.createRng();s.selectNode(e.getBody());return o===t(s)};e.on("keydown",(t=>{const s=t.keyCode;let i,l;if(!f(t)&&(s===o||s===n)){if(i=e.selection.isCollapsed(),l=e.getBody(),i&&!r.isEmpty(l))return;if(!i&&!a(e.selection.getRng()))return;t.preventDefault(),e.setContent(""),l.firstChild&&r.isBlock(l.firstChild)?e.selection.setCursorLocation(l.firstChild,0):e.selection.setCursorLocation(l,0),e.nodeChanged()}}))},p=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},h=()=>{e.inline||r.bind(e.getDoc(),"mousedown mouseup",(t=>{let n;if(t.target===e.getDoc().documentElement)if(n=s.getRng(),e.getBody().focus(),"mousedown"===t.type){if(wa(n.startContainer))return;s.placeCaretAt(t.clientX,t.clientY)}else s.setRng(n)}))},b=()=>{e.on("keydown",(t=>{if(!f(t)&&t.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&0===s.getRng().startOffset){const e=s.getNode(),n=e.previousSibling;if("HR"===e.nodeName)return r.remove(e),void t.preventDefault();n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(r.remove(n),t.preventDefault())}}}))},y=()=>{Range.prototype.getClientRects||e.on("mousedown",(t=>{if(!f(t)&&"HTML"===t.target.nodeName){const t=e.getBody();t.blur(),Dy.setEditorTimeout(e,(()=>{t.focus()}))}}))},v=()=>{const t=du(e);e.on("click",(n=>{const o=n.target;/^(IMG|HR)$/.test(o.nodeName)&&"false"!==r.getContentEditableParent(o)&&(n.preventDefault(),e.selection.select(o),e.nodeChanged()),"A"===o.nodeName&&r.hasClass(o,t)&&0===o.childNodes.length&&(n.preventDefault(),s.select(o))}))},C=()=>{const n=()=>{const n=r.getAttribs(s.getStart().cloneNode(!1));return()=>{const o=s.getStart();o!==e.getBody()&&(r.setAttrib(o,"style",null),t(n,(e=>{o.setAttributeNode(e.cloneNode(!0))})))}},o=()=>!s.isCollapsed()&&r.getParent(s.getStart(),r.isBlock)!==r.getParent(s.getEnd(),r.isBlock);e.on("keypress",(t=>{let r;if(!f(t)&&(8===t.keyCode||46===t.keyCode)&&o())return r=n(),e.getDoc().execCommand("delete",!1,null),r(),t.preventDefault(),!1})),r.bind(e.getDoc(),"cut",(t=>{let r;!f(t)&&o()&&(r=n(),Dy.setEditorTimeout(e,(()=>{r()})))}))},w=()=>{e.on("keydown",(e=>{if(!f(e)&&e.keyCode===n&&s.isCollapsed()&&0===s.getRng().startOffset){const t=s.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},x=()=>{e.on("keydown",(t=>{let n,o;if(f(t)||t.keyCode!==Dh.BACKSPACE)return;n=s.getRng();const a=n.startContainer,i=n.startOffset,l=r.getRoot();if(o=a,n.collapsed&&0===i){for(;o&&o.parentNode&&o.parentNode.firstChild===o&&o.parentNode!==l;)o=o.parentNode;"BLOCKQUOTE"===o.tagName&&(e.formatter.toggle("blockquote",null,o),n=r.createRng(),n.setStart(a,0),n.setEnd(a,0),s.setRng(n))}}))},k=()=>{const t=()=>{u("StyleWithCSS",!1),u("enableInlineTableEditing",!1),Lm(e)||u("enableObjectResizing",!1)};nu(e)||e.on("BeforeExecCommand mousedown",t)},S=()=>{const n=()=>{t(r.select("a"),(e=>{let t=e.parentNode;const n=r.getRoot();if(t.lastChild===e){for(;t&&!r.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}r.add(t,"br",{"data-mce-bogus":1})}}))};e.on("SetContent ExecCommand",(e=>{"setcontent"!==e.type&&"mceInsertLink"!==e.command||n()}))},_=()=>{e.on("init",(()=>{u("DefaultParagraphSeparator",lm(e))}))},E=e=>{const t=e.getBody(),n=e.selection.getRng();return n.startContainer===n.endContainer&&n.startContainer===t&&0===n.startOffset&&n.endOffset===t.childNodes.length},N=()=>{e.on("keyup focusin mouseup",(t=>{Dh.modifierPressed(t)||E(e)||s.normalize()}),!0)},R=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},D=()=>{e.inline||e.on("keydown",(()=>{document.activeElement===document.body&&e.getWin().focus()}))},A=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(t=>{let n;"HTML"===t.target.nodeName&&(n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged())})))},T=()=>{m&&e.on("keydown",(t=>{if(Dh.metaKeyPressed(t)&&!t.shiftKey&&(37===t.keyCode||39===t.keyCode)){t.preventDefault();e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary")}}))},O=()=>{e.on("click",(e=>{let t=e.target;do{
if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},B=()=>{e.on("init",(()=>{e.dom.bind(e.getBody(),"submit",(e=>{e.preventDefault()}))}))},P=()=>{a.addNodeFilter("br",(e=>{let t=e.length;for(;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}))},L=W,M=()=>{if(!l||e.removed)return!1;const t=e.selection.getSel();return!t||!t.rangeCount||0===t.rangeCount},I=()=>{d&&(h(),v(),B(),p(),c&&(D(),A(),O())),l&&(y(),k(),R(),T())},F=()=>{x(),g(),pn.windowsPhone||N(),d&&(h(),v(),_(),B(),w(),P(),c?(D(),A(),O()):p()),l&&(b(),y(),C(),k(),S(),R(),T(),w())};return OR(e)?I():F(),{refreshContentEditable:L,isHidden:M}},o$=bl.DOM,r$=(e,t)=>{const n=bo.fromDom(e.getBody()),o=Ko(Wo(n)),r=bo.fromTag("style");$n(r,"type","text/css"),ur(r,bo.fromText(t)),ur(o,r),e.on("remove",(()=>{br(r)}))},s$=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,a$=e=>Ve(e,(e=>!1===z(e))),i$=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return a$({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),remove_trailing_brs:t("remove_trailing_brs"),inline_styles:t("inline_styles"),root_name:s$(e),validate:!0,blob_cache:n,document:e.getDoc()})},l$=e=>{const t=e.options.get;return a$({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},d$=e=>{const t=e.options.get;return{...i$(e),...l$(e),...a$({url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},c$=e=>{const t=oN(i$(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",((t,n)=>{let o,r,s=t.length;const a=e.dom,i="data-mce-"+n;for(;s--;)if(o=t[s],r=o.attr(n),r&&!o.attr(i)){if(0===r.indexOf("data:")||0===r.indexOf("blob:"))continue;"style"===n?(r=a.serializeStyle(a.parseStyle(r),o.name),r.length||(r=null),o.attr(i,r),o.attr(n,r)):"tabindex"===n?(o.attr(i,r),o.attr(n,null)):o.attr(i,e.convertURL(r,n,o.name))}})),t.addNodeFilter("script",(e=>{let t=e.length;for(;t--;){const n=e[t],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}})),e.options.get("preserve_cdata")&&t.addNodeFilter("#cdata",(t=>{let n=t.length;for(;n--;){const o=t[n];o.type=8,o.name="#comment",o.value="[CDATA["+e.dom.encode(o.value)+"]]"}})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(t=>{let n=t.length;const o=e.schema.getNonEmptyElements();for(;n--;){const e=t[n];e.isEmpty(o)&&0===e.getAll("br").length&&e.append(new Rv("br",1))}})),t},m$=e=>{const t=gu(e);t&&Dy.setEditorTimeout(e,(()=>{let n;n=!0===t?e:e.editorManager.get(t),n.destroyed||n.focus()}),100)},u$=e=>{const t=e.dom.getRoot();e.inline||$p(e)&&e.selection.getStart(!0)!==t||ig(t).each((t=>{const n=t.getNode(),o=Qr(n)?ig(n).getOr(t):t;e.selection.setRng(o.toRange())}))},f$=e=>{e.bindPendingEventDelegates(),e.initialized=!0,gh(e),e.focus(!0),u$(e),e.nodeChanged({initial:!0});const t=uu(e);V(t)&&t.call(e,e),m$(e)},g$=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,p$=(e,t,n)=>{const o=[g$(e).loadAll(t)];return e.inline?o:o.concat([e.ui.styleSheetLoader.loadAll(n)])},h$=e=>{const t=g$(e),n=Om(e),o=e.contentCSS,r=()=>{t.unloadAll(o),e.inline||e.ui.styleSheetLoader.unloadAll(n)},s=()=>{e.removed?r():e.on("remove",r)};if(e.contentStyles.length>0){let t="";kn.each(e.contentStyles,(e=>{t+=e+"\r\n"})),e.dom.addStyle(t)}const a=Promise.all(p$(e,o,n)).then(s).catch(s),i=Tm(e);return i&&r$(e,i),a},b$=e=>{const t=e.getDoc(),n=e.getBody();uh(e),pu(e)||(t.body.spellcheck=!1,o$.setAttrib(n,"spellcheck","false")),e.quirks=n$(e),fh(e);const o=Bm(e);void 0!==o&&(n.dir=o);const r=hu(e);r&&e.on("BeforeSetContent",(e=>{kn.each(r,(t=>{e.content=e.content.replace(t,(e=>"<!--mce:protected "+escape(e)+"-->"))}))})),e.on("SetContent",(()=>{e.addVisual(e.getBody())})),e.on("compositionstart compositionend",(t=>{e.composing="compositionstart"===t.type}))},y$=e=>{OR(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},v$=e=>{!0!==e.removed&&(y$(e),f$(e))},C$=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(o$.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const o=e.getBody();o.disabled=!0,e.readonly=nu(e),e.readonly||(e.inline&&"static"===o$.getStyle(o,"position",!0)&&(o.style.position="relative"),o.contentEditable="true"),o.disabled=!1,e.editorUpload=tT(e),e.schema=Wi(l$(e)),e.dom=bl(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:()=>e.inline,schema:e.schema,contentCssCors:Sm(e),referrerPolicy:_m(e),onSetAttrib:t=>{e.dispatch("SetAttrib",t)}}),e.parser=c$(e),e.serializer=FD(d$(e),e),e.selection=_D(e.dom,e.getWin(),e.serializer,e),e.annotator=nh(e),e.formatter=pT(e),e.undoManager=vT(e),e._nodeChangeDispatcher=new jz(e),e._selectionOverrides=yV(e),rL(e),hH(e),hL(e),OR(e)||(NH(e),t$(e));const r=zz(e);ZP(e,r),uL(e),NT(e),fH(e);const s=PR(e);b$(e),s.fold((()=>{h$(e).then((()=>v$(e)))}),(t=>{e.setProgressState(!0),h$(e).then((()=>{t().then((()=>{e.setProgressState(!1),v$(e),lD(e)}),(t=>{e.notificationManager.open({type:"error",text:String(t)}),v$(e),lD(e)}))}))}))},w$=(e,t)=>{if(e.inline||(e.getElement().style.visibility=e.orgVisibility),t||e.inline)C$(e);else{const t=e.iframeElement,n=VA(bo.fromDom(t),"load",(()=>{n.unbind(),e.contentDocument=t.contentDocument,C$(e)}));if(pn.browser.isFirefox()){const t=e.getDoc();t.open(),t.write(e.iframeHTML),t.close()}else t.srcdoc=e.iframeHTML}},x$=bl.DOM,k$=(e,t,n,o)=>{const r=bo.fromTag("iframe");return o.each((e=>$n(r,"tabindex",e))),qn(r,n),qn(r,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),ao(r,"tox-edit-area__iframe"),r},S$=e=>{let t=nm(e)+"<html><head>";om(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=rm(e),o=sm(e),r=e.translate(cu(e));return am(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+am(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${o}" data-id="${e.id}" aria-label="${r}"><br></body></html>`,t},_$=(e,t)=>{const n=e.translate("Rich Text Area"),o=Kn(bo.fromDom(e.getElement()),"tabindex").bind(Tt),r=k$(e.id,n,tm(e),o).dom;r.onload=()=>{r.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=S$(e),x$.add(t.iframeContainer,r)},E$=(e,t)=>{_$(e,t),t.editorContainer&&(x$.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=x$.isHidden(t.editorContainer)),e.getElement().style.display="none",x$.setAttrib(e.id,"aria-hidden","true"),w$(e)},N$=bl.DOM,R$=(e,t,n)=>{const o=wA.get(n),r=wA.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=kn.trim(n),o&&-1===kn.inArray(t,n)){if(e.plugins[n])return;try{const s=o(e,r)||{};e.plugins[n]=s,V(s.init)&&(s.init(e,r),t.push(n))}catch(t){LA(e,n,t)}}},D$=e=>e.replace(/^\-/,""),A$=e=>{const t=[];fe(ru(e),(n=>{R$(e,t,D$(n))}))},T$=e=>{const t=kn.trim(ym(e)),n=e.ui.registry.getAll().icons,o={...sA.get("default").icons,...sA.get(t).icons};Ie(o,((t,o)=>{Ke(n,o)||e.ui.registry.addIcon(o,t)}))},O$=e=>{const t=zm(e);if(P(t)){const n=xA.get(t);e.theme=n(e,xA.urls[t])||{},V(e.theme.init)&&e.theme.init(e,xA.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},B$=e=>{const t=Hm(e),n=aA.get(t);e.model=n(e,aA.urls[t])},P$=e=>e.theme.renderUI(),L$=e=>{const t=e.getElement(),n=zm(e)(e,t);return n.editorContainer.nodeType&&(n.editorContainer.id=n.editorContainer.id||e.id+"_parent"),n.iframeContainer&&n.iframeContainer.nodeType&&(n.iframeContainer.id=n.iframeContainer.id||e.id+"_iframecontainer"),n.height=n.iframeHeight?n.iframeHeight:t.offsetHeight,n},M$=e=>({editorContainer:e,iframeContainer:e,api:{}}),I$=e=>{const t=N$.create("div");return N$.insertAfter(t,e),M$(t)},F$=e=>{const t=e.getElement();return e.inline?M$(null):I$(t)},U$=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,P(zm(e))?P$(e):V(zm(e))?L$(e):F$(e)},z$=(e,t)=>{const n={show:re.from(t.show).getOr(W),hide:re.from(t.hide).getOr(W),isEnabled:re.from(t.isEnabled).getOr(oe),setEnabled:n=>{e.mode.isReadOnly()||re.from(t.setEnabled).each((e=>e(n)))}};e.ui={...e.ui,...n}},j$=e=>{e.dispatch("ScriptsLoaded"),T$(e),O$(e),B$(e),A$(e);const t=U$(e);z$(e,re.from(t.api).getOr({}));const n={editorContainer:t.editorContainer,iframeContainer:t.iframeContainer};return e.editorContainer=n.editorContainer?n.editorContainer:null,jA(e),e.inline?w$(e):E$(e,n)},H$=bl.DOM,V$=e=>"-"===e.charAt(0),$$=(e,t)=>{const n=Em(t),o=Nm(t);if(!1===Bl.hasCode(n)&&"en"!==n){const r=Rt(o)?o:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(r).catch((()=>{OA(t,r,n)}))}},q$=(e,t)=>{const n=zm(e);if(P(n)&&!V$(n)&&!Ke(xA.urls,n)){const o=jm(e),r=o?e.documentBaseURI.toAbsolute(o):`themes/${n}/theme${t}.js`;xA.load(n,r).catch((()=>{BA(e,r,n)}))}},W$=(e,t)=>{const n=Hm(e);if("plugin"!==n&&!Ke(aA.urls,n)){const o=Vm(e),r=P(o)?e.documentBaseURI.toAbsolute(o):`models/${n}/model${t}.js`;aA.load(n,r).catch((()=>{PA(e,r,n)}))}},K$=e=>re.from(vm(e)).filter(Rt).map((e=>({url:e,name:re.none()}))),G$=(e,t,n)=>re.from(t).filter((e=>Rt(e)&&!sA.has(e))).map((t=>({url:`${e.editorManager.baseURL}/icons/${t}/icons${n}.js`,name:re.some(t)}))),Y$=(e,t,n)=>{const o=G$(t,"default",n),r=K$(t).orThunk((()=>G$(t,ym(t),"")));fe(_n([o,r]),(n=>{e.add(n.url).catch((()=>{TA(t,n.url,n.name.getOrUndefined())}))}))},X$=(e,t)=>{const n=(t,n)=>{wA.load(t,n).catch((()=>{AA(e,n,t)}))};Ie(su(e),((t,o)=>{n(o,t),e.options.set("plugins",ru(e).concat(o))})),fe(ru(e),(e=>{!(e=kn.trim(e))||wA.urls[e]||V$(e)||n(e,`plugins/${e}/plugin${t}.js`)}))},Q$=e=>{const t=zm(e);return!P(t)||H(xA.get(t))},J$=e=>{const t=Hm(e);return H(aA.get(t))},Z$=(e,t)=>{const n=kl.ScriptLoader,o=()=>{!e.removed&&Q$(e)&&J$(e)&&j$(e)};q$(e,t),W$(e,t),$$(n,e),Y$(n,e,t),X$(e,t),n.loadQueue().then(o,o)},eq=(e,t)=>Rs.forElement(e,{contentCssCors:ou(t),referrerPolicy:_m(t)}),tq=e=>{const t=e.id;Bl.setCode(Em(e));const n=()=>{H$.unbind(window,"ready",n),e.render()};if(!il.Event.domLoaded)return void H$.bind(window,"ready",n);if(!e.getElement())return;const o=bo.fromDom(e.getElement()),r=Qn(o);e.on("remove",(()=>{ge(o.dom.attributes,(e=>Yn(o,e.name))),qn(o,r)})),e.ui.styleSheetLoader=eq(o,e),Ym(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const s=e.getElement().form||H$.getParent(t,"form");s&&(e.formElement=s,Xm(e)&&!Zr(e.getElement())&&(H$.insertAfter(H$.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=t=>{e.dispatch(t.type,t)},H$.bind(s,"submit reset",e.formEventDelegate),e.on("reset",(()=>{e.resetContent()})),!Qm(e)||s.submit.nodeType||s.submit.length||s._mceOldSubmit||(s._mceOldSubmit=s.submit,s.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),s._mceOldSubmit(s)))),e.windowManager=SA(e),e.notificationManager=CA(e),Pu(e)&&e.on("GetContent",(e=>{e.save&&(e.content=H$.encode(e.content))})),Jm(e)&&e.on("submit",(()=>{e.initialized&&e.save()})),Zm(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),Z$(e,e.suffix)},nq=(e,t)=>({sections:Y(e),options:Y(t)}),oq=ln().deviceType,rq=oq.isPhone(),sq=oq.isTablet(),aq=e=>{if(j(e))return[];{const t=I(e)?e:e.split(/[ ,]/),n=ue(t,_t);return he(n,Rt)}},iq=(e,t)=>{const n=He(t,((t,n)=>ce(e,n)));return nq(n.t,n.f)},lq=(e,t,n={})=>{const o=e.sections(),r=We(o,t).getOr({});return kn.extend({},n,r)},dq=(e,t)=>Ke(e.sections(),t),cq=(e,t)=>dq(e,t)?e.sections()[t]:{},mq=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:We(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),uq=(e,t)=>{var n;const o=null!==(n=t.external_plugins)&&void 0!==n?n:{};return e&&e.external_plugins?kn.extend({},e.external_plugins,o):o},fq=(e,t)=>[].concat(aq(e)).concat(aq(t)),gq=(e,t,n,o)=>e&&dq(t,"mobile")?o:n,pq=(e,t,n,o)=>{const r=aq(n.forced_plugins),s=aq(o.plugins),a=cq(t,"mobile"),i=a.plugins?aq(a.plugins):s,l=gq(e,t,s,i),d=fq(r,l);return kn.extend(o,{forced_plugins:r,plugins:d})},hq=(e,t)=>e&&dq(t,"mobile"),bq=(e,t,n,o,r)=>{var s;const a=e?{mobile:mq(null!==(s=r.mobile)&&void 0!==s?s:{},t)}:{},i=iq(["mobile"],PI(a,r)),l=kn.extend(n,o,i.options(),hq(e,i)?lq(i,"mobile"):{},{external_plugins:uq(o,i.options())});return pq(e,i,o,l)},yq=(e,t)=>bq(rq||sq,rq,t,e,t),vq=(e,t)=>iD(e,t),Cq=e=>{const t=(t,n)=>{e.formatter.toggle(t,n),e.nodeChanged()},n=n=>()=>{fe("left,center,right,justify".split(","),(t=>{n!==t&&e.formatter.remove("align"+t)})),"none"!==n&&t("align"+n)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},wq=e=>{const t=t=>()=>{const n=e.selection,o=n.isCollapsed()?[e.dom.getParent(n.getNode(),e.dom.isBlock)]:n.getSelectedBlocks();return me(o,(n=>H(e.formatter.matchNode(n,t))))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},xq=e=>{Cq(e),wq(e)},kq=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let o;try{n.execCommand(t)}catch(e){o=!0}if("paste"!==t||n.queryCommandEnabled(t)||(o=!0),o||!n.queryCommandSupported(t)){let t=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(pn.os.isMacOS()||pn.os.isiOS())&&(t=t.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:t,type:"error"})}}})},Sq=(e,t,n)=>{const o=bo.fromDom(e.getRoot());return n=HC(o,Xd.fromRangeStart(t))?n.replace(/^ /,"&nbsp;"):n.replace(/^&nbsp;/," "),n=$C(o,Xd.fromRangeEnd(t))?n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n.replace(/&nbsp;(<br( \/)?>)?$/," ")},_q=e=>{if("string"!=typeof e){const t=kn.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},Eq=(e,t)=>{const n=e.selection,o=e.dom;return/^ | $/.test(t)?Sq(o,n.getRng(),t):t},Nq=(e,t)=>{const{content:n,details:o}=_q(t);lN(e,{content:Eq(e,n),format:"html",set:!1,selection:!0,paste:o.paste}).each((t=>{const n=sD(e,t.content,o);dN(e,n,t),e.addVisual()}))},Rq=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,o)=>{Nq(e,e.dom.createHTML("img",{src:o}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,o)=>{Nq(e,e.dom.encode(o))},insertHTML:(t,n,o)=>{Nq(e,o)},mceInsertContent:(t,n,o)=>{Nq(e,o)},mceSetContent:(t,n,o)=>{e.setContent(o)},mceReplaceContent:(t,n,o)=>{e.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent("")}})},Dq={"font-size":"size","font-family":"face"},Aq=(e,t,n)=>{const o=t=>sr(t,e).orThunk((()=>"font"===Pn(t)?We(Dq,e).bind((e=>Kn(t,e))):re.none())),r=e=>ko(bo.fromDom(t),e);return Wk(bo.fromDom(n),(e=>o(e)),r)},Tq=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),Oq=(e,t)=>re.from(bl.DOM.getStyle(t,e,!0)),Bq=e=>(t,n)=>re.from(n).map(bo.fromDom).filter(Fn).bind((n=>Aq(e,t,n.dom).or(Oq(e,n.dom)))).getOr(""),Pq=Bq("font-size"),Lq=K(Tq,Bq("font-family")),Mq=e=>ig(e.getBody()).map((e=>{const t=e.container();return es(t)?t.parentNode:t})),Iq=e=>re.from(e.selection.getRng()).bind((t=>{const n=e.getBody();return t.startContainer===n&&0===t.startOffset?re.none():re.from(e.selection.getStart(!0))})),Fq=(t,n)=>Iq(t).orThunk(e(Mq,t)).map(bo.fromDom).filter(Fn).bind(n),Uq=(e,t)=>Fq(e,G(re.some,t)),zq=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const o=Ou(e),r=Bu(e);return r?r[n-1]||t:o[n-1]||t}return t}return t},jq=e=>{const t=e.split(/\s*,\s*/);return ue(t,(e=>-1===e.indexOf(" ")||xt(e,'"')||xt(e,"'")?e:`'${e}'`)).join(",")},Hq=(e,t)=>{const n=zq(e,t);e.formatter.toggle("fontname",{value:jq(n)}),e.nodeChanged()},Vq=e=>Uq(e,(t=>Lq(e.getBody(),t.dom))).getOr(""),$q=(e,t)=>{e.formatter.toggle("fontsize",{value:zq(e,t)}),e.nodeChanged()},qq=e=>Uq(e,(t=>Pq(e.getBody(),t.dom))).getOr(""),Wq=t=>Uq(t,(n=>{const o=bo.fromDom(t.getBody()),r=Wk(n,(e=>sr(e,"line-height")),e(ko,o)),s=()=>{const e=parseFloat(or(n,"line-height")),t=parseFloat(or(n,"font-size"));return String(e/t)};return r.getOrThunk(s)})).getOr(""),Kq=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},Gq=e=>{const t=(t,n)=>{e.formatter.toggle(t,n),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>{t(e)},"ForeColor,HiliteColor":(e,n,o)=>{t(e,{value:o})},BackColor:(e,n,o)=>{t("hilitecolor",{value:o})},FontName:(t,n,o)=>{Hq(e,o)},FontSize:(t,n,o)=>{$q(e,o)},LineHeight:(t,n,o)=>{Kq(e,o)},Lang:(e,n,o)=>{t(e,{value:o.code,customValue:o.customCode})},RemoveFormat:t=>{e.formatter.remove(t)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(e,n,o)=>{t(P(o)?o:"p")},mceToggleFormat:(e,n,o)=>{t(o)}})},Yq=e=>{const t=t=>e.formatter.match(t);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":e=>t(e),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",(()=>Vq(e))),e.editorCommands.addQueryValueHandler("FontSize",(()=>qq(e))),e.editorCommands.addQueryValueHandler("LineHeight",(()=>Wq(e)))},Xq=e=>{Gq(e),Yq(e)},Qq=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},Jq=e=>{e.editorCommands.addCommands({Indent:()=>{KP(e)},Outdent:()=>{GP(e)}}),e.editorCommands.addCommands({Outdent:()=>HP(e)},"state")},Zq=e=>{const t=(t,n,o)=>{const r=P(o)?{href:o}:o,s=e.dom.getParent(e.selection.getNode(),"a");L(r)&&P(r.href)&&(r.href=r.href.replace(/ /g,"%20"),s&&r.href||e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,s))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isCollapsed()){const t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},mceInsertLink:t,createLink:t})},eW=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);const n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){const t=n.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(t.nodeName)){const o=e.selection.getBookmark();e.dom.split(t,n),e.selection.moveToBookmark(o)}}}})},tW=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{const n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state")},nW=e=>{eW(e),tW(e)},oW=e=>{e.editorCommands.addCommands({insertParagraph:()=>{pz(jU,e)},mceInsertNewLine:(t,n,o)=>{hz(e,o)},InsertLineBreak:()=>{pz(ZU,e)}})},rW=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,o)=>{let r=0;e.dom.getParent(e.selection.getNode(),(t=>{if(1===t.nodeType&&r++===o)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:(t,n,o)=>{e.selection.select(o)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),ls);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},sW=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,o)=>{const r=null!=o?o:e.selection.getNode();if(r!==e.getBody()){const t=e.selection.getBookmark();e.dom.remove(r,!0),e.selection.moveToBookmark(t)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,o)=>{ov(e,o)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},aW=e=>{xq(e),kq(e),Qq(e),rW(e),Rq(e),Zq(e),Jq(e),oW(e),nW(e),Xq(e),sW(e)};class iW{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,t,n,o){const r=this.editor,s=e.toLowerCase(),a=null==o?void 0:o.skip_focus;if(r.removed)return!1;"mcefocus"!==s&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(s)||a?_y(r):r.focus());if(r.dispatch("BeforeExecCommand",{command:e,ui:t,value:n}).isDefaultPrevented())return!1;const i=this.commands.exec[s];return!!V(i)&&(i(s,t,n),r.dispatch("ExecCommand",{command:e,ui:t,value:n}),!0)}queryCommandState(e){if(this.editor.quirks.isHidden()||this.editor.removed)return!1;const t=e.toLowerCase(),n=this.commands.state[t];return!!V(n)&&n(t)}queryCommandValue(e){if(this.editor.quirks.isHidden()||this.editor.removed)return"";const t=e.toLowerCase(),n=this.commands.value[t];return V(n)?n(t):""}addCommands(e,t="exec"){const n=this.commands;Ie(e,((e,o)=>{fe(o.toLowerCase().split(","),(o=>{n[t][o]=e}))}))}addCommand(e,t,n){const o=e.toLowerCase();this.commands.exec[o]=(e,o,r)=>t.call(null!=n?n:this.editor,o,r)}queryCommandSupported(e){const t=e.toLowerCase();return!!this.commands.exec[t]}addQueryStateHandler(e,t,n){this.commands.state[e.toLowerCase()]=()=>t.call(null!=n?n:this.editor)}addQueryValueHandler(e,t,n){this.commands.value[e.toLowerCase()]=()=>t.call(null!=n?n:this.editor)}}const lW="data-mce-contenteditable",dW=(e,t,n)=>{mo(e,t)&&!1===n?lo(e,t):n&&ao(e,t)},cW=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}},mW=(e,t)=>{e.dom.contentEditable=t?"true":"false"},uW=e=>{fe(ra(e,'*[contenteditable="true"]'),(e=>{$n(e,lW,"true"),mW(e,!1)}))},fW=e=>{fe(ra(e,`*[${lW}="true"]`),(e=>{Yn(e,lW),mW(e,!0)}))},gW=e=>{re.from(e.selection.getNode()).each((e=>{e.removeAttribute("data-mce-selected")}))},pW=e=>{e.selection.setRng(e.selection.getRng())},hW=(e,t)=>{const n=bo.fromDom(e.getBody());dW(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),gW(e),e.readonly=!0,mW(n,!1),uW(n)):(e.readonly=!1,mW(n,!0),fW(n),cW(e,"StyleWithCSS",!1),cW(e,"enableInlineTableEditing",!1),cW(e,"enableObjectResizing",!1),ev(e)&&e.focus(),pW(e),e.nodeChanged())},bW=e=>e.readonly,yW=e=>{e.parser.addAttributeFilter("contenteditable",(t=>{bW(e)&&fe(t,(e=>{e.attr(lW,e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter(lW,(t=>{bW(e)&&fe(t,(e=>{e.attr("contenteditable",e.attr(lW))}))})),e.serializer.addTempAttr(lW)},vW=e=>{e.serializer?yW(e):e.on("PreInit",(()=>{yW(e)}))},CW=e=>"click"===e.type,wW=["copy"],xW=e=>ce(wW,e.type),kW=(e,t)=>{const n=t=>ko(t,bo.fromDom(e.getBody()));return _s(t,"a",n).bind((e=>Kn(e,"href")))},SW=(e,t)=>{if(CW(t)&&!Dh.metaKeyPressed(t)){const n=bo.fromDom(t.target);kW(e,n).each((n=>{if(t.preventDefault(),/^#/.test(n)){const t=e.dom.select(`${n},[name="${Ct(n,"#")}"]`);t.length&&e.selection.scrollIntoView(t[0],!0)}else window.open(n,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))}else xW(t)&&e.dispatch(t.type,t)},_W=e=>{e.on("ShowCaret",(t=>{bW(e)&&t.preventDefault()})),e.on("ObjectSelected",(t=>{bW(e)&&t.preventDefault()}))},EW=kn.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class NW{constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||ne}static isNative(e){return!!EW[e.toLowerCase()]}fire(e,t){return this.dispatch(e,t)}dispatch(e,t){const n=e.toLowerCase(),o=Zi(n,null!=t?t:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[n];if(r)for(let e=0,t=r.length;e<t;e++){const t=r[e];if(!t.removed){if(t.once&&this.off(n,t.func),o.isImmediatePropagationStopped())return o;if(!1===t.func.call(this.scope,o))return o.preventDefault(),o}}return o}on(e,t,n,o){if(!1===t&&(t=ne),t){const r={func:t,removed:!1};o&&kn.extend(r,o);const s=e.toLowerCase().split(" ");let a=s.length;for(;a--;){const e=s[a];let t=this.bindings[e];t||(t=[],this.toggleEvent(e,!0)),t=n?[r,...t]:[...t,r],this.bindings[e]=t}}return this}off(e,t){if(e){const n=e.toLowerCase().split(" ");let o=n.length;for(;o--;){const r=n[o];let s=this.bindings[r];if(!r)return Ie(this.bindings,((e,t)=>{this.toggleEvent(t,!1),delete this.bindings[t]})),this;if(s){if(t){const e=pe(s,(e=>e.func===t));s=e.fail,this.bindings[r]=s,fe(e.pass,(e=>{e.removed=!0}))}else s.length=0;s.length||(this.toggleEvent(e,!1),delete this.bindings[r])}}}else Ie(this.bindings,((e,t)=>{this.toggleEvent(t,!1)})),this.bindings={};return this}once(e,t,n){return this.on(e,t,n,{once:!0})}has(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)}}const RW=e=>(e._eventDispatcher||(e._eventDispatcher=new NW({scope:e,toggleEvent:(t,n)=>{NW.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),DW={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const o=this;if(o.removed&&"remove"!==e&&"detach"!==e)return Zi(e.toLowerCase(),null!=t?t:{},o);const r=RW(o).dispatch(e,t);if(!1!==n&&o.parent){let t=o.parent();for(;t&&!r.isPropagationStopped();)t.dispatch(e,r,!1),t=t.parent()}return r},on(e,t,n){return RW(this).on(e,t,n)},off(e,t){return RW(this).off(e,t)},once(e,t){return RW(this).once(e,t)},hasEventListeners(e){return RW(this).has(e)}},AW=bl.DOM;let TW;const OW=(e,t)=>{if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;const n=Fm(e);return n?(e.eventRoot||(e.eventRoot=AW.select(n)[0]),e.eventRoot):e.getBody()},BW=e=>!e.hidden&&!bW(e),PW=(e,t,n)=>{BW(e)?e.dispatch(t,n):bW(e)&&SW(e,n)},LW=(e,t)=>{let n;if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const o=OW(e,t);if(Fm(e)){if(TW||(TW={},e.editorManager.on("removeEditor",(()=>{e.editorManager.activeEditor||TW&&(Ie(TW,((t,n)=>{e.dom.unbind(OW(e,n))})),TW=null)}))),TW[t])return;n=n=>{const o=n.target,r=e.editorManager.get();let s=r.length;for(;s--;){const e=r[s].getBody();(e===o||AW.isChildOf(o,e))&&PW(r[s],t,n)}},TW[t]=n,AW.bind(o,t,n)}else n=n=>{PW(e,t,n)},AW.bind(o,t,n),e.delegates[t]=n},MW={...DW,bindPendingEventDelegates(){const e=this;kn.each(e._pendingNativeEvents,(t=>{LW(e,t)}))},toggleNativeEvent(e,t){const n=this;"focus"!==e&&"blur"!==e&&(n.removed||(t?n.initialized?LW(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(OW(n,e),e,n.delegates[e]),delete n.delegates[e])))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Ie(e.delegates,((t,n)=>{e.dom.unbind(OW(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},IW=e=>P(e)?{value:e.split(/[ ,]/),valid:!0}:q(e,P)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},FW=e=>{const t=(()=>{switch(e){case"array":return I;case"boolean":return U;case"function":return V;case"number":return $;case"object":return L;case"string":return P;case"string[]":return IW;case"object[]":return e=>q(e,L);case"regexp":return e=>B(e,RegExp)}})();return n=>HW(n,t,`The value must be a ${e}.`)},UW=e=>P(e.processor),zW=(e,t)=>e+(Dt(t.message)?"":`. ${t.message}`),jW=e=>e.valid,HW=(e,t,n="")=>{const o=t(e);return U(o)?o?{value:e,valid:!0}:{valid:!1,message:n}:o},VW=(e,t,n)=>{if(!z(t)){const o=HW(t,n);if(jW(o))return o.value;console.error(zW(`Invalid default value passed for the "${e}" option`,o))}},$W=(e,t)=>{const n={},o={},r=(e,t,n)=>{const r=HW(t,n);return jW(r)?(o[e]=r.value,!0):(console.warn(zW(`Invalid value passed for the ${e} option`,r)),!1)},s=(e,s)=>{const a=UW(s)?FW(s.processor):s.processor,i=VW(e,s.default,a);n[e]={...s,default:i,processor:a};We(o,e).orThunk((()=>We(t,e))).each((t=>r(e,t,a)))},a=e=>Ke(n,e),i=e=>We(o,e).orThunk((()=>We(n,e).map((e=>e.default)))).getOrUndefined(),l=(e,t)=>{if(a(e)){const o=n[e];return o.immutable?(console.error(`"${e}" is an immutable option and cannot be updated`),!1):r(e,t,o.processor)}return console.warn(`"${e}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},d=e=>{const t=a(e);return t&&delete o[e],t},c=e=>Ke(o,e);return{register:s,isRegistered:a,get:i,set:l,unset:d,isSet:c}},qW=["design","readonly"],WW=(e,t,n,o)=>{const r=n[t.get()],s=n[o];try{s.activate()}catch(e){return void console.error(`problem while activating editor mode ${o}:`,e)}r.deactivate(),r.editorReadOnly!==s.editorReadOnly&&hW(e,s.editorReadOnly),t.set(o),dh(e,o)},KW=(e,t,n,o)=>{if(o!==n.get()){if(!Ke(t,o))throw new Error(`Editor mode '${o}' is invalid`);e.initialized?WW(e,n,t,o):e.on("init",(()=>WW(e,n,t,o)))}},GW=(e,t,n)=>{if(ce(qW,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(e){console.error(`problem while deactivating editor mode ${t}:`,e)}}}}},YW=e=>{const t=Sl("design"),n=Sl({design:{activate:W,deactivate:W,editorReadOnly:!1},readonly:{activate:W,deactivate:W,editorReadOnly:!0}});return vW(e),_W(e),{isReadOnly:()=>bW(e),set:o=>KW(e,n.get(),t,o),get:()=>t.get(),register:(e,t)=>{n.set(GW(n.get(),e,t))}}},XW=kn.each,QW=kn.explode,JW={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},ZW=kn.makeMap("alt,ctrl,shift,meta,access"),eK=e=>{let t;const n={},o=pn.os.isMacOS()||pn.os.isiOS();XW(QW(e.toLowerCase(),"+"),(e=>{e in ZW?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=JW[e]||e.toUpperCase().charCodeAt(0))}));const r=[n.keyCode];for(t in ZW)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,o?n.ctrl=!0:n.shift=!0),n.meta&&(o?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};class tK{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;const t=this;e.on("keyup keypress keydown",(e=>{!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(XW(t.shortcuts,(n=>{if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}add(e,t,n,o){const r=this,s=r.normalizeCommandFunc(n);return XW(QW(kn.trim(e)),(e=>{const n=r.createShortcut(e,t,s,o);r.shortcuts[n.id]=n})),!0}remove(e){const t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)}normalizeCommandFunc(e){const t=this,n=e;return"string"==typeof n?()=>{t.editor.execCommand(n,!1,null)}:kn.isArray(n)?()=>{t.editor.execCommand(n[0],n[1],n[2])}:n}createShortcut(e,t,n,o){const r=kn.map(QW(e,">"),eK);return r[r.length-1]=kn.extend(r[r.length-1],{func:n,scope:o||this.editor}),kn.extend(r[0],{desc:this.editor.translate(t),subpatterns:r.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,t){return!!t&&(t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&(t.alt===e.altKey&&t.shift===e.shiftKey&&(!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0))))}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}}const nK=()=>{const e={},t={},n={},o={},r={},s={},a={},i=(e,t)=>(n,o)=>e[n.toLowerCase()]={...o,type:t},l=(e,t)=>o[e.toLowerCase()]=t;return{addButton:i(e,"button"),addGroupToolbarButton:i(e,"grouptoolbarbutton"),addToggleButton:i(e,"togglebutton"),addMenuButton:i(e,"menubutton"),addSplitButton:i(e,"splitbutton"),addMenuItem:i(t,"menuitem"),addNestedMenuItem:i(t,"nestedmenuitem"),
addToggleMenuItem:i(t,"togglemenuitem"),addAutocompleter:i(n,"autocompleter"),addContextMenu:i(r,"contextmenu"),addContextToolbar:i(s,"contexttoolbar"),addContextForm:i(s,"contextform"),addSidebar:i(a,"sidebar"),addIcon:l,getAll:()=>({buttons:e,menuItems:t,icons:o,popups:n,contextMenus:r,contextToolbars:s,sidebars:a})}},oK=()=>{const e=nK();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,getAll:e.getAll}},rK=bl.DOM,sK=kn.extend,aK=kn.each;class iK{constructor(e,t,n){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,sK(this,MW);const o=this;this.id=e,this.hidden=!1;const r=yq(n.defaultOptions,t);this.options=$W(o,r),em(o);const s=this.options.get;s("deprecation_warnings")&&XD(t,r);const a=s("suffix");a&&(n.suffix=a),this.suffix=n.suffix;const i=s("base_url");i&&n._setBaseUrl(i),this.baseUri=n.baseURI;const l=_m(o);l&&(kl.ScriptLoader._setReferrerPolicy(l),bl.DOM.styleSheetLoader._setReferrerPolicy(l)),Pl.languageLoad=s("language_load"),Pl.baseURL=n.baseURL,this.setDirty(!1),this.documentBaseURI=new qE(om(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Ym(o),this.shortcuts=new tK(this),this.editorCommands=new iW(this),aW(this);const d=s("cache_suffix");d&&(pn.cacheSuffix=d.replace(/^[\?\&]+/,"")),this.ui={registry:oK(),styleSheetLoader:void 0,show:W,hide:W,setEnabled:W,isEnabled:oe},this.mode=YW(o),n.dispatch("SetupEditor",{editor:this});const c=mu(o);V(c)&&c.call(o,o)}render(){tq(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return Zy(this)}translate(e){return Bl.translate(e)}getParam(e,t,n){const o=this.options;return o.isRegistered(e)||(H(n)?o.register(e,{processor:n,default:t}):o.register(e,{processor:oe,default:t})),o.isSet(e)||z(t)?o.get(e):t}hasPlugin(e,t){return!!ce(ru(this),e)&&(!t||void 0!==wA.get(e))}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,t,n){this.editorCommands.addCommand(e,t,n)}addQueryStateHandler(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)}addQueryValueHandler(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)}addShortcut(e,t,n,o){this.shortcuts.add(e,t,n,o)}execCommand(e,t,n,o){return this.editorCommands.execCommand(e,t,n,o)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){const e=this;e.hidden&&(e.hidden=!1,e.inline?e.getBody().contentEditable="true":(rK.show(e.getContainer()),rK.hide(e.id)),e.load(),e.dispatch("show"))}hide(){const e=this;e.hidden||(e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(rK.hide(e.getContainer()),rK.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,t){this.dispatch("ProgressState",{state:e,time:t})}load(e){const t=this;let n,o=t.getElement();if(t.removed)return"";if(o){(e=e||{}).load=!0;const r=Zr(o)?o.value:o.innerHTML;return n=t.setContent(r,e),e.element=o,e.no_events||t.dispatch("LoadContent",e),e.element=o=null,n}}save(e){const t=this;let n,o,r=t.getElement();if(r&&t.initialized&&!t.removed)return(e=e||{}).save=!0,e.element=r,n=e.content=t.getContent(e),e.no_events||t.dispatch("SaveContent",e),"raw"===e.format&&t.dispatch("RawSaveContent",e),n=e.content,Zr(r)?r.value=n:(!e.is_removing&&t.inline||(r.innerHTML=n),(o=rK.getParent(t.id,"form"))&&aK(o.elements,(e=>{if(e.name===t.id)return e.value=n,!1}))),e.element=r=null,!1!==e.set_dirty&&t.setDirty(!1),n}setContent(e,t){return $D(this,e,t)}getContent(e){return jD(this,e)}insertContent(e,t){t&&(e=sK({content:e},t)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){void 0===e?$D(this,this.startContent,{format:"raw"}):$D(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){const t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.dispatch("dirty")}getContainer(){const e=this;return e.container||(e.container=rK.get(e.editorContainer||e.id+"_parent")),e.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=rK.get(this.id)),this.targetElm}getWin(){const e=this;let t;return e.contentWindow||(t=e.iframeElement,t&&(e.contentWindow=t.contentWindow)),e.contentWindow}getDoc(){const e=this;let t;return e.contentDocument||(t=e.getWin(),t&&(e.contentDocument=t.document)),e.contentDocument}getBody(){const e=this.getDoc();return this.bodyElement||(e?e.body:null)}convertURL(e,t,n){const o=this,r=o.options.get,s=fu(o);return V(s)?s.call(o,e,n,!0,t):!r("convert_urls")||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r("relative_urls")?o.documentBaseURI.toRelative(e):e=o.documentBaseURI.toAbsolute(e,r("remove_script_host"))}addVisual(e){vq(this,e)}remove(){nA(this)}destroy(e){oA(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const lK=bl.DOM,dK=kn.each;let cK,mK=!1,uK=[];const fK=e=>{const t=e.type;dK(yK.get(),(n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e)}}))},gK=e=>{if(e!==mK){const t=bl.DOM;e?(t.bind(window,"resize",fK),t.bind(window,"scroll",fK)):(t.unbind(window,"resize",fK),t.unbind(window,"scroll",fK)),mK=e}},pK=e=>{const t=uK;return uK=he(uK,(t=>e!==t)),yK.activeEditor===e&&(yK.activeEditor=uK.length>0?uK[0]:null),yK.focusedEditor===e&&(yK.focusedEditor=null),t.length!==uK.length},hK=e=>(e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(pK(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0,e=null),e),bK="CSS1Compat"!==document.compatMode,yK={...DW,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"1.2",releaseDate:"2022-07-29",i18n:Bl,activeEditor:null,focusedEditor:null,setup(){const e=this;let t,n,o="";n=qE.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));const r=window.tinymce||window.tinyMCEPreInit;if(r)t=r.base||r.baseURL,o=r.suffix;else{const e=document.getElementsByTagName("script");for(let n=0;n<e.length;n++){const r=e[n].src||"";if(""===r)continue;const s=r.substring(r.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(r)){-1!==s.indexOf(".min")&&(o=".min"),t=r.substring(0,r.lastIndexOf("/"));break}}if(!t&&document.currentScript){const e=document.currentScript.src;-1!==e.indexOf(".min")&&(o=".min"),t=e.substring(0,e.lastIndexOf("/"))}}e.baseURL=new qE(n).toAbsolute(t),e.documentBaseURL=n,e.baseURI=new qE(e.baseURL),e.suffix=o,Vy(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;e.suffix&&(this.suffix=n),this.defaultOptions=e;const o=e.plugin_base_urls;void 0!==o&&Ie(o,((e,t)=>{Pl.PluginManager.urls[t]=e}))},init(e){const t=this;let n;const o=kn.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),r=(e,t)=>e.inline&&t.tagName.toLowerCase()in o,s=e=>{let t=e.id;return t||(t=We(e,"name").filter((e=>!lK.get(e))).getOrThunk(lK.uniqueId),e.setAttribute("id",t)),t},a=n=>{const o=e[n];if(o)return o.apply(t,[])},i=e=>pn.browser.isIE()||pn.browser.isEdge()?(MA("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):bK?(MA("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):P(e.selector)?lK.select(e.selector):H(e.target)?[e.target]:[];let l=e=>{n=e};const d=()=>{let n=0;const o=[];let c;const m=(e,r,s)=>{const a=new iK(e,r,t);o.push(a),a.on("init",(()=>{++n===c.length&&l(o)})),a.targetElm=a.targetElm||s,a.render()};lK.unbind(window,"ready",d),a("onpageload"),c=Pe(i(e)),kn.each(c,(e=>{hK(t.get(e.id))})),c=kn.grep(c,(e=>!t.get(e.id))),0===c.length?l([]):dK(c,(t=>{r(e,t)?MA("Could not initialize inline editor on invalid inline target element",t):m(s(t),e,t)}))};return lK.bind(window,"ready",d),new Promise((e=>{n?e(n):l=t=>{e(t)}}))},get(e){return 0===arguments.length?uK.slice(0):P(e)?Ce(uK,(t=>t.id===e)).getOr(null):$(e)&&uK[e]?uK[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(null===n&&uK.push(e),gK(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),cK||(cK=e=>{const n=t.dispatch("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",cK))),e},createEditor(e,t){return this.add(new iK(e,t,this))},remove(e){const t=this;let n,o;if(e){if(!P(e))return o=e,F(t.get(o.id))?null:(pK(o)&&t.dispatch("RemoveEditor",{editor:o}),0===uK.length&&window.removeEventListener("beforeunload",cK),o.remove(),gK(uK.length>0),o);dK(lK.select(e),(e=>{o=t.get(e.id),o&&t.remove(o)}))}else for(n=uK.length-1;n>=0;n--)t.remove(uK[n])},execCommand(e,t,n){var o;const r=this,s=L(n)?null!==(o=n.id)&&void 0!==o?o:n.index:n;switch(e){case"mceAddEditor":if(!r.get(s)){const e=n.options;new iK(s,e,r).render()}return!0;case"mceRemoveEditor":{const e=r.get(s);return e&&e.remove(),!0}case"mceToggleEditor":{const e=r.get(s);return e?(e.isHidden()?e.show():e.hide(),!0):(r.execCommand("mceAddEditor",!1,n),!0)}}return!!r.activeEditor&&r.activeEditor.execCommand(e,t,n)},triggerSave:()=>{dK(uK,(e=>{e.save()}))},addI18n:(e,t)=>{Bl.add(e,t)},translate:e=>Bl.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new qE(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new qE(this.baseURL)}};yK.setup();const vK=()=>{const e=Ml(),t=e=>({items:e,types:Le(e),getType:t=>We(e,t).getOrUndefined()}),n=t=>{e.set(t)};return{FakeClipboardItem:t,write:n,read:()=>e.get().getOrUndefined(),clear:e.clear}},CK=vK(),wK=Math.min,xK=Math.max,kK=Math.round,SK=(e,t,n)=>{let o=t.x,r=t.y;const s=e.w,a=e.h,i=t.w,l=t.h,d=(n||"").split("");return"b"===d[0]&&(r+=l),"r"===d[1]&&(o+=i),"c"===d[0]&&(r+=kK(l/2)),"c"===d[1]&&(o+=kK(i/2)),"b"===d[3]&&(r-=a),"r"===d[4]&&(o-=s),"c"===d[3]&&(r-=kK(a/2)),"c"===d[4]&&(o-=kK(s/2)),DK(o,r,s,a)},_K=(e,t,n,o)=>{let r,s;for(s=0;s<o.length;s++)if(r=SK(e,t,o[s]),r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return o[s];return null},EK=(e,t,n)=>DK(e.x-t,e.y-n,e.w+2*t,e.h+2*n),NK=(e,t)=>{const n=xK(e.x,t.x),o=xK(e.y,t.y),r=wK(e.x+e.w,t.x+t.w),s=wK(e.y+e.h,t.y+t.h);return r-n<0||s-o<0?null:DK(n,o,r-n,s-o)},RK=(e,t,n)=>{let o=e.x,r=e.y,s=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,d=xK(0,t.x-o),c=xK(0,t.y-r),m=xK(0,s-i),u=xK(0,a-l);return o+=d,r+=c,n&&(s+=d,a+=c,o-=m,r-=u),s-=m,a-=u,DK(o,r,s-o,a-r)},DK=(e,t,n,o)=>({x:e,y:t,w:n,h:o}),AK=e=>DK(e.left,e.top,e.width,e.height),TK={inflate:EK,relativePosition:SK,findBestRelativePosition:_K,intersect:NK,clamp:RK,create:DK,fromClientRect:AK},OK=(e,t,n=1e3)=>{let o=!1,r=null;const s=e=>(...t)=>{o||(o=!0,null!==r&&(clearTimeout(r),r=null),e.apply(null,t))},a=s(e),i=s(t);return{start:(...e)=>{o||null!==r||(r=setTimeout((()=>i.apply(null,e)),n))},resolve:a,reject:i}},BK=()=>{const e={},t={},n=(n,o)=>{const r=`Script at URL "${o}" failed to load`,s=`Script at URL "${o}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(void 0!==e[n])return e[n];{const a=new Promise(((e,a)=>{const i=OK(e,a);t[n]=i.resolve,kl.ScriptLoader.loadScript(o).then((()=>i.start(s)),(()=>i.reject(r)))}));return e[n]=a,a}},o=(n,o)=>{void 0!==t[n]&&(t[n](o),delete t[n]),e[n]=Promise.resolve(o)};return{load:n,add:o,unload:t=>{delete e[t]}}},PK=BK(),LK=()=>(()=>{let e={},t=[];const n={getItem:t=>{const n=e[t];return n||null},setItem:(n,o)=>{t.push(n),e[n]=String(o)},key:e=>t[e],removeItem:n=>{t=t.filter((e=>e===n)),delete e[n]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let MK;try{const e="__storage_test__";MK=window.localStorage,MK.setItem(e,e),MK.removeItem(e)}catch(e){MK=LK()}const IK={geom:{Rect:TK},util:{Delay:Dy,Tools:kn,VK:Dh,URI:qE,EventDispatcher:NW,Observable:DW,I18n:Bl,LocalStorage:MK,ImageUploader:eT},dom:{EventUtils:il,TreeWalker:Ds,TextSeeker:cd,DOMUtils:bl,ScriptLoader:kl,RangeUtils:Ab,Serializer:FD,StyleSheetLoader:Es,ControlSelection:Mh,BookmarkManager:oh,Selection:_D,Event:il.Event},html:{Styles:Ki,Entities:Bi,Node:Rv,Schema:Wi,DomParser:oN,Writer:jv,Serializer:Hv},Env:pn,AddOnManager:Pl,Annotator:nh,Formatter:pT,UndoManager:vT,EditorCommands:iW,WindowManager:SA,NotificationManager:CA,EditorObservable:MW,Shortcuts:tK,Editor:iK,FocusManager:Ey,EditorManager:yK,DOM:bl.DOM,ScriptLoader:kl.ScriptLoader,PluginManager:wA,ThemeManager:xA,ModelManager:aA,IconManager:sA,Resource:PK,FakeClipboard:CK,trim:kn.trim,isArray:kn.isArray,is:kn.is,toArray:kn.toArray,makeMap:kn.makeMap,each:kn.each,map:kn.map,grep:kn.grep,inArray:kn.inArray,extend:kn.extend,walk:kn.walk,resolve:kn.resolve,explode:kn.explode,_addCacheSuffix:kn._addCacheSuffix},FK=kn.extend(yK,IK),UK=e=>{if("object"==typeof module)try{module.exports=e}catch(e){}},zK=e=>{window.tinymce=e,window.tinyMCE=e};zK(FK),UK(FK)}();